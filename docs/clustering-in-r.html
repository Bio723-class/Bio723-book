<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Clustering in R | Biology 723: Statistical Computing for Biologists</title>
  <meta name="description" content="Hands-on materials for Bio 723 course at Duke University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Clustering in R | Biology 723: Statistical Computing for Biologists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Hands-on materials for Bio 723 course at Duke University." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Clustering in R | Biology 723: Statistical Computing for Biologists" />
  
  <meta name="twitter:description" content="Hands-on materials for Bio 723 course at Duke University." />
  

<meta name="author" content="Paul M. Magwene" />


<meta name="date" content="2021-04-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="canonical-variates-analysis.html"/>
<link rel="next" href="non-linear-regression-models.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#accessing-older-versions-of-the-course-notes"><i class="fa fa-check"></i><b>1.1</b> Accessing older versions of the course notes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-these-lecture-notes"><i class="fa fa-check"></i><b>1.2</b> How to use these lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting Started with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#entering-commands-in-the-console"><i class="fa fa-check"></i><b>2.3</b> Entering commands in the console</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#comments"><i class="fa fa-check"></i><b>2.4</b> Comments</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>2.5</b> Using R as a Calculator</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#common-mathematical-functions"><i class="fa fa-check"></i><b>2.5.1</b> Common mathematical functions</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#variable-assignment"><i class="fa fa-check"></i><b>2.6</b> Variable assignment</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#valid-variable-names"><i class="fa fa-check"></i><b>2.6.1</b> Valid variable names</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#data-types"><i class="fa fa-check"></i><b>2.7</b> Data types</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#numeric-data-types"><i class="fa fa-check"></i><b>2.7.1</b> Numeric data types</a></li>
<li class="chapter" data-level="2.7.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#logical-values"><i class="fa fa-check"></i><b>2.7.2</b> Logical values</a></li>
<li class="chapter" data-level="2.7.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#character-strings"><i class="fa fa-check"></i><b>2.7.3</b> Character strings</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#packages"><i class="fa fa-check"></i><b>2.8</b> Packages</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-packages-from-the-console"><i class="fa fa-check"></i><b>2.8.1</b> Installing packages from the console</a></li>
<li class="chapter" data-level="2.8.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#install-the-tidyverse-package"><i class="fa fa-check"></i><b>2.8.2</b> Install the tidyverse package</a></li>
<li class="chapter" data-level="2.8.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-packages-from-the-rstudio-dialog"><i class="fa fa-check"></i><b>2.8.3</b> Installing packages from the RStudio dialog</a></li>
<li class="chapter" data-level="2.8.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#loading-packages-with-the-library-function"><i class="fa fa-check"></i><b>2.8.4</b> Loading packages with the <code>library()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#the-r-help-system"><i class="fa fa-check"></i><b>2.9</b> The R Help System</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#getting-help-from-the-console"><i class="fa fa-check"></i><b>2.9.1</b> Getting help from the console</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html"><i class="fa fa-check"></i><b>3</b> R Markdown and R Notebooks</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#r-notebooks"><i class="fa fa-check"></i><b>3.1</b> R Notebooks</a></li>
<li class="chapter" data-level="3.2" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#creating-an-r-notebook"><i class="fa fa-check"></i><b>3.2</b> Creating an R Notebook</a></li>
<li class="chapter" data-level="3.3" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#the-default-r-notebook-template"><i class="fa fa-check"></i><b>3.3</b> The default R Notebook template</a></li>
<li class="chapter" data-level="3.4" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#code-and-non-code-blocks"><i class="fa fa-check"></i><b>3.4</b> Code and Non-code blocks</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#non-code-blocks"><i class="fa fa-check"></i><b>3.4.1</b> Non-code blocks</a></li>
<li class="chapter" data-level="3.4.2" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#code-blocks"><i class="fa fa-check"></i><b>3.4.2</b> Code blocks</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#running-a-code-chunk"><i class="fa fa-check"></i><b>3.5</b> Running a code chunk</a></li>
<li class="chapter" data-level="3.6" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#running-all-code-chunks-above"><i class="fa fa-check"></i><b>3.6</b> Running all code chunks above</a></li>
<li class="chapter" data-level="3.7" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#knitting-r-markdown-to-html"><i class="fa fa-check"></i><b>3.7</b> “Knitting” R Markdown to HTML</a></li>
<li class="chapter" data-level="3.8" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#sharing-your-reproducible-r-notebook"><i class="fa fa-check"></i><b>3.8</b> Sharing your reproducible R Notebook</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>4</b> Data structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-structures.html"><a href="data-structures.html#vector-arithmetic"><i class="fa fa-check"></i><b>4.1.1</b> Vector Arithmetic</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-structures.html"><a href="data-structures.html#vector-recycling"><i class="fa fa-check"></i><b>4.1.2</b> Vector recycling</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-structures.html"><a href="data-structures.html#simple-statistical-functions-for-numeric-vectors"><i class="fa fa-check"></i><b>4.1.3</b> Simple statistical functions for numeric vectors</a></li>
<li class="chapter" data-level="4.1.4" data-path="data-structures.html"><a href="data-structures.html#indexing-vectors"><i class="fa fa-check"></i><b>4.1.4</b> Indexing Vectors</a></li>
<li class="chapter" data-level="4.1.5" data-path="data-structures.html"><a href="data-structures.html#comparison-operators-applied-to-vectors"><i class="fa fa-check"></i><b>4.1.5</b> Comparison operators applied to vectors</a></li>
<li class="chapter" data-level="4.1.6" data-path="data-structures.html"><a href="data-structures.html#combining-indexing-and-comparison-of-vectors"><i class="fa fa-check"></i><b>4.1.6</b> Combining Indexing and Comparison of Vectors</a></li>
<li class="chapter" data-level="4.1.7" data-path="data-structures.html"><a href="data-structures.html#vector-manipulation"><i class="fa fa-check"></i><b>4.1.7</b> Vector manipulation</a></li>
<li class="chapter" data-level="4.1.8" data-path="data-structures.html"><a href="data-structures.html#vectors-from-regular-sequences"><i class="fa fa-check"></i><b>4.1.8</b> Vectors from regular sequences</a></li>
<li class="chapter" data-level="4.1.9" data-path="data-structures.html"><a href="data-structures.html#additional-functions-for-working-with-vectors"><i class="fa fa-check"></i><b>4.1.9</b> Additional functions for working with vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>4.2</b> Lists</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-structures.html"><a href="data-structures.html#length-and-type-of-lists"><i class="fa fa-check"></i><b>4.2.1</b> Length and type of lists</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-structures.html"><a href="data-structures.html#indexing-lists"><i class="fa fa-check"></i><b>4.2.2</b> Indexing lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-structures.html"><a href="data-structures.html#naming-list-elements"><i class="fa fa-check"></i><b>4.2.3</b> Naming list elements</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-structures.html"><a href="data-structures.html#the-operator"><i class="fa fa-check"></i><b>4.2.4</b> The <code>$</code> operator</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-structures.html"><a href="data-structures.html#changing-and-adding-lists-items"><i class="fa fa-check"></i><b>4.2.5</b> Changing and adding lists items</a></li>
<li class="chapter" data-level="4.2.6" data-path="data-structures.html"><a href="data-structures.html#combining-lists"><i class="fa fa-check"></i><b>4.2.6</b> Combining lists</a></li>
<li class="chapter" data-level="4.2.7" data-path="data-structures.html"><a href="data-structures.html#converting-lists-to-vectors"><i class="fa fa-check"></i><b>4.2.7</b> Converting lists to vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>4.3</b> Data frames</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-structures.html"><a href="data-structures.html#creating-a-data-frame"><i class="fa fa-check"></i><b>4.3.1</b> Creating a data frame</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-structures.html"><a href="data-structures.html#type-and-class-for-data-frames"><i class="fa fa-check"></i><b>4.3.2</b> Type and class for data frames</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-structures.html"><a href="data-structures.html#length-and-dimension-for-data-frames"><i class="fa fa-check"></i><b>4.3.3</b> Length and dimension for data frames</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-structures.html"><a href="data-structures.html#indexing-and-accessing-data-frames"><i class="fa fa-check"></i><b>4.3.4</b> Indexing and accessing data frames</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-structures.html"><a href="data-structures.html#logical-indexing-of-data-frames"><i class="fa fa-check"></i><b>4.3.5</b> Logical indexing of data frames</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-structures.html"><a href="data-structures.html#adding-columns-to-a-data-frame"><i class="fa fa-check"></i><b>4.3.6</b> Adding columns to a data frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html"><i class="fa fa-check"></i><b>5</b> Functions and control flow statements</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#writing-your-own-functions"><i class="fa fa-check"></i><b>5.1</b> Writing your own functions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#function-arguments"><i class="fa fa-check"></i><b>5.1.1</b> Function arguments</a></li>
<li class="chapter" data-level="5.1.2" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#writing-functions-with-optional-arguments"><i class="fa fa-check"></i><b>5.1.2</b> Writing functions with optional arguments</a></li>
<li class="chapter" data-level="5.1.3" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#putting-r-functions-in-scripts"><i class="fa fa-check"></i><b>5.1.3</b> Putting R functions in Scripts</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#control-flow-statements"><i class="fa fa-check"></i><b>5.2</b> Control flow statements</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#if-and-if-else-statements"><i class="fa fa-check"></i><b>5.2.1</b> <code>if</code> and <code>if-else</code> statements</a></li>
<li class="chapter" data-level="5.2.2" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#for-loops"><i class="fa fa-check"></i><b>5.2.2</b> for loops</a></li>
<li class="chapter" data-level="5.2.3" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#break-statement"><i class="fa fa-check"></i><b>5.2.3</b> <code>break</code> statement</a></li>
<li class="chapter" data-level="5.2.4" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#repeat-loops"><i class="fa fa-check"></i><b>5.2.4</b> <code>repeat</code> loops</a></li>
<li class="chapter" data-level="5.2.5" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#next-statement"><i class="fa fa-check"></i><b>5.2.5</b> <code>next</code> statement</a></li>
<li class="chapter" data-level="5.2.6" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#while-statements"><i class="fa fa-check"></i><b>5.2.6</b> while statements</a></li>
<li class="chapter" data-level="5.2.7" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#ifelse"><i class="fa fa-check"></i><b>5.2.7</b> <code>ifelse</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#map-and-related-tools"><i class="fa fa-check"></i><b>5.3</b> <code>map</code> and related tools</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#basic-map"><i class="fa fa-check"></i><b>5.3.1</b> basic <code>map</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#map_if-and-map_at"><i class="fa fa-check"></i><b>5.3.2</b> <code>map_if</code> and <code>map_at</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#mapping-in-parallel-using-map2"><i class="fa fa-check"></i><b>5.3.3</b> mapping in parallel using <code>map2</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#map-variants-that-return-vectors"><i class="fa fa-check"></i><b>5.3.4</b> <code>map</code> variants that return vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Introduction to ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#loading-ggplot2"><i class="fa fa-check"></i><b>6.1</b> Loading ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#example-data-set-andersons-iris-data"><i class="fa fa-check"></i><b>6.2</b> Example data set: Anderson’s Iris Data</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#template-for-single-layer-plots-in-ggplot2"><i class="fa fa-check"></i><b>6.3</b> Template for single layer plots in ggplot2</a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#an-aside-about-function-arguments"><i class="fa fa-check"></i><b>6.4</b> An aside about function arguments</a></li>
<li class="chapter" data-level="6.5" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#strip-plots"><i class="fa fa-check"></i><b>6.5</b> Strip plots</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#jittering-data"><i class="fa fa-check"></i><b>6.5.1</b> Jittering data</a></li>
<li class="chapter" data-level="6.5.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#adding-categorical-information"><i class="fa fa-check"></i><b>6.5.2</b> Adding categorical information</a></li>
<li class="chapter" data-level="6.5.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#rotating-plot-coordinates"><i class="fa fa-check"></i><b>6.5.3</b> Rotating plot coordinates</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#histograms"><i class="fa fa-check"></i><b>6.6</b> Histograms</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#variations-on-histograms-when-considering-categorical-data"><i class="fa fa-check"></i><b>6.6.1</b> Variations on histograms when considering categorical data</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#faceting-to-depict-categorical-information"><i class="fa fa-check"></i><b>6.7</b> Faceting to depict categorical information</a></li>
<li class="chapter" data-level="6.8" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#density-plots"><i class="fa fa-check"></i><b>6.8</b> Density plots</a></li>
<li class="chapter" data-level="6.9" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#violin-or-beanplot"><i class="fa fa-check"></i><b>6.9</b> Violin or Beanplot</a></li>
<li class="chapter" data-level="6.10" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#boxplots"><i class="fa fa-check"></i><b>6.10</b> Boxplots</a></li>
<li class="chapter" data-level="6.11" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#building-complex-visualizations-with-layers"><i class="fa fa-check"></i><b>6.11</b> Building complex visualizations with layers</a></li>
<li class="chapter" data-level="6.12" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#useful-combination-plots"><i class="fa fa-check"></i><b>6.12</b> Useful combination plots</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#boxplot-plus-strip-plot"><i class="fa fa-check"></i><b>6.12.1</b> Boxplot plus strip plot</a></li>
<li class="chapter" data-level="6.12.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#setting-shared-aesthetics"><i class="fa fa-check"></i><b>6.12.2</b> Setting shared aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#ggplot-layers-can-be-assigned-to-variables"><i class="fa fa-check"></i><b>6.13</b> ggplot layers can be assigned to variables</a>
<ul>
<li class="chapter" data-level="6.13.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#violin-plot-plus-strip-plot"><i class="fa fa-check"></i><b>6.13.1</b> Violin plot plus strip plot</a></li>
</ul></li>
<li class="chapter" data-level="6.14" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#adding-titles-and-tweaking-axis-labels"><i class="fa fa-check"></i><b>6.14</b> Adding titles and tweaking axis labels</a></li>
<li class="chapter" data-level="6.15" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#ggplot2-themes"><i class="fa fa-check"></i><b>6.15</b> ggplot2 themes</a>
<ul>
<li class="chapter" data-level="6.15.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#further-customization-with-ggplot2theme"><i class="fa fa-check"></i><b>6.15.1</b> Further customization with <code>ggplot2::theme</code></a></li>
</ul></li>
<li class="chapter" data-level="6.16" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#other-aspects-of-ggplots-can-be-assigned-to-variables"><i class="fa fa-check"></i><b>6.16</b> Other aspects of ggplots can be assigned to variables</a></li>
<li class="chapter" data-level="6.17" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#bivariate-plots"><i class="fa fa-check"></i><b>6.17</b> Bivariate plots</a>
<ul>
<li class="chapter" data-level="6.17.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>6.17.1</b> Scatter plots</a></li>
<li class="chapter" data-level="6.17.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#adding-a-trend-line-to-a-scatter-plot"><i class="fa fa-check"></i><b>6.17.2</b> Adding a trend line to a scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="6.18" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#bivariate-density-plots"><i class="fa fa-check"></i><b>6.18</b> Bivariate density plots</a></li>
<li class="chapter" data-level="6.19" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#combining-scatter-plots-and-density-plots-with-categorical-information"><i class="fa fa-check"></i><b>6.19</b> Combining Scatter Plots and Density Plots with Categorical Information</a></li>
<li class="chapter" data-level="6.20" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#density-plots-with-fill"><i class="fa fa-check"></i><b>6.20</b> Density plots with fill</a></li>
<li class="chapter" data-level="6.21" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#d-bin-and-hex-plots"><i class="fa fa-check"></i><b>6.21</b> 2D bin and hex plots</a></li>
<li class="chapter" data-level="6.22" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#the-cowplot-package"><i class="fa fa-check"></i><b>6.22</b> The <code>cowplot</code> package</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html"><i class="fa fa-check"></i><b>7</b> Introduction to <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#libraries"><i class="fa fa-check"></i><b>7.1</b> Libraries</a></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#reading-data-with-the-readr-package"><i class="fa fa-check"></i><b>7.2</b> Reading data with the <code>readr</code> package</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#reading-excel-files"><i class="fa fa-check"></i><b>7.2.1</b> Reading Excel files</a></li>
<li class="chapter" data-level="7.2.2" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#example-data-nc-births"><i class="fa fa-check"></i><b>7.2.2</b> Example data: NC Births</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#a-note-on-tibbles"><i class="fa fa-check"></i><b>7.3</b> A note on “tibbles”</a></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#data-filtering-and-transformation-with-dplyr"><i class="fa fa-check"></i><b>7.4</b> Data filtering and transformation with <code>dplyr</code></a></li>
<li class="chapter" data-level="7.5" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#dplyrs-verbs"><i class="fa fa-check"></i><b>7.5</b> dplyr’s “verbs”</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#select"><i class="fa fa-check"></i><b>7.5.1</b> <code>select</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#filter"><i class="fa fa-check"></i><b>7.5.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#mutate"><i class="fa fa-check"></i><b>7.5.3</b> <code>mutate</code></a></li>
<li class="chapter" data-level="7.5.4" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#arrange"><i class="fa fa-check"></i><b>7.5.4</b> <code>arrange</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#summarize"><i class="fa fa-check"></i><b>7.5.5</b> <code>summarize</code></a></li>
<li class="chapter" data-level="7.5.6" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#group_by"><i class="fa fa-check"></i><b>7.5.6</b> <code>group_by</code></a></li>
<li class="chapter" data-level="7.5.7" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#combining-grouping-and-summarizing"><i class="fa fa-check"></i><b>7.5.7</b> Combining grouping and summarizing</a></li>
<li class="chapter" data-level="7.5.8" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#scoped-variants-of-mutate-and-summarize"><i class="fa fa-check"></i><b>7.5.8</b> Scoped variants of <code>mutate</code> and <code>summarize</code></a></li>
<li class="chapter" data-level="7.5.9" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#combining-summarize-with-grouping-aesthetics-in-ggplot2"><i class="fa fa-check"></i><b>7.5.9</b> Combining summarize with grouping aesthetics in <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#pipes"><i class="fa fa-check"></i><b>7.6</b> Pipes</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#install-and-load-magrittr"><i class="fa fa-check"></i><b>7.6.1</b> Install and load <code>magrittr</code></a></li>
<li class="chapter" data-level="7.6.2" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#the-basic-pipe-operator"><i class="fa fa-check"></i><b>7.6.2</b> The basic pipe operator</a></li>
<li class="chapter" data-level="7.6.3" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#an-example-without-pipes"><i class="fa fa-check"></i><b>7.6.3</b> An example without pipes</a></li>
<li class="chapter" data-level="7.6.4" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#the-same-example-using-pipes"><i class="fa fa-check"></i><b>7.6.4</b> The same example using pipes</a></li>
<li class="chapter" data-level="7.6.5" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#assigning-the-output-of-a-statement-involving-pipes-to-a-variable"><i class="fa fa-check"></i><b>7.6.5</b> Assigning the output of a statement involving pipes to a variable</a></li>
<li class="chapter" data-level="7.6.6" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#compound-assignment-pipe-operator"><i class="fa fa-check"></i><b>7.6.6</b> Compound assignment pipe operator</a></li>
<li class="chapter" data-level="7.6.7" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#the-dot-operator-with-pipes"><i class="fa fa-check"></i><b>7.6.7</b> The dot operator with pipes</a></li>
<li class="chapter" data-level="7.6.8" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#the-exposition-pipe-operator"><i class="fa fa-check"></i><b>7.6.8</b> The exposition pipe operator</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>8</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-wrangling.html"><a href="data-wrangling.html#libraries-1"><i class="fa fa-check"></i><b>8.1</b> Libraries</a></li>
<li class="chapter" data-level="8.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>8.2</b> Data</a></li>
<li class="chapter" data-level="8.3" data-path="data-wrangling.html"><a href="data-wrangling.html#renaming-data-frame-columms"><i class="fa fa-check"></i><b>8.3</b> Renaming data frame columms</a></li>
<li class="chapter" data-level="8.4" data-path="data-wrangling.html"><a href="data-wrangling.html#dropping-unneeded-columns"><i class="fa fa-check"></i><b>8.4</b> Dropping unneeded columns</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#finding-all-empty-columns"><i class="fa fa-check"></i><b>8.4.1</b> Finding all empty columns</a></li>
<li class="chapter" data-level="8.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#dropping-columns-by-matching-names"><i class="fa fa-check"></i><b>8.4.2</b> Dropping columns by matching names</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="data-wrangling.html"><a href="data-wrangling.html#merging-data-frames"><i class="fa fa-check"></i><b>8.5</b> Merging data frames</a></li>
<li class="chapter" data-level="8.6" data-path="data-wrangling.html"><a href="data-wrangling.html#reshaping-data-with-tidyr"><i class="fa fa-check"></i><b>8.6</b> Reshaping data with tidyr</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="data-wrangling.html"><a href="data-wrangling.html#wide-to-long-conversions-using-tidyrgather"><i class="fa fa-check"></i><b>8.6.1</b> Wide to long conversions using <code>tidyr::gather</code></a></li>
<li class="chapter" data-level="8.6.2" data-path="data-wrangling.html"><a href="data-wrangling.html#extracting-information-from-combined-variables-using-tidyrextract"><i class="fa fa-check"></i><b>8.6.2</b> Extracting information from combined variables using <code>tidyr::extract</code></a></li>
<li class="chapter" data-level="8.6.3" data-path="data-wrangling.html"><a href="data-wrangling.html#subsetting-rows"><i class="fa fa-check"></i><b>8.6.3</b> Subsetting rows</a></li>
<li class="chapter" data-level="8.6.4" data-path="data-wrangling.html"><a href="data-wrangling.html#splitting-columns"><i class="fa fa-check"></i><b>8.6.4</b> Splitting columns</a></li>
<li class="chapter" data-level="8.6.5" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-data-frames"><i class="fa fa-check"></i><b>8.6.5</b> Combining data frames</a></li>
<li class="chapter" data-level="8.6.6" data-path="data-wrangling.html"><a href="data-wrangling.html#sorting-data-frame-rows"><i class="fa fa-check"></i><b>8.6.6</b> Sorting data frame rows</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="data-wrangling.html"><a href="data-wrangling.html#using-your-tidy-data"><i class="fa fa-check"></i><b>8.7</b> Using your tidy data</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#visualizing-gene-expression-time-series"><i class="fa fa-check"></i><b>8.7.1</b> Visualizing gene expression time series</a></li>
<li class="chapter" data-level="8.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#finding-the-most-variable-genes"><i class="fa fa-check"></i><b>8.7.2</b> Finding the most variable genes</a></li>
<li class="chapter" data-level="8.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#heat-maps"><i class="fa fa-check"></i><b>8.7.3</b> Heat maps</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="data-wrangling.html"><a href="data-wrangling.html#long-to-wide-conversion-using-tidyrspread"><i class="fa fa-check"></i><b>8.8</b> Long-to-wide conversion using <code>tidyr::spread</code></a></li>
<li class="chapter" data-level="8.9" data-path="data-wrangling.html"><a href="data-wrangling.html#exploring-bivariate-relationships-using-wide-data"><i class="fa fa-check"></i><b>8.9</b> Exploring bivariate relationships using “wide” data</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="data-wrangling.html"><a href="data-wrangling.html#large-scale-patterns-of-correlations"><i class="fa fa-check"></i><b>8.9.1</b> Large scale patterns of correlations</a></li>
<li class="chapter" data-level="8.9.2" data-path="data-wrangling.html"><a href="data-wrangling.html#adding-new-columns-and-combining-filtered-data-frames"><i class="fa fa-check"></i><b>8.9.2</b> Adding new columns and combining filtered data frames</a></li>
<li class="chapter" data-level="8.9.3" data-path="data-wrangling.html"><a href="data-wrangling.html#a-heat-mapped-sorted-by-correlations"><i class="fa fa-check"></i><b>8.9.3</b> A heat mapped sorted by correlations</a></li>
<li class="chapter" data-level="8.9.4" data-path="data-wrangling.html"><a href="data-wrangling.html#a-fancy-figure"><i class="fa fa-check"></i><b>8.9.4</b> A “fancy” figure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="vector-algebra.html"><a href="vector-algebra.html"><i class="fa fa-check"></i><b>9</b> Vector algebra</a>
<ul>
<li class="chapter" data-level="9.1" data-path="vector-algebra.html"><a href="vector-algebra.html#libraries-2"><i class="fa fa-check"></i><b>9.1</b> Libraries</a></li>
<li class="chapter" data-level="9.2" data-path="vector-algebra.html"><a href="vector-algebra.html#vector-mathematics-in-r"><i class="fa fa-check"></i><b>9.2</b> Vector Mathematics in R</a></li>
<li class="chapter" data-level="9.3" data-path="vector-algebra.html"><a href="vector-algebra.html#simple-statistics-in-vector-form"><i class="fa fa-check"></i><b>9.3</b> Simple statistics in vector form</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="vector-algebra.html"><a href="vector-algebra.html#mean"><i class="fa fa-check"></i><b>9.3.1</b> Mean</a></li>
<li class="chapter" data-level="9.3.2" data-path="vector-algebra.html"><a href="vector-algebra.html#mean-centering"><i class="fa fa-check"></i><b>9.3.2</b> Mean centering</a></li>
<li class="chapter" data-level="9.3.3" data-path="vector-algebra.html"><a href="vector-algebra.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>9.3.3</b> Variance and standard deviation</a></li>
<li class="chapter" data-level="9.3.4" data-path="vector-algebra.html"><a href="vector-algebra.html#covariance-and-correlation"><i class="fa fa-check"></i><b>9.3.4</b> Covariance and correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="matrices-in-r.html"><a href="matrices-in-r.html"><i class="fa fa-check"></i><b>10</b> Matrices in R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="matrices-in-r.html"><a href="matrices-in-r.html#creating-matrices-in-r"><i class="fa fa-check"></i><b>10.1</b> Creating matrices in R</a></li>
<li class="chapter" data-level="10.2" data-path="matrices-in-r.html"><a href="matrices-in-r.html#matrix-arithmetic-operations-in-r"><i class="fa fa-check"></i><b>10.2</b> Matrix arithmetic operations in R</a></li>
<li class="chapter" data-level="10.3" data-path="matrices-in-r.html"><a href="matrices-in-r.html#descriptive-statistics-as-matrix-functions"><i class="fa fa-check"></i><b>10.3</b> Descriptive statistics as matrix functions</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="matrices-in-r.html"><a href="matrices-in-r.html#mean-vector-and-matrix"><i class="fa fa-check"></i><b>10.3.1</b> Mean vector and matrix</a></li>
<li class="chapter" data-level="10.3.2" data-path="matrices-in-r.html"><a href="matrices-in-r.html#deviation-matrix"><i class="fa fa-check"></i><b>10.3.2</b> Deviation matrix</a></li>
<li class="chapter" data-level="10.3.3" data-path="matrices-in-r.html"><a href="matrices-in-r.html#covariance-matrix"><i class="fa fa-check"></i><b>10.3.3</b> Covariance matrix</a></li>
<li class="chapter" data-level="10.3.4" data-path="matrices-in-r.html"><a href="matrices-in-r.html#correlation-matrix"><i class="fa fa-check"></i><b>10.3.4</b> Correlation matrix</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="matrices-in-r.html"><a href="matrices-in-r.html#matrix-inverse"><i class="fa fa-check"></i><b>10.4</b> Matrix Inverse</a></li>
<li class="chapter" data-level="10.5" data-path="matrices-in-r.html"><a href="matrices-in-r.html#solving-sets-of-simultaneous-equations"><i class="fa fa-check"></i><b>10.5</b> Solving sets of simultaneous equations</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html"><i class="fa fa-check"></i><b>11</b> Linear Regression Models I</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#linear-functions"><i class="fa fa-check"></i><b>11.1</b> Linear functions</a></li>
<li class="chapter" data-level="11.2" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#linear-regression"><i class="fa fa-check"></i><b>11.2</b> Linear regression</a></li>
<li class="chapter" data-level="11.3" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#the-optimality-criterion-for-least-squares-regression"><i class="fa fa-check"></i><b>11.3</b> The optimality criterion for least-squares regression</a></li>
<li class="chapter" data-level="11.4" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#geometry-of-linear-regression"><i class="fa fa-check"></i><b>11.4</b> Geometry of linear regression</a></li>
<li class="chapter" data-level="11.5" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#solution-for-the-least-squares-criterion"><i class="fa fa-check"></i><b>11.5</b> Solution for the least-squares criterion</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#bivariate-regression-estimating-coefficients"><i class="fa fa-check"></i><b>11.5.1</b> Bivariate regression, estimating coefficients</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#multiple-regression-estimating-coefficients"><i class="fa fa-check"></i><b>11.5.2</b> Multiple regression, estimating coefficients</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#residuals"><i class="fa fa-check"></i><b>11.6</b> Residuals</a></li>
<li class="chapter" data-level="11.7" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#regression-as-sum-of-squares-decomposition"><i class="fa fa-check"></i><b>11.7</b> Regression as sum-of-squares decomposition</a></li>
<li class="chapter" data-level="11.8" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#variance-explained-by-a-regression-model"><i class="fa fa-check"></i><b>11.8</b> Variance “explained” by a regression model</a></li>
<li class="chapter" data-level="11.9" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#goodness-of-fit"><i class="fa fa-check"></i><b>11.9</b> Goodness of fit</a></li>
<li class="chapter" data-level="11.10" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#interpretting-regression"><i class="fa fa-check"></i><b>11.10</b> Interpretting Regression</a></li>
<li class="chapter" data-level="11.11" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#illustrating-linear-regression-with-simulated-data"><i class="fa fa-check"></i><b>11.11</b> Illustrating linear regression with simulated data</a></li>
<li class="chapter" data-level="11.12" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#calculating-the-regression-model-using-vector-arithmetic"><i class="fa fa-check"></i><b>11.12</b> Calculating the regression model using vector arithmetic</a>
<ul>
<li class="chapter" data-level="11.12.1" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#calculating-the-predicted-values-and-residuals"><i class="fa fa-check"></i><b>11.12.1</b> Calculating the predicted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="11.13" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#plotting-various-aspects-of-a-regression"><i class="fa fa-check"></i><b>11.13</b> Plotting various aspects of a regression</a>
<ul>
<li class="chapter" data-level="11.13.1" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#residual-plots"><i class="fa fa-check"></i><b>11.13.1</b> Residual plots</a></li>
</ul></li>
<li class="chapter" data-level="11.14" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#calculating-the-coefficient-of-determination"><i class="fa fa-check"></i><b>11.14</b> Calculating the coefficient of determination</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html"><i class="fa fa-check"></i><b>12</b> Linear Regression Models II</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#new-libraries-to-install"><i class="fa fa-check"></i><b>12.1</b> New Libraries to install</a></li>
<li class="chapter" data-level="12.2" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#standard-libraries"><i class="fa fa-check"></i><b>12.2</b> Standard libraries</a></li>
<li class="chapter" data-level="12.3" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#specifying-regression-models-in-r"><i class="fa fa-check"></i><b>12.3</b> Specifying Regression Models in R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#interpretting-summary-output-from-lm"><i class="fa fa-check"></i><b>12.3.1</b> Interpretting summary output from lm()</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#quick-bivariate-regression-plots-in-ggplot"><i class="fa fa-check"></i><b>12.4</b> Quick bivariate regression plots in ggplot</a></li>
<li class="chapter" data-level="12.5" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#more-about-the-data-structure-returned-by-lm"><i class="fa fa-check"></i><b>12.5</b> More about the data structure returned by <code>lm()</code></a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#fitted-values"><i class="fa fa-check"></i><b>12.5.1</b> Fitted values</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#getting-the-model-coefficients"><i class="fa fa-check"></i><b>12.5.2</b> Getting the model coefficients</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#broom-a-library-for-converting-model-results-into-data-frames"><i class="fa fa-check"></i><b>12.6</b> Broom: a library for converting model results into data frames</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#broomtidy"><i class="fa fa-check"></i><b>12.6.1</b> <code>broom::tidy</code></a></li>
<li class="chapter" data-level="12.6.2" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#broomaugment"><i class="fa fa-check"></i><b>12.6.2</b> <code>broom::augment</code></a></li>
<li class="chapter" data-level="12.6.3" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#broomglance"><i class="fa fa-check"></i><b>12.6.3</b> <code>broom::glance</code></a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#qq-plots"><i class="fa fa-check"></i><b>12.7</b> qq-plots</a></li>
<li class="chapter" data-level="12.8" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#multiple-regression"><i class="fa fa-check"></i><b>12.8</b> Multiple regression</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#exploration-of-the-trees-data-set"><i class="fa fa-check"></i><b>12.8.1</b> Exploration of the trees data set</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#d-plots"><i class="fa fa-check"></i><b>12.9</b> 3D Plots</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#scatterplot3d"><i class="fa fa-check"></i><b>12.9.1</b> scatterplot3d</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#fitting-the-regression-model"><i class="fa fa-check"></i><b>12.10</b> Fitting the regression model</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#visualizing-the-regression-model-in-scatterplot3d"><i class="fa fa-check"></i><b>12.10.1</b> Visualizing the regression model in scatterplot3d</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#interpretting-the-regression-model"><i class="fa fa-check"></i><b>12.11</b> Interpretting the regression model</a></li>
<li class="chapter" data-level="12.12" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#exploring-the-vector-geometry-of-the-regression-model"><i class="fa fa-check"></i><b>12.12</b> Exploring the Vector Geometry of the Regression Model</a></li>
<li class="chapter" data-level="12.13" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#exploring-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>12.13</b> Exploring the Residuals from the Model Fit</a></li>
<li class="chapter" data-level="12.14" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#an-alternate-model"><i class="fa fa-check"></i><b>12.14</b> An alternate model</a></li>
<li class="chapter" data-level="12.15" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#exploring-the-impact-of-nearly-collinear-predictors-on-regression"><i class="fa fa-check"></i><b>12.15</b> Exploring the impact of nearly collinear predictors on regression</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html"><i class="fa fa-check"></i><b>13</b> Principal Components Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#libraries-3"><i class="fa fa-check"></i><b>13.1</b> Libraries</a></li>
<li class="chapter" data-level="13.2" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#matrices-as-linear-transformations"><i class="fa fa-check"></i><b>13.2</b> Matrices as linear transformations</a></li>
<li class="chapter" data-level="13.3" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#eigenanalysis-in-r"><i class="fa fa-check"></i><b>13.3</b> Eigenanalysis in R</a></li>
<li class="chapter" data-level="13.4" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#principal-components-analysis-in-r"><i class="fa fa-check"></i><b>13.4</b> Principal Components Analysis in R</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#bioenv-dataset"><i class="fa fa-check"></i><b>13.4.1</b> Bioenv dataset</a></li>
<li class="chapter" data-level="13.4.2" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#pca-of-the-bioenv-dataset"><i class="fa fa-check"></i><b>13.4.2</b> PCA of the Bioenv dataset</a></li>
<li class="chapter" data-level="13.4.3" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#calculating-factor-loadings"><i class="fa fa-check"></i><b>13.4.3</b> Calculating Factor Loadings</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#drawing-figures-to-represent-pca"><i class="fa fa-check"></i><b>13.5</b> Drawing Figures to Represent PCA</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#pc-score-plots"><i class="fa fa-check"></i><b>13.5.1</b> PC Score Plots</a></li>
<li class="chapter" data-level="13.5.2" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#simultaneous-depiction-of-observations-and-variables-in-the-pc-space"><i class="fa fa-check"></i><b>13.5.2</b> Simultaneous Depiction of Observations and Variables in the PC Space</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html"><i class="fa fa-check"></i><b>14</b> Canonical Variates Analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#libraries-4"><i class="fa fa-check"></i><b>14.1</b> Libraries</a></li>
<li class="chapter" data-level="14.2" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#discriminant-analysis-in-r"><i class="fa fa-check"></i><b>14.2</b> Discriminant Analysis in R</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#shorthand-formulae-in-r"><i class="fa fa-check"></i><b>14.2.1</b> Shorthand Formulae in R</a></li>
<li class="chapter" data-level="14.2.2" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#working-with-the-output-of-lda"><i class="fa fa-check"></i><b>14.2.2</b> Working with the output of <code>lda()</code></a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#estimating-confidence-regions-for-group-means-in-cva"><i class="fa fa-check"></i><b>14.3</b> Estimating confidence regions for group means in CVA</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#drawing-the-cva-confidence-regions"><i class="fa fa-check"></i><b>14.3.1</b> Drawing the CVA confidence regions</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#calculating-the-within-and-between-group-covariance-matrices"><i class="fa fa-check"></i><b>14.4</b> Calculating the Within and Between Group Covariance Matrices</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#recapitulating-the-cva-analysis-of-lda"><i class="fa fa-check"></i><b>14.4.1</b> Recapitulating the CVA analysis of <code>lda()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="clustering-in-r.html"><a href="clustering-in-r.html"><i class="fa fa-check"></i><b>15</b> Clustering in R</a>
<ul>
<li class="chapter" data-level="15.1" data-path="clustering-in-r.html"><a href="clustering-in-r.html#libraries-5"><i class="fa fa-check"></i><b>15.1</b> Libraries</a></li>
<li class="chapter" data-level="15.2" data-path="clustering-in-r.html"><a href="clustering-in-r.html#data-set"><i class="fa fa-check"></i><b>15.2</b> Data set</a></li>
<li class="chapter" data-level="15.3" data-path="clustering-in-r.html"><a href="clustering-in-r.html#hierarchical-clustering-in-r"><i class="fa fa-check"></i><b>15.3</b> Hierarchical Clustering in R</a></li>
<li class="chapter" data-level="15.4" data-path="clustering-in-r.html"><a href="clustering-in-r.html#manipulating-hierarchical-clusterings-with-dendextend"><i class="fa fa-check"></i><b>15.4</b> Manipulating hierarchical clusterings with dendextend</a></li>
<li class="chapter" data-level="15.5" data-path="clustering-in-r.html"><a href="clustering-in-r.html#plotting-dendrograms-in-dendextend"><i class="fa fa-check"></i><b>15.5</b> Plotting dendrograms in dendextend</a></li>
<li class="chapter" data-level="15.6" data-path="clustering-in-r.html"><a href="clustering-in-r.html#cutting-dendrograms"><i class="fa fa-check"></i><b>15.6</b> Cutting dendrograms</a></li>
<li class="chapter" data-level="15.7" data-path="clustering-in-r.html"><a href="clustering-in-r.html#looking-at-clusters"><i class="fa fa-check"></i><b>15.7</b> Looking at clusters</a></li>
<li class="chapter" data-level="15.8" data-path="clustering-in-r.html"><a href="clustering-in-r.html#generating-a-heat-map-from-a-cluster"><i class="fa fa-check"></i><b>15.8</b> Generating a heat map from a cluster</a></li>
<li class="chapter" data-level="15.9" data-path="clustering-in-r.html"><a href="clustering-in-r.html#working-with-sub-trees"><i class="fa fa-check"></i><b>15.9</b> Working with sub-trees</a></li>
<li class="chapter" data-level="15.10" data-path="clustering-in-r.html"><a href="clustering-in-r.html#setting-dendrogram-parameters-in-dendextend"><i class="fa fa-check"></i><b>15.10</b> Setting dendrogram parameters in dendextend</a></li>
<li class="chapter" data-level="15.11" data-path="clustering-in-r.html"><a href="clustering-in-r.html#combining-heatmaps-and-dendrograms"><i class="fa fa-check"></i><b>15.11</b> Combining heatmaps and dendrograms</a></li>
<li class="chapter" data-level="15.12" data-path="clustering-in-r.html"><a href="clustering-in-r.html#k-meansk-medoids-clustering-in-r"><i class="fa fa-check"></i><b>15.12</b> K-means/K-medoids Clustering in R</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="clustering-in-r.html"><a href="clustering-in-r.html#heat-map-from-k-medoids-cluster"><i class="fa fa-check"></i><b>15.12.1</b> Heat map from k-medoids cluster</a></li>
</ul></li>
<li class="chapter" data-level="15.13" data-path="clustering-in-r.html"><a href="clustering-in-r.html#combining-clusters-and-correlation-matrix-heatmaps"><i class="fa fa-check"></i><b>15.13</b> Combining clusters and correlation matrix heatmaps</a>
<ul>
<li class="chapter" data-level="15.13.1" data-path="clustering-in-r.html"><a href="clustering-in-r.html#hierarchical-clustering-visualized-on-correlation-matrix"><i class="fa fa-check"></i><b>15.13.1</b> Hierarchical clustering, visualized on correlation matrix</a></li>
<li class="chapter" data-level="15.13.2" data-path="clustering-in-r.html"><a href="clustering-in-r.html#k-medoids-clustering-visualized-on-the-correlation-matrix"><i class="fa fa-check"></i><b>15.13.2</b> K-medoids clustering visualized on the correlation matrix</a></li>
</ul></li>
<li class="chapter" data-level="15.14" data-path="clustering-in-r.html"><a href="clustering-in-r.html#depicting-the-data-within-clusters"><i class="fa fa-check"></i><b>15.14</b> Depicting the data within clusters</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html"><i class="fa fa-check"></i><b>16</b> Non-linear regression models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#loess-regression"><i class="fa fa-check"></i><b>16.1</b> LOESS regression</a></li>
<li class="chapter" data-level="16.2" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#logistic-regression"><i class="fa fa-check"></i><b>16.2</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#a-web-app-to-explore-the-logistic-regression-equation"><i class="fa fa-check"></i><b>16.2.1</b> A web app to explore the logistic regression equation</a></li>
<li class="chapter" data-level="16.2.2" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#titanic-data-set"><i class="fa fa-check"></i><b>16.2.2</b> Titanic data set</a></li>
<li class="chapter" data-level="16.2.3" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#subsetting-the-data"><i class="fa fa-check"></i><b>16.2.3</b> Subsetting the data</a></li>
<li class="chapter" data-level="16.2.4" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#visualizing-survival-as-a-function-of-age"><i class="fa fa-check"></i><b>16.2.4</b> Visualizing survival as a function of age</a></li>
<li class="chapter" data-level="16.2.5" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#fitting-the-logistic-regression-model"><i class="fa fa-check"></i><b>16.2.5</b> Fitting the logistic regression model</a></li>
<li class="chapter" data-level="16.2.6" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#visualizing-the-logistic-regression"><i class="fa fa-check"></i><b>16.2.6</b> Visualizing the logistic regression</a></li>
<li class="chapter" data-level="16.2.7" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#quick-and-easy-visualization"><i class="fa fa-check"></i><b>16.2.7</b> Quick and easy visualization</a></li>
<li class="chapter" data-level="16.2.8" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#impact-of-sex-and-passenger-class-on-the-models"><i class="fa fa-check"></i><b>16.2.8</b> Impact of sex and passenger class on the models</a></li>
<li class="chapter" data-level="16.2.9" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#fitting-multiple-models-based-on-groupings-use-dplyrdo"><i class="fa fa-check"></i><b>16.2.9</b> Fitting multiple models based on groupings use <code>dplyr::do</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biology 723: Statistical Computing for Biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clustering-in-r" class="section level1" number="15">
<h1><span class="header-section-number">Chapter 15</span> Clustering in R</h1>
<div id="libraries-5" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> Libraries</h2>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="clustering-in-r.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb449-2"><a href="clustering-in-r.html#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code></pre></div>
</div>
<div id="data-set" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Data set</h2>
<p>To illustrate clustering method, we’ll use a subset of the Spellman et al. gene expression data set we introduced in the <a href="https://bio723-class.github.io/Bio723-book/data-wrangling.html">Data Wrangling</a> chapter. Recall that, Spellman and colleagues tried to identify all the genes in the yeast genome (&gt;6000 genes) that exhibited oscillatory behaviors suggestive of cell cycle regulation. To do so, they measured gene expression over time, using six different types of cell cycle synchronization experiments.</p>
<p>Rather than working with the whole genome, we’re going to focus on clustering ~700 genes that Spellman and colleagues identified as oscillatory. This data set can be loaded from <a href="https://github.com/Bio723-class/example-datasets/raw/master/spellman-wide.csv">this link</a>.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="clustering-in-r.html#cb450-1" aria-hidden="true" tabindex="-1"></a>spellman <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/Bio723-class/example-datasets/raw/master/spellman-wide.csv&quot;</span>)</span>
<span id="cb450-2"><a href="clustering-in-r.html#cb450-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(spellman)</span>
<span id="cb450-3"><a href="clustering-in-r.html#cb450-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  73 726</span></span></code></pre></div>
<p>This data is provided in a tidy “wide” format with genes in columns. The first two columns give the experiment name and the corresponding time point at which the sample was collected. Let’s confirm that the case by looking at the first few rows and columns of the data:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="clustering-in-r.html#cb451-1" aria-hidden="true" tabindex="-1"></a>spellman[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb451-2"><a href="clustering-in-r.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 5 x 8</span></span>
<span id="cb451-3"><a href="clustering-in-r.html#cb451-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   expt   time YAL022C YAL040C YAL053W YAL067C YAR003W YAR007C</span></span>
<span id="cb451-4"><a href="clustering-in-r.html#cb451-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb451-5"><a href="clustering-in-r.html#cb451-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 alpha     0  -0.36     1.04    0.21    0.01   -0.3    -0.48</span></span>
<span id="cb451-6"><a href="clustering-in-r.html#cb451-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 alpha     7  -0.42     0.19   -0.2     0.07   -0.45   -0.42</span></span>
<span id="cb451-7"><a href="clustering-in-r.html#cb451-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 alpha    14   0.290    0.47    0.2     0.17    0.75    0.87</span></span>
<span id="cb451-8"><a href="clustering-in-r.html#cb451-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 alpha    21  -0.14    -1.03    0.15   NA       0.37    0.92</span></span>
<span id="cb451-9"><a href="clustering-in-r.html#cb451-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 alpha    28  -0.19    -0.63    0.38   -0.1     0.27    0.67</span></span></code></pre></div>
</div>
<div id="hierarchical-clustering-in-r" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> Hierarchical Clustering in R</h2>
<p>Hierarchical clustering in R can be carried out using the <code>hclust()</code> function. The <code>method</code> argument to <code>hclust</code> determines the group distance function used (single linkage, complete linkage, average, etc.).</p>
<p>The input to <code>hclust()</code> is a dissimilarity matrix. The function <code>dist()</code> provides some of the basic dissimilarity measures (e.g. Euclidean, Manhattan, Canberra; see method argument of <code>dist</code>) but you can convert an arbitrary square matrix to a distance object by applying the <code>as.dist</code> function to the matrix.</p>
<p>We’re primarily interested in clustering the variables of our data set – genes – in order to discover what sets of gene are expressed in similar patterns (motivated by the idea that genes that are expressed in a similar manner are likely regulated by the same sets of transcription factors). So we need an appropriate similarity/dissimilarity measure for variables. The correlation coefficient is a suitable measure of linear association between variables. Correlations range from 1 for perfectly correlated variables to -1 for anti-correlated variables. Uncorrelated variables have values near zero. Correlation is a measure of similarity so we’ll turn it to into a measure of dissimilarity before passing it to the <code>as.dist</code> function.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="clustering-in-r.html#cb452-1" aria-hidden="true" tabindex="-1"></a>spellman.cor <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(spellman, <span class="sc">-</span>time, <span class="sc">-</span>expt) <span class="sc">%&gt;%</span> </span>
<span id="cb452-2"><a href="clustering-in-r.html#cb452-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>)</span>
<span id="cb452-3"><a href="clustering-in-r.html#cb452-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-4"><a href="clustering-in-r.html#cb452-4" aria-hidden="true" tabindex="-1"></a>spellman.dist <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> spellman.cor)</span></code></pre></div>
<p>The <code>use</code> argument to the <code>cor</code> function specifies that when there are missing
values, the function should use all the available observations that have data
necessary to calculate a correlation for any given pair of genes. We then turn
the correlation into a distance measure by subtracting it from 1 (so perfectly
positively correlated variables have distance 0) and passing it to the <code>as.dist</code>
function.</p>
<p>We’re now ready to put the <code>hclust</code> function to use. We first generate the
hierarchical clustering, use the “complete linkage” method (see lecture slides):</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="clustering-in-r.html#cb453-1" aria-hidden="true" tabindex="-1"></a>spellman.tree <span class="ot">&lt;-</span> <span class="fu">hclust</span>(spellman.dist, <span class="at">method=</span><span class="st">&quot;complete&quot;</span>)</span></code></pre></div>
<p>Having generated the tree object, we can plot it using the multipurpose <code>plot()</code> function (Note that <code>plot()</code> is part of the base R graphics package, and hence unrelated to ggplot):</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="clustering-in-r.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spellman.tree)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-450-1.png" width="960" /></p>
<p>Ugh - that’s an ugly plot! One major problem is that the text labels at the
bottom of the tree are too large, and they’re overlapping each other. We can
tweak that a little by changing the text size with the <code>cex</code> parameter.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="clustering-in-r.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spellman.tree, <span class="at">cex=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-451-1.png" width="960" /></p>
<p>That’s a little better, but we’re going to need some additional tools to wrangle this dendrogram into a more usable state.</p>
</div>
<div id="manipulating-hierarchical-clusterings-with-dendextend" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> Manipulating hierarchical clusterings with dendextend</h2>
<p>To work with and manipulate hierarchical clusterings and to create nicer dendrograms we’re going to use a package called <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/introduction.html">dendextend</a>. Install dendextend via one of the standard package installation mechanisms before proceeding.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="clustering-in-r.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend)</span></code></pre></div>
<p>First we’ll create a <code>dendrogram</code> object from our clustering tree, and use some
<code>dendextend</code> features to examine a few of the properties of the dendrogram.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="clustering-in-r.html#cb457-1" aria-hidden="true" tabindex="-1"></a>spellman.dend <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(spellman.tree) <span class="co"># create dendrogram object</span></span></code></pre></div>
<p><code>dendextend</code> includes a number of functions for examing the tree. For example, to examine the number of “leaves” (= # of genes we clustered) or nodes (= # of leaves + number of internal joins) in the tree we can do the following:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="clustering-in-r.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nleaves</span>(spellman.dend)  <span class="co"># number of leaves in tree</span></span>
<span id="cb458-2"><a href="clustering-in-r.html#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 724</span></span>
<span id="cb458-3"><a href="clustering-in-r.html#cb458-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nnodes</span>(spellman.dend)  <span class="co"># number of nodes (=leaves + joins) in tree</span></span>
<span id="cb458-4"><a href="clustering-in-r.html#cb458-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1447</span></span></code></pre></div>
</div>
<div id="plotting-dendrograms-in-dendextend" class="section level2" number="15.5">
<h2><span class="header-section-number">15.5</span> Plotting dendrograms in dendextend</h2>
<p>The plot function for <code>dendextend</code> dendrogram objects (see <code>?plot.dendrogram</code>) has a number of additional parameters that allows us to tweak the plot. For example, for large dendrograms it often makes sense to remove the leaf labels entirely as they will often be too small to read. This can be accomplished using the <code>leaflab</code> argument:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="clustering-in-r.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spellman.dend, <span class="at">leaflab =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-455-1.png" width="960" /></p>
</div>
<div id="cutting-dendrograms" class="section level2" number="15.6">
<h2><span class="header-section-number">15.6</span> Cutting dendrograms</h2>
<p>When looking at the figure we just generated it looks like there may be four
major clusters. We’ll use the <code>cutree</code> function to cut the tree into four pieces
and examine the implied clustering (note that the <code>cutree</code> function can also be
used to cut the tree at a specified height).</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="clustering-in-r.html#cb460-1" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(spellman.dend, <span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb460-2"><a href="clustering-in-r.html#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clusters)</span>
<span id="cb460-3"><a href="clustering-in-r.html#cb460-3" aria-hidden="true" tabindex="-1"></a><span class="do">## clusters</span></span>
<span id="cb460-4"><a href="clustering-in-r.html#cb460-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   2   3   4 </span></span>
<span id="cb460-5"><a href="clustering-in-r.html#cb460-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 189 144 227 164</span></span></code></pre></div>
<p>When we cut the tree we got four clusters, whose size is given by the <code>table</code> command above. If you examine the <code>cutree</code> documentation (reminder: use <code>?cutree</code> from the command line) you will see that it returns a vector of integers, giving the corresponding cluster to which each variable (gene) is assigned. The code below shows the cluster assignments for the first six genes.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="clustering-in-r.html#cb461-1" aria-hidden="true" tabindex="-1"></a>clusters[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb461-2"><a href="clustering-in-r.html#cb461-2" aria-hidden="true" tabindex="-1"></a><span class="do">## YAL022C YAL040C YAL053W YAL067C YAR003W YAR007C </span></span>
<span id="cb461-3"><a href="clustering-in-r.html#cb461-3" aria-hidden="true" tabindex="-1"></a><span class="do">##       1       2       3       4       3       3</span></span></code></pre></div>
<p>Next let’s create a nicer plot that highlights each of the clusters. The
function <code>color_branches()</code> does essentially the same thing as <code>cutree</code> but it
returns information that the <code>plot</code> function can use to appropriately color
branches of the tree according to cluster membership.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="clustering-in-r.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">color_branches</span>(spellman.dend, <span class="at">k=</span><span class="dv">4</span>),<span class="at">leaflab=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-458-1.png" width="960" /></p>
<p>Now we’re getting somewhere! However, our clusters are still pretty big. Let’s
check out the clusterings we get when we cut with eight clusters rather than
four.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="clustering-in-r.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">color_branches</span>(spellman.dend, <span class="at">k=</span><span class="dv">8</span>),<span class="at">leaflab=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-459-1.png" width="960" />
And here are the number of genes in each cluster:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="clustering-in-r.html#cb464-1" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(spellman.dend, <span class="at">k=</span><span class="dv">8</span>, <span class="at">order_clusters_as_data =</span> <span class="cn">FALSE</span>)</span>
<span id="cb464-2"><a href="clustering-in-r.html#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clusters)</span>
<span id="cb464-3"><a href="clustering-in-r.html#cb464-3" aria-hidden="true" tabindex="-1"></a><span class="do">## clusters</span></span>
<span id="cb464-4"><a href="clustering-in-r.html#cb464-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   2   3   4   5   6   7   8 </span></span>
<span id="cb464-5"><a href="clustering-in-r.html#cb464-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 164 169  58  81 108  74  16  54</span></span></code></pre></div>
</div>
<div id="looking-at-clusters" class="section level2" number="15.7">
<h2><span class="header-section-number">15.7</span> Looking at clusters</h2>
<p>To further explore the clusters, let’s create a data frame that holds the information about genes and their cluster assignments:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="clustering-in-r.html#cb465-1" aria-hidden="true" tabindex="-1"></a>clusters.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gene =</span> <span class="fu">names</span>(clusters), <span class="at">cluster =</span> clusters)</span></code></pre></div>
<p>Having created this data frame, it’s straightforward to lookup the cluster to which a gene belongs:</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="clustering-in-r.html#cb466-1" aria-hidden="true" tabindex="-1"></a>clusters.df[<span class="st">&quot;YAL022C&quot;</span>,]</span>
<span id="cb466-2"><a href="clustering-in-r.html#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 1 x 2</span></span>
<span id="cb466-3"><a href="clustering-in-r.html#cb466-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   gene    cluster</span></span>
<span id="cb466-4"><a href="clustering-in-r.html#cb466-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;     &lt;int&gt;</span></span>
<span id="cb466-5"><a href="clustering-in-r.html#cb466-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 YAL022C       5</span></span></code></pre></div>
<p>or to get all the names of genes in a given cluster:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="clustering-in-r.html#cb467-1" aria-hidden="true" tabindex="-1"></a>cluster3.genes <span class="ot">&lt;-</span> <span class="fu">filter</span>(clusters.df, cluster <span class="sc">==</span> <span class="dv">3</span>)<span class="sc">$</span>gene</span>
<span id="cb467-2"><a href="clustering-in-r.html#cb467-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-3"><a href="clustering-in-r.html#cb467-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">as.character</span>(cluster3.genes[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]), <span class="at">quote=</span><span class="cn">FALSE</span>,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb467-4"><a href="clustering-in-r.html#cb467-4" aria-hidden="true" tabindex="-1"></a><span class="do">## YEL068C</span></span>
<span id="cb467-5"><a href="clustering-in-r.html#cb467-5" aria-hidden="true" tabindex="-1"></a><span class="do">## YOR242C</span></span>
<span id="cb467-6"><a href="clustering-in-r.html#cb467-6" aria-hidden="true" tabindex="-1"></a><span class="do">## YKL172W</span></span>
<span id="cb467-7"><a href="clustering-in-r.html#cb467-7" aria-hidden="true" tabindex="-1"></a><span class="do">## YBR087W</span></span>
<span id="cb467-8"><a href="clustering-in-r.html#cb467-8" aria-hidden="true" tabindex="-1"></a><span class="do">## YJR043C</span></span>
<span id="cb467-9"><a href="clustering-in-r.html#cb467-9" aria-hidden="true" tabindex="-1"></a><span class="do">## YLR154C</span></span>
<span id="cb467-10"><a href="clustering-in-r.html#cb467-10" aria-hidden="true" tabindex="-1"></a><span class="do">## YGR276C</span></span>
<span id="cb467-11"><a href="clustering-in-r.html#cb467-11" aria-hidden="true" tabindex="-1"></a><span class="do">## YGR042W</span></span>
<span id="cb467-12"><a href="clustering-in-r.html#cb467-12" aria-hidden="true" tabindex="-1"></a><span class="do">## YPL232W</span></span>
<span id="cb467-13"><a href="clustering-in-r.html#cb467-13" aria-hidden="true" tabindex="-1"></a><span class="do">## YOR355W</span></span>
<span id="cb467-14"><a href="clustering-in-r.html#cb467-14" aria-hidden="true" tabindex="-1"></a><span class="do">## FALSE</span></span></code></pre></div>
<p>Note the use of the <code>cat</code> function to print out a list of the gene names for
cluster 7, with the names separated by returns (<code>"\n"</code>). This is useful if you
want to cut and paste the gene names into a document, or an online analysis tool
such as various Gene Ontology (GO) browsers (we’ll talk about these in a later
class session).</p>
</div>
<div id="generating-a-heat-map-from-a-cluster" class="section level2" number="15.8">
<h2><span class="header-section-number">15.8</span> Generating a heat map from a cluster</h2>
<p>Let’s generate a heat map showing the expression of all the genes in the alpha factor experiment for the first cluster that we found above. To generate this visualization it will be convenient to work with the data in a tidy long format, so we use <code>dplyr::gather</code> to restructure the data first:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="clustering-in-r.html#cb468-1" aria-hidden="true" tabindex="-1"></a>spellman.long <span class="ot">&lt;-</span> <span class="fu">gather</span>(spellman, gene, expression, <span class="sc">-</span>time, <span class="sc">-</span>expt) </span>
<span id="cb468-2"><a href="clustering-in-r.html#cb468-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(spellman.long)</span>
<span id="cb468-3"><a href="clustering-in-r.html#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 x 4</span></span>
<span id="cb468-4"><a href="clustering-in-r.html#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   expt   time gene    expression</span></span>
<span id="cb468-5"><a href="clustering-in-r.html#cb468-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;</span></span>
<span id="cb468-6"><a href="clustering-in-r.html#cb468-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 alpha     0 YAL022C     -0.36 </span></span>
<span id="cb468-7"><a href="clustering-in-r.html#cb468-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 alpha     7 YAL022C     -0.42 </span></span>
<span id="cb468-8"><a href="clustering-in-r.html#cb468-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 alpha    14 YAL022C      0.290</span></span>
<span id="cb468-9"><a href="clustering-in-r.html#cb468-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 alpha    21 YAL022C     -0.14 </span></span>
<span id="cb468-10"><a href="clustering-in-r.html#cb468-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 alpha    28 YAL022C     -0.19 </span></span>
<span id="cb468-11"><a href="clustering-in-r.html#cb468-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 alpha    35 YAL022C     -0.52</span></span></code></pre></div>
<p>Having restructured the data we can now generate our desired heat map:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="clustering-in-r.html#cb469-1" aria-hidden="true" tabindex="-1"></a>color.scheme <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&quot;RdBu&quot;</span>)) <span class="co"># generate the color scheme to use</span></span>
<span id="cb469-2"><a href="clustering-in-r.html#cb469-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-3"><a href="clustering-in-r.html#cb469-3" aria-hidden="true" tabindex="-1"></a>spellman.long <span class="sc">%&gt;%</span></span>
<span id="cb469-4"><a href="clustering-in-r.html#cb469-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gene <span class="sc">%in%</span> cluster3.genes <span class="sc">&amp;</span> expt <span class="sc">==</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb469-5"><a href="clustering-in-r.html#cb469-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> gene)) <span class="sc">+</span> </span>
<span id="cb469-6"><a href="clustering-in-r.html#cb469-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> expression)) <span class="sc">+</span></span>
<span id="cb469-7"><a href="clustering-in-r.html#cb469-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors=</span>color.scheme, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb469-8"><a href="clustering-in-r.html#cb469-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))  <span class="co"># set size of y axis labels</span></span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-465-1.png" width="576" /></p>
</div>
<div id="working-with-sub-trees" class="section level2" number="15.9">
<h2><span class="header-section-number">15.9</span> Working with sub-trees</h2>
<p>The <code>cutree()</code> function illustrated above gives us the groupings implied by cutting the tree at a certain height. However, it does not explicitly return objects representing the sub-trees themselves. If you want to do computations or generate figures of the sub-trees, you’ll need to use the <code>cut()</code> function.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="clustering-in-r.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note that I determined the height to cut at by looking at the colored dendrogram</span></span>
<span id="cb470-2"><a href="clustering-in-r.html#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot above for 8 clusters</span></span>
<span id="cb470-3"><a href="clustering-in-r.html#cb470-3" aria-hidden="true" tabindex="-1"></a>sub.trees <span class="ot">&lt;-</span> <span class="fu">cut</span>(spellman.dend, <span class="at">h =</span> <span class="fl">1.48</span>)</span></code></pre></div>
<p>The <code>cut</code> function returns multiple sub-trees designated <code>upper</code> and
<code>lower</code>. The upper tree is the tree “above” the cut, while the multiple
“lower” trees represent the disconnected sub-trees “below” the cut. For
purposes of clustering you usually are most interested in the sub-trees
(clusters) below the cut.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="clustering-in-r.html#cb471-1" aria-hidden="true" tabindex="-1"></a>sub.trees<span class="sc">$</span>lower</span>
<span id="cb471-2"><a href="clustering-in-r.html#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb471-3"><a href="clustering-in-r.html#cb471-3" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 164 members total, at height 1.469983 </span></span>
<span id="cb471-4"><a href="clustering-in-r.html#cb471-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb471-5"><a href="clustering-in-r.html#cb471-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb471-6"><a href="clustering-in-r.html#cb471-6" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 169 members total, at height 1.178098 </span></span>
<span id="cb471-7"><a href="clustering-in-r.html#cb471-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb471-8"><a href="clustering-in-r.html#cb471-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [[3]]</span></span>
<span id="cb471-9"><a href="clustering-in-r.html#cb471-9" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 58 members total, at height 1.32836 </span></span>
<span id="cb471-10"><a href="clustering-in-r.html#cb471-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb471-11"><a href="clustering-in-r.html#cb471-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [[4]]</span></span>
<span id="cb471-12"><a href="clustering-in-r.html#cb471-12" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 81 members total, at height 1.231597 </span></span>
<span id="cb471-13"><a href="clustering-in-r.html#cb471-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb471-14"><a href="clustering-in-r.html#cb471-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [[5]]</span></span>
<span id="cb471-15"><a href="clustering-in-r.html#cb471-15" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 108 members total, at height 1.366951 </span></span>
<span id="cb471-16"><a href="clustering-in-r.html#cb471-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb471-17"><a href="clustering-in-r.html#cb471-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [[6]]</span></span>
<span id="cb471-18"><a href="clustering-in-r.html#cb471-18" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 74 members total, at height 1.463623 </span></span>
<span id="cb471-19"><a href="clustering-in-r.html#cb471-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb471-20"><a href="clustering-in-r.html#cb471-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [[7]]</span></span>
<span id="cb471-21"><a href="clustering-in-r.html#cb471-21" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 16 members total, at height 1.041689 </span></span>
<span id="cb471-22"><a href="clustering-in-r.html#cb471-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb471-23"><a href="clustering-in-r.html#cb471-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [[8]]</span></span>
<span id="cb471-24"><a href="clustering-in-r.html#cb471-24" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 54 members total, at height 1.188419</span></span></code></pre></div>
<p>We can retrieve any particular sub-tree by indexing into the list:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="clustering-in-r.html#cb472-1" aria-hidden="true" tabindex="-1"></a>cluster3.tree <span class="ot">&lt;-</span> sub.trees<span class="sc">$</span>lower[[<span class="dv">3</span>]]</span>
<span id="cb472-2"><a href="clustering-in-r.html#cb472-2" aria-hidden="true" tabindex="-1"></a>cluster3.tree</span>
<span id="cb472-3"><a href="clustering-in-r.html#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;dendrogram&#39; with 2 branches and 58 members total, at height 1.32836</span></span>
<span id="cb472-4"><a href="clustering-in-r.html#cb472-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nleaves</span>(cluster3.tree)</span>
<span id="cb472-5"><a href="clustering-in-r.html#cb472-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 58</span></span></code></pre></div>
</div>
<div id="setting-dendrogram-parameters-in-dendextend" class="section level2" number="15.10">
<h2><span class="header-section-number">15.10</span> Setting dendrogram parameters in dendextend</h2>
<p><code>dendextend</code> has a generic function – <code>set()</code> – for changing the parameters associated with dendrograms. The basic form of the function is <code>set(object, what, value)</code>, where <code>object</code> is the dendrogram you’re working with, <code>what</code> is a character string indicating the parameter you want to change, and <code>value</code> is the setting you wishing to assign to that parameter.</p>
<p>A full list of dendrogram parameters that can be changed is provided in the <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/introduction.html#the-set-function">dendextend</a> documentation.</p>
<p>We’ll use the <code>set</code> function to make a nice diagram of our cluster 3 sub-tree:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="clustering-in-r.html#cb473-1" aria-hidden="true" tabindex="-1"></a>cluster3.tree  <span class="sc">%&gt;%</span></span>
<span id="cb473-2"><a href="clustering-in-r.html#cb473-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set</span>(<span class="st">&quot;labels_cex&quot;</span>, <span class="fl">0.45</span>) <span class="sc">%&gt;%</span></span>
<span id="cb473-3"><a href="clustering-in-r.html#cb473-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set</span>(<span class="st">&quot;labels_col&quot;</span>, <span class="st">&quot;red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb473-4"><a href="clustering-in-r.html#cb473-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">horiz =</span> <span class="cn">TRUE</span>)  <span class="co"># plot horizontally</span></span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-469-1.png" width="576" /></p>
</div>
<div id="combining-heatmaps-and-dendrograms" class="section level2" number="15.11">
<h2><span class="header-section-number">15.11</span> Combining heatmaps and dendrograms</h2>
<p>A common visualization used in transcriptome studies is to combine dendrograms and heatmaps. To do this with a minimum of fuss we’ll use a package called “gplots” which includes a heatmap function that will also plot dendrograms next. Install “gplots” via the standard package installation mechanism.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="clustering-in-r.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span></code></pre></div>
<p>The gplots function we will use is called <code>heatmap.2</code>. This function requires as input our data in the form of a matrix. If you provide no other information <code>heatmap.2</code> will carry out clustering for you, clustering both the rows and columns of the data matrix.</p>
<p>However, here we want to draw a dendrogram (representing similarity among variables) we’ve already calculated, and to create a heat map just for the alpha factor data, so we need to do some pre-calculations and tweak the <code>heatmap.2</code> arguments:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="clustering-in-r.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset out the alpha factor data</span></span>
<span id="cb475-2"><a href="clustering-in-r.html#cb475-2" aria-hidden="true" tabindex="-1"></a>alpha.factor <span class="ot">&lt;-</span> <span class="fu">filter</span>(spellman, expt <span class="sc">==</span> <span class="st">&quot;alpha&quot;</span>)</span>
<span id="cb475-3"><a href="clustering-in-r.html#cb475-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-4"><a href="clustering-in-r.html#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create matrix after dropping time and expt columns</span></span>
<span id="cb475-5"><a href="clustering-in-r.html#cb475-5" aria-hidden="true" tabindex="-1"></a>alpha.mtx <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(alpha.factor, <span class="sc">-</span>time, <span class="sc">-</span>expt)) <span class="co"># drop time, expt columns</span></span>
<span id="cb475-6"><a href="clustering-in-r.html#cb475-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-7"><a href="clustering-in-r.html#cb475-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set row names to corresponding time points for nice plotting</span></span>
<span id="cb475-8"><a href="clustering-in-r.html#cb475-8" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(alpha.mtx) <span class="ot">&lt;-</span> alpha.factor<span class="sc">$</span>time</span>
<span id="cb475-9"><a href="clustering-in-r.html#cb475-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-10"><a href="clustering-in-r.html#cb475-10" aria-hidden="true" tabindex="-1"></a><span class="co"># transpose the matrix so genes are drawn in rows</span></span>
<span id="cb475-11"><a href="clustering-in-r.html#cb475-11" aria-hidden="true" tabindex="-1"></a>transposed.alpha.mtx <span class="ot">&lt;-</span> <span class="fu">t</span>(alpha.mtx)</span></code></pre></div>
<p>Having defined the data we want to plot in the heatmap we can now use <code>heatmap.2</code> as follows</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="clustering-in-r.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is a large figure, so if working in RMarkdown document I suggest specifying</span></span>
<span id="cb476-2"><a href="clustering-in-r.html#cb476-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the code block header as so to make the figure large</span></span>
<span id="cb476-3"><a href="clustering-in-r.html#cb476-3" aria-hidden="true" tabindex="-1"></a><span class="co"># {r, fig.width = 8, fig.height = 8}</span></span>
<span id="cb476-4"><a href="clustering-in-r.html#cb476-4" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(transposed.alpha.mtx,</span>
<span id="cb476-5"><a href="clustering-in-r.html#cb476-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rowv =</span> cluster3.tree,  <span class="co"># use the dendrogram previously calculated</span></span>
<span id="cb476-6"><a href="clustering-in-r.html#cb476-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="cn">NULL</span>, <span class="co"># don&#39;t mess with my columns! (i.e. keep current ordering )</span></span>
<span id="cb476-7"><a href="clustering-in-r.html#cb476-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">&quot;row&quot;</span>,   <span class="co"># only draw row dendrograms</span></span>
<span id="cb476-8"><a href="clustering-in-r.html#cb476-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">9</span>),  <span class="co"># OPTIONAL: set break points for colors</span></span>
<span id="cb476-9"><a href="clustering-in-r.html#cb476-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> color.scheme,  <span class="co"># use previously defined colors</span></span>
<span id="cb476-10"><a href="clustering-in-r.html#cb476-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">&quot;none&quot;</span>, <span class="at">density.info =</span> <span class="st">&quot;none&quot;</span>,  <span class="co"># remove distracting elements of plot</span></span>
<span id="cb476-11"><a href="clustering-in-r.html#cb476-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Time (mins)&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-472-1.png" width="768" /></p>
</div>
<div id="k-meansk-medoids-clustering-in-r" class="section level2" number="15.12">
<h2><span class="header-section-number">15.12</span> K-means/K-medoids Clustering in R</h2>
<p>The <code>kmeans()</code> function calculates standard k-means clusters in R. However, we’re actually going to use a related function that calculates “k-medoids” clustering. K-medoids clustering differs from k-means in that the objective function is to minimize the sum of dissimilarities from the cluster centers (“medoids”) rather then the sum of squared distances. K-medoids clustering tends to be more robust to outliers than K-means. Another advantage for our purposes is that the k-medoids algorithm, unlike the standard implementation of k-means, can accept a distance or dissimilarity matrix as input.</p>
<p>K-medoids clustering is implemented in the function <code>pam()</code> (Partitioning Around Medoids), which is found in a package called <code>cluster</code> that is included with the standard R installation.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="clustering-in-r.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb477-2"><a href="clustering-in-r.html#cb477-2" aria-hidden="true" tabindex="-1"></a>spellman.kmedoids <span class="ot">&lt;-</span> <span class="fu">pam</span>(spellman.dist, <span class="dv">8</span>) <span class="co"># create k-medoids clustering with 8 clusters</span></span>
<span id="cb477-3"><a href="clustering-in-r.html#cb477-3" aria-hidden="true" tabindex="-1"></a>kclusters <span class="ot">&lt;-</span> spellman.kmedoids<span class="sc">$</span>cluster</span>
<span id="cb477-4"><a href="clustering-in-r.html#cb477-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(kclusters)</span>
<span id="cb477-5"><a href="clustering-in-r.html#cb477-5" aria-hidden="true" tabindex="-1"></a><span class="do">## kclusters</span></span>
<span id="cb477-6"><a href="clustering-in-r.html#cb477-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   1   2   3   4   5   6   7   8 </span></span>
<span id="cb477-7"><a href="clustering-in-r.html#cb477-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 121 104  70  95  85  94  65  90</span></span></code></pre></div>
<p>K-medoids (or K-means) will, in general, find different clusterings than our hierarchical clustering illustrated previously. For comparison with our earlier hierarchical clustering results, lets plot the k-medoids inferred clusters back onto our earlier dendrogram.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="clustering-in-r.html#cb478-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># reorder genes so they match the dendrogram</span></span>
<span id="cb478-2"><a href="clustering-in-r.html#cb478-2" aria-hidden="true" tabindex="-1"></a>kclusters.reordered <span class="ot">&lt;-</span> kclusters[<span class="fu">order.dendrogram</span>(spellman.dend)]</span>
<span id="cb478-3"><a href="clustering-in-r.html#cb478-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-4"><a href="clustering-in-r.html#cb478-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get  branch colors so we&#39;re using the same palette</span></span>
<span id="cb478-5"><a href="clustering-in-r.html#cb478-5" aria-hidden="true" tabindex="-1"></a>dend.colors <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">get_leaves_branches_attr</span>(<span class="fu">color_branches</span>(spellman.dend, <span class="at">k=</span><span class="dv">8</span>), <span class="at">attr=</span><span class="st">&quot;col&quot;</span>))</span>
<span id="cb478-6"><a href="clustering-in-r.html#cb478-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-7"><a href="clustering-in-r.html#cb478-7" aria-hidden="true" tabindex="-1"></a><span class="co"># color the branches according to their k-means cluster assignment</span></span>
<span id="cb478-8"><a href="clustering-in-r.html#cb478-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">branches_attr_by_clusters</span>(spellman.dend, kclusters.reordered , dend.colors),<span class="at">leaflab=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-474-1.png" width="960" /></p>
<p>Comparing the inferred k-medoids clustering to our previous complete linkage
clustering we see some clusters that are similar between the two, but there are
also significant differences.</p>
<div id="heat-map-from-k-medoids-cluster" class="section level3" number="15.12.1">
<h3><span class="header-section-number">15.12.1</span> Heat map from k-medoids cluster</h3>
<p>In the same manner we generated a heat map for one of the hierarchical clustering sub-trees, we can generate a similar heat map for a k-medoids cluster. Let’s examine cluster 4:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="clustering-in-r.html#cb479-1" aria-hidden="true" tabindex="-1"></a>kcluster4.genes <span class="ot">&lt;-</span> <span class="fu">names</span>(kclusters[kclusters <span class="sc">==</span> <span class="dv">4</span>])</span>
<span id="cb479-2"><a href="clustering-in-r.html#cb479-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-3"><a href="clustering-in-r.html#cb479-3" aria-hidden="true" tabindex="-1"></a>spellman.long <span class="sc">%&gt;%</span></span>
<span id="cb479-4"><a href="clustering-in-r.html#cb479-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gene <span class="sc">%in%</span> kcluster4.genes <span class="sc">&amp;</span> expt <span class="sc">==</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb479-5"><a href="clustering-in-r.html#cb479-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> gene)) <span class="sc">+</span> </span>
<span id="cb479-6"><a href="clustering-in-r.html#cb479-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> expression)) <span class="sc">+</span></span>
<span id="cb479-7"><a href="clustering-in-r.html#cb479-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradientn</span>(<span class="at">colors=</span>color.scheme, <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb479-8"><a href="clustering-in-r.html#cb479-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;K-medoids Clustering of Spellman et al. Data</span><span class="sc">\n</span><span class="st">Cluster 4&quot;</span>) <span class="sc">+</span> </span>
<span id="cb479-9"><a href="clustering-in-r.html#cb479-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))  <span class="co"># set size of y axis labels</span></span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-475-1.png" width="576" /></p>
</div>
</div>
<div id="combining-clusters-and-correlation-matrix-heatmaps" class="section level2" number="15.13">
<h2><span class="header-section-number">15.13</span> Combining clusters and correlation matrix heatmaps</h2>
<p>How do we know if we have a sensible clustering? For example, above we illustrated how to use complete linkage clustering and the k-medoids algorithm to produce two different clusterings of the same data. We produce a result with 8 clusters for each, but there were significant differences in terms of the membership of genes in each cluster. Which one of these methods produced a “better” result for the data in hand?</p>
<p>There are many criteria – biological, mathematical, computational – one might apply to answer such a question, but for now let’s consider the idea that a good clustering is one that produces “natural groups” in data. In the lecture slides , I proferred the following “common sense” definition of natural groups:</p>
<dl>
<dt>Natural Groups</dt>
<dd><p>Groups of objects where the similarity between objects is higher within groups than between groups.</p>
</dd>
</dl>
<p>How might we evaluate a proposed clustering with respect to this definition of natural groups? One way to do so is the examine our matrix of similarity according to the implied clusters to see if the clusters are consistent with high within group similarity and low between group similarity.</p>
<p>In the clustering applications we’ve looked at so far, our measure of similarity has been based on correlations. We’ll first look at the “raw” correlation matrix, unsorted with respect to the implied clusterings, and then we’ll take a look at the correlation matrix sorted by hierarchical clustering and then k-medoids clustering.</p>
<p>We can use the <code>heatmap.2()</code> function to visualize the correlation matrix.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="clustering-in-r.html#cb480-1" aria-hidden="true" tabindex="-1"></a>color.scheme <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">10</span>,<span class="st">&quot;RdBu&quot;</span>)) <span class="co"># generate the color scheme to use</span></span>
<span id="cb480-2"><a href="clustering-in-r.html#cb480-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-3"><a href="clustering-in-r.html#cb480-3" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(spellman.cor, </span>
<span id="cb480-4"><a href="clustering-in-r.html#cb480-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rowv =</span> <span class="cn">NULL</span>, <span class="co"># don&#39;t cluster rows</span></span>
<span id="cb480-5"><a href="clustering-in-r.html#cb480-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="cn">NULL</span>, <span class="co"># don&#39;t cluster columns</span></span>
<span id="cb480-6"><a href="clustering-in-r.html#cb480-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">&quot;none&quot;</span>, <span class="co"># don&#39;t draw dendrograms</span></span>
<span id="cb480-7"><a href="clustering-in-r.html#cb480-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">&quot;none&quot;</span>, <span class="at">density.info =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb480-8"><a href="clustering-in-r.html#cb480-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> color.scheme, <span class="at">keysize  =</span> <span class="dv">1</span>,</span>
<span id="cb480-9"><a href="clustering-in-r.html#cb480-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labRow =</span> <span class="cn">FALSE</span>, <span class="at">labCol =</span> <span class="cn">FALSE</span>,</span>
<span id="cb480-10"><a href="clustering-in-r.html#cb480-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;genes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;genes&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-476-1.png" width="768" /></p>
<p>A correlation matrix is a square symmetric matrix. The dark red line down the diagonal represents correlations of genes with themselves (i.e. perfectly correlated). Off diagonal elements range from blue (negative correlations) to gray (near zero correlations) to red (positive correlations).</p>
<div id="hierarchical-clustering-visualized-on-correlation-matrix" class="section level3" number="15.13.1">
<h3><span class="header-section-number">15.13.1</span> Hierarchical clustering, visualized on correlation matrix</h3>
<p>Now let’s re-generate the heatmap of the correlation matrix with the genes sorted by our hierarchical clustering:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="clustering-in-r.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(spellman.cor, </span>
<span id="cb481-2"><a href="clustering-in-r.html#cb481-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rowv =</span> <span class="fu">ladderize</span>(spellman.dend), </span>
<span id="cb481-3"><a href="clustering-in-r.html#cb481-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="fu">ladderize</span>(spellman.dend), </span>
<span id="cb481-4"><a href="clustering-in-r.html#cb481-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb481-5"><a href="clustering-in-r.html#cb481-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">revC =</span> <span class="cn">TRUE</span>,  <span class="co"># rev column order of dendrogram so conforms to natural representation</span></span>
<span id="cb481-6"><a href="clustering-in-r.html#cb481-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb481-7"><a href="clustering-in-r.html#cb481-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb481-8"><a href="clustering-in-r.html#cb481-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> color.scheme, <span class="at">key =</span> <span class="cn">FALSE</span>,</span>
<span id="cb481-9"><a href="clustering-in-r.html#cb481-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labRow =</span> <span class="cn">FALSE</span>, <span class="at">labCol =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-477-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>This reordered correlation matrix (and accompanying dendrograms) are useful for a number of purposes. First, the block structure along the diagonal indicates the correlation structure within the implied clusters. Uniformity in sign and magnitude of the on-diagongal blocks is an indicator of “within cluster” similarity. The off-diagonal blocks indicate the relationship <em>between clusters</em>. For example, the four “major” clusterings implied by the dendrogram are apparent in the block structure of the correlation matrix, but we also see that the two clusters at the bottom of the figure show some patches of weak or even negative correlations, suggesting that those may not be natural clusters. Also apparent are relationships between clusters – for example we see that genes in the first cluster (upper left of diagram) share strong positive correlations with many genes in the right half of the second cluster. The same relationship, though to a lesser extant, is apparent between clusters one and four.</p>
</div>
<div id="k-medoids-clustering-visualized-on-the-correlation-matrix" class="section level3" number="15.13.2">
<h3><span class="header-section-number">15.13.2</span> K-medoids clustering visualized on the correlation matrix</h3>
<p>Let’s do a similar sorting of the correlation matrix based on k-medoids clustering.</p>
<p>Since there is no dendrogram to pass to the <code>heatmap.2</code> function, we’ll sort the correlation matrix ourselves by indexing on the output of the <code>order</code> function applied to the cluster assignments (read the <code>order</code> function help for more info).</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="clustering-in-r.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder correlation matrix by ordering given by clustering</span></span>
<span id="cb482-2"><a href="clustering-in-r.html#cb482-2" aria-hidden="true" tabindex="-1"></a>kmedoids.cor <span class="ot">&lt;-</span> spellman.cor[<span class="fu">order</span>(kclusters), <span class="fu">order</span>(kclusters)]</span></code></pre></div>
<p>Having reordered the correlation matrix by the k-clusters, we can again use the <code>heatmap.2</code> function to visualize the results.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="clustering-in-r.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(kmedoids.cor, <span class="at">Rowv =</span> <span class="cn">NULL</span>, <span class="at">Colv =</span> <span class="cn">NULL</span>, </span>
<span id="cb483-2"><a href="clustering-in-r.html#cb483-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb483-3"><a href="clustering-in-r.html#cb483-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">&quot;none&quot;</span>, <span class="at">density.info =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb483-4"><a href="clustering-in-r.html#cb483-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> color.scheme, <span class="at">key =</span> <span class="cn">FALSE</span>,</span>
<span id="cb483-5"><a href="clustering-in-r.html#cb483-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">labRow =</span> <span class="cn">FALSE</span>, <span class="at">labCol =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-479-1.png" width="768" /></p>
<p>The diagram has the same interpretation as the previous figure. However, here we notice that the clusters seem to be more internally consistent, as evidence by the greater within cluster uniformity of correlations. Positive and negative relationships between clusters are also readily apparent in this figure.</p>
</div>
</div>
<div id="depicting-the-data-within-clusters" class="section level2" number="15.14">
<h2><span class="header-section-number">15.14</span> Depicting the data within clusters</h2>
<p>As a final step we’ll generate a figure depicting the time series behavior of genes in different clusters. Overlain over the individual gene expression time series, we’ll overlay the average time series for each cluster. I illustrate this with clusters generated by hierarchical clustering. This is easily adapted to clusterings generated by other methods.</p>
<p>Create a data frame holding cluster membership for each gene.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="clustering-in-r.html#cb484-1" aria-hidden="true" tabindex="-1"></a>clusters.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gene =</span> <span class="fu">names</span>(kclusters), </span>
<span id="cb484-2"><a href="clustering-in-r.html#cb484-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">cluster =</span> <span class="fu">as.factor</span>(kclusters))</span></code></pre></div>
<p>For the purposes of easy plotting in ggplot, we want to combine the information about cluster assignment to the original data. However the cluster assignments and corresponding names aren’t necessarily in the same order as our original data frame. We’ll use a “left join” to combine the two data frames, matching on the “gene” column:</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="clustering-in-r.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do a left_join, combining the information in spellman.long</span></span>
<span id="cb485-2"><a href="clustering-in-r.html#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="co"># with clusters.df (matched on gene).  This effectively adds the</span></span>
<span id="cb485-3"><a href="clustering-in-r.html#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster information as a new column to spellman.long data frame</span></span>
<span id="cb485-4"><a href="clustering-in-r.html#cb485-4" aria-hidden="true" tabindex="-1"></a><span class="co"># keeping the appropriate matches by gene name</span></span>
<span id="cb485-5"><a href="clustering-in-r.html#cb485-5" aria-hidden="true" tabindex="-1"></a>alpha.long <span class="ot">&lt;-</span> </span>
<span id="cb485-6"><a href="clustering-in-r.html#cb485-6" aria-hidden="true" tabindex="-1"></a>  spellman.long <span class="sc">%&gt;%</span></span>
<span id="cb485-7"><a href="clustering-in-r.html#cb485-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(expt <span class="sc">==</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb485-8"><a href="clustering-in-r.html#cb485-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(clusters.df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;gene&quot;</span>))</span></code></pre></div>
<p>Next we calculate cluster means:</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="clustering-in-r.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the mean at each time point within each cluster</span></span>
<span id="cb486-2"><a href="clustering-in-r.html#cb486-2" aria-hidden="true" tabindex="-1"></a>cluster.means <span class="ot">&lt;-</span></span>
<span id="cb486-3"><a href="clustering-in-r.html#cb486-3" aria-hidden="true" tabindex="-1"></a>  alpha.long <span class="sc">%&gt;%</span></span>
<span id="cb486-4"><a href="clustering-in-r.html#cb486-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster, time) <span class="sc">%&gt;%</span></span>
<span id="cb486-5"><a href="clustering-in-r.html#cb486-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean.exp =</span> <span class="fu">mean</span>(expression, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb486-6"><a href="clustering-in-r.html#cb486-6" aria-hidden="true" tabindex="-1"></a><span class="do">## `summarise()` has grouped output by &#39;cluster&#39;. You can override using the `.groups` argument.</span></span></code></pre></div>
<p>And finally we plot the time series data for each cluster, with the clusters means overlain:</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="clustering-in-r.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw a figure showing time varying gene expression</span></span>
<span id="cb487-2"><a href="clustering-in-r.html#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in each cluster, overlain with the each clusters </span></span>
<span id="cb487-3"><a href="clustering-in-r.html#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mean time series</span></span>
<span id="cb487-4"><a href="clustering-in-r.html#cb487-4" aria-hidden="true" tabindex="-1"></a>alpha.long <span class="sc">%&gt;%</span></span>
<span id="cb487-5"><a href="clustering-in-r.html#cb487-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, expression, <span class="at">group=</span>gene)) <span class="sc">+</span></span>
<span id="cb487-6"><a href="clustering-in-r.html#cb487-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb487-7"><a href="clustering-in-r.html#cb487-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time, mean.exp, <span class="at">group=</span><span class="cn">NULL</span>,<span class="at">color=</span>cluster),</span>
<span id="cb487-8"><a href="clustering-in-r.html#cb487-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> cluster.means,</span>
<span id="cb487-9"><a href="clustering-in-r.html#cb487-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb487-10"><a href="clustering-in-r.html#cb487-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb487-11"><a href="clustering-in-r.html#cb487-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>cluster, <span class="at">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-483-1.png" width="672" /></p>
<p>To my eye, oscillatory behavior is fairly apparent in most of the clusters except cluster 7.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="canonical-variates-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="non-linear-regression-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
