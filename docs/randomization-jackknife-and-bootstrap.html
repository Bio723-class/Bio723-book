<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Randomization, Jackknife, and Bootstrap | Biology 723: Statistical Computing for Biologists</title>
  <meta name="description" content="Hands-on materials for Bio 723 course at Duke University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Randomization, Jackknife, and Bootstrap | Biology 723: Statistical Computing for Biologists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Hands-on materials for Bio 723 course at Duke University." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Randomization, Jackknife, and Bootstrap | Biology 723: Statistical Computing for Biologists" />
  
  <meta name="twitter:description" content="Hands-on materials for Bio 723 course at Duke University." />
  

<meta name="author" content="Paul M. Magwene" />


<meta name="date" content="2021-04-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="non-linear-regression-models.html"/>
<link rel="next" href="simulating-sampling-distributions.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#accessing-older-versions-of-the-course-notes"><i class="fa fa-check"></i><b>1.1</b> Accessing older versions of the course notes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-these-lecture-notes"><i class="fa fa-check"></i><b>1.2</b> How to use these lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting Started with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#entering-commands-in-the-console"><i class="fa fa-check"></i><b>2.3</b> Entering commands in the console</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#comments"><i class="fa fa-check"></i><b>2.4</b> Comments</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>2.5</b> Using R as a Calculator</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#common-mathematical-functions"><i class="fa fa-check"></i><b>2.5.1</b> Common mathematical functions</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#variable-assignment"><i class="fa fa-check"></i><b>2.6</b> Variable assignment</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#valid-variable-names"><i class="fa fa-check"></i><b>2.6.1</b> Valid variable names</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#data-types"><i class="fa fa-check"></i><b>2.7</b> Data types</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#numeric-data-types"><i class="fa fa-check"></i><b>2.7.1</b> Numeric data types</a></li>
<li class="chapter" data-level="2.7.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#logical-values"><i class="fa fa-check"></i><b>2.7.2</b> Logical values</a></li>
<li class="chapter" data-level="2.7.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#character-strings"><i class="fa fa-check"></i><b>2.7.3</b> Character strings</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#packages"><i class="fa fa-check"></i><b>2.8</b> Packages</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-packages-from-the-console"><i class="fa fa-check"></i><b>2.8.1</b> Installing packages from the console</a></li>
<li class="chapter" data-level="2.8.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#install-the-tidyverse-package"><i class="fa fa-check"></i><b>2.8.2</b> Install the tidyverse package</a></li>
<li class="chapter" data-level="2.8.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-packages-from-the-rstudio-dialog"><i class="fa fa-check"></i><b>2.8.3</b> Installing packages from the RStudio dialog</a></li>
<li class="chapter" data-level="2.8.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#loading-packages-with-the-library-function"><i class="fa fa-check"></i><b>2.8.4</b> Loading packages with the <code>library()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#the-r-help-system"><i class="fa fa-check"></i><b>2.9</b> The R Help System</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#getting-help-from-the-console"><i class="fa fa-check"></i><b>2.9.1</b> Getting help from the console</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html"><i class="fa fa-check"></i><b>3</b> R Markdown and R Notebooks</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#r-notebooks"><i class="fa fa-check"></i><b>3.1</b> R Notebooks</a></li>
<li class="chapter" data-level="3.2" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#creating-an-r-notebook"><i class="fa fa-check"></i><b>3.2</b> Creating an R Notebook</a></li>
<li class="chapter" data-level="3.3" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#the-default-r-notebook-template"><i class="fa fa-check"></i><b>3.3</b> The default R Notebook template</a></li>
<li class="chapter" data-level="3.4" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#code-and-non-code-blocks"><i class="fa fa-check"></i><b>3.4</b> Code and Non-code blocks</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#non-code-blocks"><i class="fa fa-check"></i><b>3.4.1</b> Non-code blocks</a></li>
<li class="chapter" data-level="3.4.2" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#code-blocks"><i class="fa fa-check"></i><b>3.4.2</b> Code blocks</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#running-a-code-chunk"><i class="fa fa-check"></i><b>3.5</b> Running a code chunk</a></li>
<li class="chapter" data-level="3.6" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#running-all-code-chunks-above"><i class="fa fa-check"></i><b>3.6</b> Running all code chunks above</a></li>
<li class="chapter" data-level="3.7" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#knitting-r-markdown-to-html"><i class="fa fa-check"></i><b>3.7</b> “Knitting” R Markdown to HTML</a></li>
<li class="chapter" data-level="3.8" data-path="r-markdown-and-r-notebooks.html"><a href="r-markdown-and-r-notebooks.html#sharing-your-reproducible-r-notebook"><i class="fa fa-check"></i><b>3.8</b> Sharing your reproducible R Notebook</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>4</b> Data structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-structures.html"><a href="data-structures.html#vector-arithmetic"><i class="fa fa-check"></i><b>4.1.1</b> Vector Arithmetic</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-structures.html"><a href="data-structures.html#vector-recycling"><i class="fa fa-check"></i><b>4.1.2</b> Vector recycling</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-structures.html"><a href="data-structures.html#simple-statistical-functions-for-numeric-vectors"><i class="fa fa-check"></i><b>4.1.3</b> Simple statistical functions for numeric vectors</a></li>
<li class="chapter" data-level="4.1.4" data-path="data-structures.html"><a href="data-structures.html#indexing-vectors"><i class="fa fa-check"></i><b>4.1.4</b> Indexing Vectors</a></li>
<li class="chapter" data-level="4.1.5" data-path="data-structures.html"><a href="data-structures.html#comparison-operators-applied-to-vectors"><i class="fa fa-check"></i><b>4.1.5</b> Comparison operators applied to vectors</a></li>
<li class="chapter" data-level="4.1.6" data-path="data-structures.html"><a href="data-structures.html#combining-indexing-and-comparison-of-vectors"><i class="fa fa-check"></i><b>4.1.6</b> Combining Indexing and Comparison of Vectors</a></li>
<li class="chapter" data-level="4.1.7" data-path="data-structures.html"><a href="data-structures.html#vector-manipulation"><i class="fa fa-check"></i><b>4.1.7</b> Vector manipulation</a></li>
<li class="chapter" data-level="4.1.8" data-path="data-structures.html"><a href="data-structures.html#vectors-from-regular-sequences"><i class="fa fa-check"></i><b>4.1.8</b> Vectors from regular sequences</a></li>
<li class="chapter" data-level="4.1.9" data-path="data-structures.html"><a href="data-structures.html#additional-functions-for-working-with-vectors"><i class="fa fa-check"></i><b>4.1.9</b> Additional functions for working with vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>4.2</b> Lists</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-structures.html"><a href="data-structures.html#length-and-type-of-lists"><i class="fa fa-check"></i><b>4.2.1</b> Length and type of lists</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-structures.html"><a href="data-structures.html#indexing-lists"><i class="fa fa-check"></i><b>4.2.2</b> Indexing lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-structures.html"><a href="data-structures.html#naming-list-elements"><i class="fa fa-check"></i><b>4.2.3</b> Naming list elements</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-structures.html"><a href="data-structures.html#the-operator"><i class="fa fa-check"></i><b>4.2.4</b> The <code>$</code> operator</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-structures.html"><a href="data-structures.html#changing-and-adding-lists-items"><i class="fa fa-check"></i><b>4.2.5</b> Changing and adding lists items</a></li>
<li class="chapter" data-level="4.2.6" data-path="data-structures.html"><a href="data-structures.html#combining-lists"><i class="fa fa-check"></i><b>4.2.6</b> Combining lists</a></li>
<li class="chapter" data-level="4.2.7" data-path="data-structures.html"><a href="data-structures.html#converting-lists-to-vectors"><i class="fa fa-check"></i><b>4.2.7</b> Converting lists to vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>4.3</b> Data frames</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-structures.html"><a href="data-structures.html#creating-a-data-frame"><i class="fa fa-check"></i><b>4.3.1</b> Creating a data frame</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-structures.html"><a href="data-structures.html#type-and-class-for-data-frames"><i class="fa fa-check"></i><b>4.3.2</b> Type and class for data frames</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-structures.html"><a href="data-structures.html#length-and-dimension-for-data-frames"><i class="fa fa-check"></i><b>4.3.3</b> Length and dimension for data frames</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-structures.html"><a href="data-structures.html#indexing-and-accessing-data-frames"><i class="fa fa-check"></i><b>4.3.4</b> Indexing and accessing data frames</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-structures.html"><a href="data-structures.html#logical-indexing-of-data-frames"><i class="fa fa-check"></i><b>4.3.5</b> Logical indexing of data frames</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-structures.html"><a href="data-structures.html#adding-columns-to-a-data-frame"><i class="fa fa-check"></i><b>4.3.6</b> Adding columns to a data frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html"><i class="fa fa-check"></i><b>5</b> Functions and control flow statements</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#writing-your-own-functions"><i class="fa fa-check"></i><b>5.1</b> Writing your own functions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#function-arguments"><i class="fa fa-check"></i><b>5.1.1</b> Function arguments</a></li>
<li class="chapter" data-level="5.1.2" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#writing-functions-with-optional-arguments"><i class="fa fa-check"></i><b>5.1.2</b> Writing functions with optional arguments</a></li>
<li class="chapter" data-level="5.1.3" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#putting-r-functions-in-scripts"><i class="fa fa-check"></i><b>5.1.3</b> Putting R functions in Scripts</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#control-flow-statements"><i class="fa fa-check"></i><b>5.2</b> Control flow statements</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#if-and-if-else-statements"><i class="fa fa-check"></i><b>5.2.1</b> <code>if</code> and <code>if-else</code> statements</a></li>
<li class="chapter" data-level="5.2.2" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#for-loops"><i class="fa fa-check"></i><b>5.2.2</b> for loops</a></li>
<li class="chapter" data-level="5.2.3" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#break-statement"><i class="fa fa-check"></i><b>5.2.3</b> <code>break</code> statement</a></li>
<li class="chapter" data-level="5.2.4" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#repeat-loops"><i class="fa fa-check"></i><b>5.2.4</b> <code>repeat</code> loops</a></li>
<li class="chapter" data-level="5.2.5" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#next-statement"><i class="fa fa-check"></i><b>5.2.5</b> <code>next</code> statement</a></li>
<li class="chapter" data-level="5.2.6" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#while-statements"><i class="fa fa-check"></i><b>5.2.6</b> while statements</a></li>
<li class="chapter" data-level="5.2.7" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#ifelse"><i class="fa fa-check"></i><b>5.2.7</b> <code>ifelse</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#map-and-related-tools"><i class="fa fa-check"></i><b>5.3</b> <code>map</code> and related tools</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#basic-map"><i class="fa fa-check"></i><b>5.3.1</b> basic <code>map</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#map_if-and-map_at"><i class="fa fa-check"></i><b>5.3.2</b> <code>map_if</code> and <code>map_at</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#mapping-in-parallel-using-map2"><i class="fa fa-check"></i><b>5.3.3</b> mapping in parallel using <code>map2</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="functions-and-control-flow-statements.html"><a href="functions-and-control-flow-statements.html#map-variants-that-return-vectors"><i class="fa fa-check"></i><b>5.3.4</b> <code>map</code> variants that return vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Introduction to ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#loading-ggplot2"><i class="fa fa-check"></i><b>6.1</b> Loading ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#example-data-set-andersons-iris-data"><i class="fa fa-check"></i><b>6.2</b> Example data set: Anderson’s Iris Data</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#template-for-single-layer-plots-in-ggplot2"><i class="fa fa-check"></i><b>6.3</b> Template for single layer plots in ggplot2</a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#an-aside-about-function-arguments"><i class="fa fa-check"></i><b>6.4</b> An aside about function arguments</a></li>
<li class="chapter" data-level="6.5" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#strip-plots"><i class="fa fa-check"></i><b>6.5</b> Strip plots</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#jittering-data"><i class="fa fa-check"></i><b>6.5.1</b> Jittering data</a></li>
<li class="chapter" data-level="6.5.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#adding-categorical-information"><i class="fa fa-check"></i><b>6.5.2</b> Adding categorical information</a></li>
<li class="chapter" data-level="6.5.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#rotating-plot-coordinates"><i class="fa fa-check"></i><b>6.5.3</b> Rotating plot coordinates</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#histograms"><i class="fa fa-check"></i><b>6.6</b> Histograms</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#variations-on-histograms-when-considering-categorical-data"><i class="fa fa-check"></i><b>6.6.1</b> Variations on histograms when considering categorical data</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#faceting-to-depict-categorical-information"><i class="fa fa-check"></i><b>6.7</b> Faceting to depict categorical information</a></li>
<li class="chapter" data-level="6.8" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#density-plots"><i class="fa fa-check"></i><b>6.8</b> Density plots</a></li>
<li class="chapter" data-level="6.9" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#violin-or-beanplot"><i class="fa fa-check"></i><b>6.9</b> Violin or Beanplot</a></li>
<li class="chapter" data-level="6.10" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#boxplots"><i class="fa fa-check"></i><b>6.10</b> Boxplots</a></li>
<li class="chapter" data-level="6.11" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#building-complex-visualizations-with-layers"><i class="fa fa-check"></i><b>6.11</b> Building complex visualizations with layers</a></li>
<li class="chapter" data-level="6.12" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#useful-combination-plots"><i class="fa fa-check"></i><b>6.12</b> Useful combination plots</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#boxplot-plus-strip-plot"><i class="fa fa-check"></i><b>6.12.1</b> Boxplot plus strip plot</a></li>
<li class="chapter" data-level="6.12.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#setting-shared-aesthetics"><i class="fa fa-check"></i><b>6.12.2</b> Setting shared aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#ggplot-layers-can-be-assigned-to-variables"><i class="fa fa-check"></i><b>6.13</b> ggplot layers can be assigned to variables</a>
<ul>
<li class="chapter" data-level="6.13.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#violin-plot-plus-strip-plot"><i class="fa fa-check"></i><b>6.13.1</b> Violin plot plus strip plot</a></li>
</ul></li>
<li class="chapter" data-level="6.14" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#adding-titles-and-tweaking-axis-labels"><i class="fa fa-check"></i><b>6.14</b> Adding titles and tweaking axis labels</a></li>
<li class="chapter" data-level="6.15" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#ggplot2-themes"><i class="fa fa-check"></i><b>6.15</b> ggplot2 themes</a>
<ul>
<li class="chapter" data-level="6.15.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#further-customization-with-ggplot2theme"><i class="fa fa-check"></i><b>6.15.1</b> Further customization with <code>ggplot2::theme</code></a></li>
</ul></li>
<li class="chapter" data-level="6.16" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#other-aspects-of-ggplots-can-be-assigned-to-variables"><i class="fa fa-check"></i><b>6.16</b> Other aspects of ggplots can be assigned to variables</a></li>
<li class="chapter" data-level="6.17" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#bivariate-plots"><i class="fa fa-check"></i><b>6.17</b> Bivariate plots</a>
<ul>
<li class="chapter" data-level="6.17.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>6.17.1</b> Scatter plots</a></li>
<li class="chapter" data-level="6.17.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#adding-a-trend-line-to-a-scatter-plot"><i class="fa fa-check"></i><b>6.17.2</b> Adding a trend line to a scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="6.18" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#bivariate-density-plots"><i class="fa fa-check"></i><b>6.18</b> Bivariate density plots</a></li>
<li class="chapter" data-level="6.19" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#combining-scatter-plots-and-density-plots-with-categorical-information"><i class="fa fa-check"></i><b>6.19</b> Combining Scatter Plots and Density Plots with Categorical Information</a></li>
<li class="chapter" data-level="6.20" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#density-plots-with-fill"><i class="fa fa-check"></i><b>6.20</b> Density plots with fill</a></li>
<li class="chapter" data-level="6.21" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#d-bin-and-hex-plots"><i class="fa fa-check"></i><b>6.21</b> 2D bin and hex plots</a></li>
<li class="chapter" data-level="6.22" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#the-cowplot-package"><i class="fa fa-check"></i><b>6.22</b> The <code>cowplot</code> package</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html"><i class="fa fa-check"></i><b>7</b> Introduction to <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#libraries"><i class="fa fa-check"></i><b>7.1</b> Libraries</a></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#reading-data-with-the-readr-package"><i class="fa fa-check"></i><b>7.2</b> Reading data with the <code>readr</code> package</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#reading-excel-files"><i class="fa fa-check"></i><b>7.2.1</b> Reading Excel files</a></li>
<li class="chapter" data-level="7.2.2" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#example-data-nc-births"><i class="fa fa-check"></i><b>7.2.2</b> Example data: NC Births</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#a-note-on-tibbles"><i class="fa fa-check"></i><b>7.3</b> A note on “tibbles”</a></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#data-filtering-and-transformation-with-dplyr"><i class="fa fa-check"></i><b>7.4</b> Data filtering and transformation with <code>dplyr</code></a></li>
<li class="chapter" data-level="7.5" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#dplyrs-verbs"><i class="fa fa-check"></i><b>7.5</b> dplyr’s “verbs”</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#select"><i class="fa fa-check"></i><b>7.5.1</b> <code>select</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#filter"><i class="fa fa-check"></i><b>7.5.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#mutate"><i class="fa fa-check"></i><b>7.5.3</b> <code>mutate</code></a></li>
<li class="chapter" data-level="7.5.4" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#arrange"><i class="fa fa-check"></i><b>7.5.4</b> <code>arrange</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#summarize"><i class="fa fa-check"></i><b>7.5.5</b> <code>summarize</code></a></li>
<li class="chapter" data-level="7.5.6" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#group_by"><i class="fa fa-check"></i><b>7.5.6</b> <code>group_by</code></a></li>
<li class="chapter" data-level="7.5.7" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#combining-grouping-and-summarizing"><i class="fa fa-check"></i><b>7.5.7</b> Combining grouping and summarizing</a></li>
<li class="chapter" data-level="7.5.8" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#scoped-variants-of-mutate-and-summarize"><i class="fa fa-check"></i><b>7.5.8</b> Scoped variants of <code>mutate</code> and <code>summarize</code></a></li>
<li class="chapter" data-level="7.5.9" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#combining-summarize-with-grouping-aesthetics-in-ggplot2"><i class="fa fa-check"></i><b>7.5.9</b> Combining summarize with grouping aesthetics in <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#pipes"><i class="fa fa-check"></i><b>7.6</b> Pipes</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#install-and-load-magrittr"><i class="fa fa-check"></i><b>7.6.1</b> Install and load <code>magrittr</code></a></li>
<li class="chapter" data-level="7.6.2" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#the-basic-pipe-operator"><i class="fa fa-check"></i><b>7.6.2</b> The basic pipe operator</a></li>
<li class="chapter" data-level="7.6.3" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#an-example-without-pipes"><i class="fa fa-check"></i><b>7.6.3</b> An example without pipes</a></li>
<li class="chapter" data-level="7.6.4" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#the-same-example-using-pipes"><i class="fa fa-check"></i><b>7.6.4</b> The same example using pipes</a></li>
<li class="chapter" data-level="7.6.5" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#assigning-the-output-of-a-statement-involving-pipes-to-a-variable"><i class="fa fa-check"></i><b>7.6.5</b> Assigning the output of a statement involving pipes to a variable</a></li>
<li class="chapter" data-level="7.6.6" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#compound-assignment-pipe-operator"><i class="fa fa-check"></i><b>7.6.6</b> Compound assignment pipe operator</a></li>
<li class="chapter" data-level="7.6.7" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#the-dot-operator-with-pipes"><i class="fa fa-check"></i><b>7.6.7</b> The dot operator with pipes</a></li>
<li class="chapter" data-level="7.6.8" data-path="introduction-to-dplyr.html"><a href="introduction-to-dplyr.html#the-exposition-pipe-operator"><i class="fa fa-check"></i><b>7.6.8</b> The exposition pipe operator</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>8</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-wrangling.html"><a href="data-wrangling.html#libraries-1"><i class="fa fa-check"></i><b>8.1</b> Libraries</a></li>
<li class="chapter" data-level="8.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>8.2</b> Data</a></li>
<li class="chapter" data-level="8.3" data-path="data-wrangling.html"><a href="data-wrangling.html#renaming-data-frame-columms"><i class="fa fa-check"></i><b>8.3</b> Renaming data frame columms</a></li>
<li class="chapter" data-level="8.4" data-path="data-wrangling.html"><a href="data-wrangling.html#dropping-unneeded-columns"><i class="fa fa-check"></i><b>8.4</b> Dropping unneeded columns</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#finding-all-empty-columns"><i class="fa fa-check"></i><b>8.4.1</b> Finding all empty columns</a></li>
<li class="chapter" data-level="8.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#dropping-columns-by-matching-names"><i class="fa fa-check"></i><b>8.4.2</b> Dropping columns by matching names</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="data-wrangling.html"><a href="data-wrangling.html#merging-data-frames"><i class="fa fa-check"></i><b>8.5</b> Merging data frames</a></li>
<li class="chapter" data-level="8.6" data-path="data-wrangling.html"><a href="data-wrangling.html#reshaping-data-with-tidyr"><i class="fa fa-check"></i><b>8.6</b> Reshaping data with tidyr</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="data-wrangling.html"><a href="data-wrangling.html#wide-to-long-conversions-using-tidyrgather"><i class="fa fa-check"></i><b>8.6.1</b> Wide to long conversions using <code>tidyr::gather</code></a></li>
<li class="chapter" data-level="8.6.2" data-path="data-wrangling.html"><a href="data-wrangling.html#extracting-information-from-combined-variables-using-tidyrextract"><i class="fa fa-check"></i><b>8.6.2</b> Extracting information from combined variables using <code>tidyr::extract</code></a></li>
<li class="chapter" data-level="8.6.3" data-path="data-wrangling.html"><a href="data-wrangling.html#subsetting-rows"><i class="fa fa-check"></i><b>8.6.3</b> Subsetting rows</a></li>
<li class="chapter" data-level="8.6.4" data-path="data-wrangling.html"><a href="data-wrangling.html#splitting-columns"><i class="fa fa-check"></i><b>8.6.4</b> Splitting columns</a></li>
<li class="chapter" data-level="8.6.5" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-data-frames"><i class="fa fa-check"></i><b>8.6.5</b> Combining data frames</a></li>
<li class="chapter" data-level="8.6.6" data-path="data-wrangling.html"><a href="data-wrangling.html#sorting-data-frame-rows"><i class="fa fa-check"></i><b>8.6.6</b> Sorting data frame rows</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="data-wrangling.html"><a href="data-wrangling.html#using-your-tidy-data"><i class="fa fa-check"></i><b>8.7</b> Using your tidy data</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#visualizing-gene-expression-time-series"><i class="fa fa-check"></i><b>8.7.1</b> Visualizing gene expression time series</a></li>
<li class="chapter" data-level="8.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#finding-the-most-variable-genes"><i class="fa fa-check"></i><b>8.7.2</b> Finding the most variable genes</a></li>
<li class="chapter" data-level="8.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#heat-maps"><i class="fa fa-check"></i><b>8.7.3</b> Heat maps</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="data-wrangling.html"><a href="data-wrangling.html#long-to-wide-conversion-using-tidyrspread"><i class="fa fa-check"></i><b>8.8</b> Long-to-wide conversion using <code>tidyr::spread</code></a></li>
<li class="chapter" data-level="8.9" data-path="data-wrangling.html"><a href="data-wrangling.html#exploring-bivariate-relationships-using-wide-data"><i class="fa fa-check"></i><b>8.9</b> Exploring bivariate relationships using “wide” data</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="data-wrangling.html"><a href="data-wrangling.html#large-scale-patterns-of-correlations"><i class="fa fa-check"></i><b>8.9.1</b> Large scale patterns of correlations</a></li>
<li class="chapter" data-level="8.9.2" data-path="data-wrangling.html"><a href="data-wrangling.html#adding-new-columns-and-combining-filtered-data-frames"><i class="fa fa-check"></i><b>8.9.2</b> Adding new columns and combining filtered data frames</a></li>
<li class="chapter" data-level="8.9.3" data-path="data-wrangling.html"><a href="data-wrangling.html#a-heat-mapped-sorted-by-correlations"><i class="fa fa-check"></i><b>8.9.3</b> A heat mapped sorted by correlations</a></li>
<li class="chapter" data-level="8.9.4" data-path="data-wrangling.html"><a href="data-wrangling.html#a-fancy-figure"><i class="fa fa-check"></i><b>8.9.4</b> A “fancy” figure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="vector-algebra.html"><a href="vector-algebra.html"><i class="fa fa-check"></i><b>9</b> Vector algebra</a>
<ul>
<li class="chapter" data-level="9.1" data-path="vector-algebra.html"><a href="vector-algebra.html#libraries-2"><i class="fa fa-check"></i><b>9.1</b> Libraries</a></li>
<li class="chapter" data-level="9.2" data-path="vector-algebra.html"><a href="vector-algebra.html#vector-mathematics-in-r"><i class="fa fa-check"></i><b>9.2</b> Vector Mathematics in R</a></li>
<li class="chapter" data-level="9.3" data-path="vector-algebra.html"><a href="vector-algebra.html#simple-statistics-in-vector-form"><i class="fa fa-check"></i><b>9.3</b> Simple statistics in vector form</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="vector-algebra.html"><a href="vector-algebra.html#mean"><i class="fa fa-check"></i><b>9.3.1</b> Mean</a></li>
<li class="chapter" data-level="9.3.2" data-path="vector-algebra.html"><a href="vector-algebra.html#mean-centering"><i class="fa fa-check"></i><b>9.3.2</b> Mean centering</a></li>
<li class="chapter" data-level="9.3.3" data-path="vector-algebra.html"><a href="vector-algebra.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>9.3.3</b> Variance and standard deviation</a></li>
<li class="chapter" data-level="9.3.4" data-path="vector-algebra.html"><a href="vector-algebra.html#covariance-and-correlation"><i class="fa fa-check"></i><b>9.3.4</b> Covariance and correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="matrices-in-r.html"><a href="matrices-in-r.html"><i class="fa fa-check"></i><b>10</b> Matrices in R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="matrices-in-r.html"><a href="matrices-in-r.html#creating-matrices-in-r"><i class="fa fa-check"></i><b>10.1</b> Creating matrices in R</a></li>
<li class="chapter" data-level="10.2" data-path="matrices-in-r.html"><a href="matrices-in-r.html#matrix-arithmetic-operations-in-r"><i class="fa fa-check"></i><b>10.2</b> Matrix arithmetic operations in R</a></li>
<li class="chapter" data-level="10.3" data-path="matrices-in-r.html"><a href="matrices-in-r.html#descriptive-statistics-as-matrix-functions"><i class="fa fa-check"></i><b>10.3</b> Descriptive statistics as matrix functions</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="matrices-in-r.html"><a href="matrices-in-r.html#mean-vector-and-matrix"><i class="fa fa-check"></i><b>10.3.1</b> Mean vector and matrix</a></li>
<li class="chapter" data-level="10.3.2" data-path="matrices-in-r.html"><a href="matrices-in-r.html#deviation-matrix"><i class="fa fa-check"></i><b>10.3.2</b> Deviation matrix</a></li>
<li class="chapter" data-level="10.3.3" data-path="matrices-in-r.html"><a href="matrices-in-r.html#covariance-matrix"><i class="fa fa-check"></i><b>10.3.3</b> Covariance matrix</a></li>
<li class="chapter" data-level="10.3.4" data-path="matrices-in-r.html"><a href="matrices-in-r.html#correlation-matrix"><i class="fa fa-check"></i><b>10.3.4</b> Correlation matrix</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="matrices-in-r.html"><a href="matrices-in-r.html#matrix-inverse"><i class="fa fa-check"></i><b>10.4</b> Matrix Inverse</a></li>
<li class="chapter" data-level="10.5" data-path="matrices-in-r.html"><a href="matrices-in-r.html#solving-sets-of-simultaneous-equations"><i class="fa fa-check"></i><b>10.5</b> Solving sets of simultaneous equations</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html"><i class="fa fa-check"></i><b>11</b> Linear Regression Models I</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#linear-functions"><i class="fa fa-check"></i><b>11.1</b> Linear functions</a></li>
<li class="chapter" data-level="11.2" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#linear-regression"><i class="fa fa-check"></i><b>11.2</b> Linear regression</a></li>
<li class="chapter" data-level="11.3" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#the-optimality-criterion-for-least-squares-regression"><i class="fa fa-check"></i><b>11.3</b> The optimality criterion for least-squares regression</a></li>
<li class="chapter" data-level="11.4" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#geometry-of-linear-regression"><i class="fa fa-check"></i><b>11.4</b> Geometry of linear regression</a></li>
<li class="chapter" data-level="11.5" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#solution-for-the-least-squares-criterion"><i class="fa fa-check"></i><b>11.5</b> Solution for the least-squares criterion</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#bivariate-regression-estimating-coefficients"><i class="fa fa-check"></i><b>11.5.1</b> Bivariate regression, estimating coefficients</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#multiple-regression-estimating-coefficients"><i class="fa fa-check"></i><b>11.5.2</b> Multiple regression, estimating coefficients</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#residuals"><i class="fa fa-check"></i><b>11.6</b> Residuals</a></li>
<li class="chapter" data-level="11.7" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#regression-as-sum-of-squares-decomposition"><i class="fa fa-check"></i><b>11.7</b> Regression as sum-of-squares decomposition</a></li>
<li class="chapter" data-level="11.8" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#variance-explained-by-a-regression-model"><i class="fa fa-check"></i><b>11.8</b> Variance “explained” by a regression model</a></li>
<li class="chapter" data-level="11.9" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#goodness-of-fit"><i class="fa fa-check"></i><b>11.9</b> Goodness of fit</a></li>
<li class="chapter" data-level="11.10" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#interpretting-regression"><i class="fa fa-check"></i><b>11.10</b> Interpretting Regression</a></li>
<li class="chapter" data-level="11.11" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#illustrating-linear-regression-with-simulated-data"><i class="fa fa-check"></i><b>11.11</b> Illustrating linear regression with simulated data</a></li>
<li class="chapter" data-level="11.12" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#calculating-the-regression-model-using-vector-arithmetic"><i class="fa fa-check"></i><b>11.12</b> Calculating the regression model using vector arithmetic</a>
<ul>
<li class="chapter" data-level="11.12.1" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#calculating-the-predicted-values-and-residuals"><i class="fa fa-check"></i><b>11.12.1</b> Calculating the predicted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="11.13" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#plotting-various-aspects-of-a-regression"><i class="fa fa-check"></i><b>11.13</b> Plotting various aspects of a regression</a>
<ul>
<li class="chapter" data-level="11.13.1" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#residual-plots"><i class="fa fa-check"></i><b>11.13.1</b> Residual plots</a></li>
</ul></li>
<li class="chapter" data-level="11.14" data-path="linear-regression-models-i.html"><a href="linear-regression-models-i.html#calculating-the-coefficient-of-determination"><i class="fa fa-check"></i><b>11.14</b> Calculating the coefficient of determination</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html"><i class="fa fa-check"></i><b>12</b> Linear Regression Models II</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#new-libraries-to-install"><i class="fa fa-check"></i><b>12.1</b> New Libraries to install</a></li>
<li class="chapter" data-level="12.2" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#standard-libraries"><i class="fa fa-check"></i><b>12.2</b> Standard libraries</a></li>
<li class="chapter" data-level="12.3" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#specifying-regression-models-in-r"><i class="fa fa-check"></i><b>12.3</b> Specifying Regression Models in R</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#interpretting-summary-output-from-lm"><i class="fa fa-check"></i><b>12.3.1</b> Interpretting summary output from lm()</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#quick-bivariate-regression-plots-in-ggplot"><i class="fa fa-check"></i><b>12.4</b> Quick bivariate regression plots in ggplot</a></li>
<li class="chapter" data-level="12.5" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#more-about-the-data-structure-returned-by-lm"><i class="fa fa-check"></i><b>12.5</b> More about the data structure returned by <code>lm()</code></a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#fitted-values"><i class="fa fa-check"></i><b>12.5.1</b> Fitted values</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#getting-the-model-coefficients"><i class="fa fa-check"></i><b>12.5.2</b> Getting the model coefficients</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#broom-a-library-for-converting-model-results-into-data-frames"><i class="fa fa-check"></i><b>12.6</b> Broom: a library for converting model results into data frames</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#broomtidy"><i class="fa fa-check"></i><b>12.6.1</b> <code>broom::tidy</code></a></li>
<li class="chapter" data-level="12.6.2" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#broomaugment"><i class="fa fa-check"></i><b>12.6.2</b> <code>broom::augment</code></a></li>
<li class="chapter" data-level="12.6.3" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#broomglance"><i class="fa fa-check"></i><b>12.6.3</b> <code>broom::glance</code></a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#qq-plots"><i class="fa fa-check"></i><b>12.7</b> qq-plots</a></li>
<li class="chapter" data-level="12.8" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#multiple-regression"><i class="fa fa-check"></i><b>12.8</b> Multiple regression</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#exploration-of-the-trees-data-set"><i class="fa fa-check"></i><b>12.8.1</b> Exploration of the trees data set</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#d-plots"><i class="fa fa-check"></i><b>12.9</b> 3D Plots</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#scatterplot3d"><i class="fa fa-check"></i><b>12.9.1</b> scatterplot3d</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#fitting-the-regression-model"><i class="fa fa-check"></i><b>12.10</b> Fitting the regression model</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#visualizing-the-regression-model-in-scatterplot3d"><i class="fa fa-check"></i><b>12.10.1</b> Visualizing the regression model in scatterplot3d</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#interpretting-the-regression-model"><i class="fa fa-check"></i><b>12.11</b> Interpretting the regression model</a></li>
<li class="chapter" data-level="12.12" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#exploring-the-vector-geometry-of-the-regression-model"><i class="fa fa-check"></i><b>12.12</b> Exploring the Vector Geometry of the Regression Model</a></li>
<li class="chapter" data-level="12.13" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#exploring-the-residuals-from-the-model-fit"><i class="fa fa-check"></i><b>12.13</b> Exploring the Residuals from the Model Fit</a></li>
<li class="chapter" data-level="12.14" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#an-alternate-model"><i class="fa fa-check"></i><b>12.14</b> An alternate model</a></li>
<li class="chapter" data-level="12.15" data-path="linear-regression-models-ii.html"><a href="linear-regression-models-ii.html#exploring-the-impact-of-nearly-collinear-predictors-on-regression"><i class="fa fa-check"></i><b>12.15</b> Exploring the impact of nearly collinear predictors on regression</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html"><i class="fa fa-check"></i><b>13</b> Principal Components Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#libraries-3"><i class="fa fa-check"></i><b>13.1</b> Libraries</a></li>
<li class="chapter" data-level="13.2" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#matrices-as-linear-transformations"><i class="fa fa-check"></i><b>13.2</b> Matrices as linear transformations</a></li>
<li class="chapter" data-level="13.3" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#eigenanalysis-in-r"><i class="fa fa-check"></i><b>13.3</b> Eigenanalysis in R</a></li>
<li class="chapter" data-level="13.4" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#principal-components-analysis-in-r"><i class="fa fa-check"></i><b>13.4</b> Principal Components Analysis in R</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#bioenv-dataset"><i class="fa fa-check"></i><b>13.4.1</b> Bioenv dataset</a></li>
<li class="chapter" data-level="13.4.2" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#pca-of-the-bioenv-dataset"><i class="fa fa-check"></i><b>13.4.2</b> PCA of the Bioenv dataset</a></li>
<li class="chapter" data-level="13.4.3" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#calculating-factor-loadings"><i class="fa fa-check"></i><b>13.4.3</b> Calculating Factor Loadings</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#drawing-figures-to-represent-pca"><i class="fa fa-check"></i><b>13.5</b> Drawing Figures to Represent PCA</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#pc-score-plots"><i class="fa fa-check"></i><b>13.5.1</b> PC Score Plots</a></li>
<li class="chapter" data-level="13.5.2" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html#simultaneous-depiction-of-observations-and-variables-in-the-pc-space"><i class="fa fa-check"></i><b>13.5.2</b> Simultaneous Depiction of Observations and Variables in the PC Space</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html"><i class="fa fa-check"></i><b>14</b> Canonical Variates Analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#libraries-4"><i class="fa fa-check"></i><b>14.1</b> Libraries</a></li>
<li class="chapter" data-level="14.2" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#discriminant-analysis-in-r"><i class="fa fa-check"></i><b>14.2</b> Discriminant Analysis in R</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#shorthand-formulae-in-r"><i class="fa fa-check"></i><b>14.2.1</b> Shorthand Formulae in R</a></li>
<li class="chapter" data-level="14.2.2" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#working-with-the-output-of-lda"><i class="fa fa-check"></i><b>14.2.2</b> Working with the output of <code>lda()</code></a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#estimating-confidence-regions-for-group-means-in-cva"><i class="fa fa-check"></i><b>14.3</b> Estimating confidence regions for group means in CVA</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#drawing-the-cva-confidence-regions"><i class="fa fa-check"></i><b>14.3.1</b> Drawing the CVA confidence regions</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#calculating-the-within-and-between-group-covariance-matrices"><i class="fa fa-check"></i><b>14.4</b> Calculating the Within and Between Group Covariance Matrices</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="canonical-variates-analysis.html"><a href="canonical-variates-analysis.html#recapitulating-the-cva-analysis-of-lda"><i class="fa fa-check"></i><b>14.4.1</b> Recapitulating the CVA analysis of <code>lda()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="clustering-in-r.html"><a href="clustering-in-r.html"><i class="fa fa-check"></i><b>15</b> Clustering in R</a>
<ul>
<li class="chapter" data-level="15.1" data-path="clustering-in-r.html"><a href="clustering-in-r.html#libraries-5"><i class="fa fa-check"></i><b>15.1</b> Libraries</a></li>
<li class="chapter" data-level="15.2" data-path="clustering-in-r.html"><a href="clustering-in-r.html#data-set"><i class="fa fa-check"></i><b>15.2</b> Data set</a></li>
<li class="chapter" data-level="15.3" data-path="clustering-in-r.html"><a href="clustering-in-r.html#hierarchical-clustering-in-r"><i class="fa fa-check"></i><b>15.3</b> Hierarchical Clustering in R</a></li>
<li class="chapter" data-level="15.4" data-path="clustering-in-r.html"><a href="clustering-in-r.html#manipulating-hierarchical-clusterings-with-dendextend"><i class="fa fa-check"></i><b>15.4</b> Manipulating hierarchical clusterings with dendextend</a></li>
<li class="chapter" data-level="15.5" data-path="clustering-in-r.html"><a href="clustering-in-r.html#plotting-dendrograms-in-dendextend"><i class="fa fa-check"></i><b>15.5</b> Plotting dendrograms in dendextend</a></li>
<li class="chapter" data-level="15.6" data-path="clustering-in-r.html"><a href="clustering-in-r.html#cutting-dendrograms"><i class="fa fa-check"></i><b>15.6</b> Cutting dendrograms</a></li>
<li class="chapter" data-level="15.7" data-path="clustering-in-r.html"><a href="clustering-in-r.html#looking-at-clusters"><i class="fa fa-check"></i><b>15.7</b> Looking at clusters</a></li>
<li class="chapter" data-level="15.8" data-path="clustering-in-r.html"><a href="clustering-in-r.html#generating-a-heat-map-from-a-cluster"><i class="fa fa-check"></i><b>15.8</b> Generating a heat map from a cluster</a></li>
<li class="chapter" data-level="15.9" data-path="clustering-in-r.html"><a href="clustering-in-r.html#working-with-sub-trees"><i class="fa fa-check"></i><b>15.9</b> Working with sub-trees</a></li>
<li class="chapter" data-level="15.10" data-path="clustering-in-r.html"><a href="clustering-in-r.html#setting-dendrogram-parameters-in-dendextend"><i class="fa fa-check"></i><b>15.10</b> Setting dendrogram parameters in dendextend</a></li>
<li class="chapter" data-level="15.11" data-path="clustering-in-r.html"><a href="clustering-in-r.html#combining-heatmaps-and-dendrograms"><i class="fa fa-check"></i><b>15.11</b> Combining heatmaps and dendrograms</a></li>
<li class="chapter" data-level="15.12" data-path="clustering-in-r.html"><a href="clustering-in-r.html#k-meansk-medoids-clustering-in-r"><i class="fa fa-check"></i><b>15.12</b> K-means/K-medoids Clustering in R</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="clustering-in-r.html"><a href="clustering-in-r.html#heat-map-from-k-medoids-cluster"><i class="fa fa-check"></i><b>15.12.1</b> Heat map from k-medoids cluster</a></li>
</ul></li>
<li class="chapter" data-level="15.13" data-path="clustering-in-r.html"><a href="clustering-in-r.html#combining-clusters-and-correlation-matrix-heatmaps"><i class="fa fa-check"></i><b>15.13</b> Combining clusters and correlation matrix heatmaps</a>
<ul>
<li class="chapter" data-level="15.13.1" data-path="clustering-in-r.html"><a href="clustering-in-r.html#hierarchical-clustering-visualized-on-correlation-matrix"><i class="fa fa-check"></i><b>15.13.1</b> Hierarchical clustering, visualized on correlation matrix</a></li>
<li class="chapter" data-level="15.13.2" data-path="clustering-in-r.html"><a href="clustering-in-r.html#k-medoids-clustering-visualized-on-the-correlation-matrix"><i class="fa fa-check"></i><b>15.13.2</b> K-medoids clustering visualized on the correlation matrix</a></li>
</ul></li>
<li class="chapter" data-level="15.14" data-path="clustering-in-r.html"><a href="clustering-in-r.html#depicting-the-data-within-clusters"><i class="fa fa-check"></i><b>15.14</b> Depicting the data within clusters</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html"><i class="fa fa-check"></i><b>16</b> Non-linear regression models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#loess-regression"><i class="fa fa-check"></i><b>16.1</b> LOESS regression</a></li>
<li class="chapter" data-level="16.2" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#logistic-regression"><i class="fa fa-check"></i><b>16.2</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#a-web-app-to-explore-the-logistic-regression-equation"><i class="fa fa-check"></i><b>16.2.1</b> A web app to explore the logistic regression equation</a></li>
<li class="chapter" data-level="16.2.2" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#titanic-data-set"><i class="fa fa-check"></i><b>16.2.2</b> Titanic data set</a></li>
<li class="chapter" data-level="16.2.3" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#subsetting-the-data"><i class="fa fa-check"></i><b>16.2.3</b> Subsetting the data</a></li>
<li class="chapter" data-level="16.2.4" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#visualizing-survival-as-a-function-of-age"><i class="fa fa-check"></i><b>16.2.4</b> Visualizing survival as a function of age</a></li>
<li class="chapter" data-level="16.2.5" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#fitting-the-logistic-regression-model"><i class="fa fa-check"></i><b>16.2.5</b> Fitting the logistic regression model</a></li>
<li class="chapter" data-level="16.2.6" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#visualizing-the-logistic-regression"><i class="fa fa-check"></i><b>16.2.6</b> Visualizing the logistic regression</a></li>
<li class="chapter" data-level="16.2.7" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#quick-and-easy-visualization"><i class="fa fa-check"></i><b>16.2.7</b> Quick and easy visualization</a></li>
<li class="chapter" data-level="16.2.8" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#impact-of-sex-and-passenger-class-on-the-models"><i class="fa fa-check"></i><b>16.2.8</b> Impact of sex and passenger class on the models</a></li>
<li class="chapter" data-level="16.2.9" data-path="non-linear-regression-models.html"><a href="non-linear-regression-models.html#fitting-multiple-models-based-on-groupings-use-dplyrdo"><i class="fa fa-check"></i><b>16.2.9</b> Fitting multiple models based on groupings use <code>dplyr::do</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html"><i class="fa fa-check"></i><b>17</b> Randomization, Jackknife, and Bootstrap</a>
<ul>
<li class="chapter" data-level="17.1" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#libraries-6"><i class="fa fa-check"></i><b>17.1</b> Libraries</a></li>
<li class="chapter" data-level="17.2" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#randomization"><i class="fa fa-check"></i><b>17.2</b> Randomization</a></li>
<li class="chapter" data-level="17.3" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#using-randomization-to-test-for-a-difference-in-means"><i class="fa fa-check"></i><b>17.3</b> Using randomization to test for a difference in means</a></li>
<li class="chapter" data-level="17.4" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#using-randomization-to-test-for-equality-of-variances"><i class="fa fa-check"></i><b>17.4</b> Using randomization to test for equality of variances</a></li>
<li class="chapter" data-level="17.5" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#jackknifing-in-r"><i class="fa fa-check"></i><b>17.5</b> Jackknifing in R</a></li>
<li class="chapter" data-level="17.6" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#bootstrapping-in-r"><i class="fa fa-check"></i><b>17.6</b> Bootstrapping in R</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#a-more-sophisticated-application-of-the-bootstrap"><i class="fa fa-check"></i><b>17.6.1</b> A more sophisticated application of the bootstrap</a></li>
<li class="chapter" data-level="17.6.2" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#about-logistic-regression"><i class="fa fa-check"></i><b>17.6.2</b> About logistic regression</a></li>
<li class="chapter" data-level="17.6.3" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#bumpus-house-sparrow-data-set"><i class="fa fa-check"></i><b>17.6.3</b> Bumpus house sparrow data set</a></li>
<li class="chapter" data-level="17.6.4" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#predicting-survival-as-a-function-of-body-weight"><i class="fa fa-check"></i><b>17.6.4</b> Predicting survival as a function of body weight</a></li>
<li class="chapter" data-level="17.6.5" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#fitting-the-logistic-regression"><i class="fa fa-check"></i><b>17.6.5</b> Fitting the logistic regression</a></li>
<li class="chapter" data-level="17.6.6" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#defining-an-appropriate-function-for-boot"><i class="fa fa-check"></i><b>17.6.6</b> Defining an appropriate function for <code>boot</code></a></li>
<li class="chapter" data-level="17.6.7" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#calculating-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>17.6.7</b> Calculating bootstrap confidence intervals</a></li>
<li class="chapter" data-level="17.6.8" data-path="randomization-jackknife-and-bootstrap.html"><a href="randomization-jackknife-and-bootstrap.html#visualizing-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>17.6.8</b> Visualizing bootstrap confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html"><i class="fa fa-check"></i><b>A</b> Simulating sampling distributions</a>
<ul>
<li class="chapter" data-level="A.1" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#sampling-distributions"><i class="fa fa-check"></i><b>A.1</b> Sampling distributions</a></li>
<li class="chapter" data-level="A.2" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#simulating-sampling-from-an-underlying-population"><i class="fa fa-check"></i><b>A.2</b> Simulating sampling from an underlying population</a></li>
<li class="chapter" data-level="A.3" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#seeding-the-pseudo-random-number-generator"><i class="fa fa-check"></i><b>A.3</b> Seeding the pseudo-random number generator</a></li>
<li class="chapter" data-level="A.4" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#libraries-7"><i class="fa fa-check"></i><b>A.4</b> Libraries</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#properties-of-the-underlying-population"><i class="fa fa-check"></i><b>A.4.1</b> Properties of the underlying population</a></li>
<li class="chapter" data-level="A.4.2" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#other-r-functions-related-to-the-normal-distribution"><i class="fa fa-check"></i><b>A.4.2</b> Other R functions related to the normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#random-sampling-from-the-simulated-population"><i class="fa fa-check"></i><b>A.5</b> Random sampling from the simulated population</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#another-random-sample"><i class="fa fa-check"></i><b>A.5.1</b> Another random sample</a></li>
<li class="chapter" data-level="A.5.2" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#simulating-the-generation-of-many-random-samples"><i class="fa fa-check"></i><b>A.5.2</b> Simulating the generation of many random samples</a></li>
<li class="chapter" data-level="A.5.3" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#a-function-to-estimate-statistics-of-interest-in-a-random-sample"><i class="fa fa-check"></i><b>A.5.3</b> A function to estimate statistics of interest in a random sample</a></li>
<li class="chapter" data-level="A.5.4" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#generating-statistics-for-many-random-samples"><i class="fa fa-check"></i><b>A.5.4</b> Generating statistics for many random samples</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#simulated-sampling-distribution-of-the-mean"><i class="fa fa-check"></i><b>A.6</b> Simulated sampling distribution of the mean</a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#differences-between-sampling-distributions-and-samplepopulation-distributions"><i class="fa fa-check"></i><b>A.6.1</b> Differences between sampling distributions and sample/population distributions</a></li>
<li class="chapter" data-level="A.6.2" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#using-sampling-distributions-to-understand-the-behavior-of-statistics-of-interest"><i class="fa fa-check"></i><b>A.6.2</b> Using sampling distributions to understand the behavior of statistics of interest</a></li>
<li class="chapter" data-level="A.6.3" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#sampling-distributions-for-different-sample-sizes"><i class="fa fa-check"></i><b>A.6.3</b> Sampling distributions for different sample sizes</a></li>
<li class="chapter" data-level="A.6.4" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#discussion-of-trends-for-sampling-distributions-of-different-sample-sizes"><i class="fa fa-check"></i><b>A.6.4</b> Discussion of trends for sampling distributions of different sample sizes</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>A.7</b> Standard Error of the Mean</a></li>
<li class="chapter" data-level="A.8" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#sampling-distribution-of-the-standard-deviation"><i class="fa fa-check"></i><b>A.8</b> Sampling Distribution of the Standard Deviation</a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#standard-error-of-standard-deviations"><i class="fa fa-check"></i><b>A.8.1</b> Standard error of standard deviations</a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#what-happens-to-the-sampling-distribution-of-the-mean-and-standard-deviation-when-our-sample-size-is-small"><i class="fa fa-check"></i><b>A.9</b> What happens to the sampling distribution of the mean and standard deviation when our sample size is small?</a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#for-small-samples-sample-standard-deviations-systematically-underestimate-the-population-standard-deviation"><i class="fa fa-check"></i><b>A.9.1</b> For small samples, sample standard deviations systematically underestimate the population standard deviation</a></li>
<li class="chapter" data-level="A.9.2" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#underestimates-of-the-standard-deviation-for-small-n-lead-to-understimates-of-the-se-of-the-mean"><i class="fa fa-check"></i><b>A.9.2</b> Underestimates of the standard deviation for small <span class="math inline">\(n\)</span> lead to understimates of the SE of the mean</a></li>
<li class="chapter" data-level="A.9.3" data-path="simulating-sampling-distributions.html"><a href="simulating-sampling-distributions.html#the-t-distribution-is-the-appropriate-distribution-for-describing-the-sampling-distribution-of-the-mean-when-n-is-small"><i class="fa fa-check"></i><b>A.9.3</b> The t-distribution is the appropriate distribution for describing the sampling distribution of the mean when <span class="math inline">\(n\)</span> is small</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html"><i class="fa fa-check"></i><b>B</b> Simulating confidence intervals</a>
<ul>
<li class="chapter" data-level="B.1" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#confidence-intervals"><i class="fa fa-check"></i><b>B.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="B.2" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#generic-formulation-for-confidence-intervals"><i class="fa fa-check"></i><b>B.2</b> Generic formulation for confidence intervals</a></li>
<li class="chapter" data-level="B.3" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#example-confidence-intervals-for-the-mean"><i class="fa fa-check"></i><b>B.3</b> Example: Confidence intervals for the mean</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#simulation-of-means"><i class="fa fa-check"></i><b>B.3.1</b> Simulation of means</a></li>
<li class="chapter" data-level="B.3.2" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#distance-between-sample-means-and-true-means"><i class="fa fa-check"></i><b>B.3.2</b> Distance between sample means and true means</a></li>
<li class="chapter" data-level="B.3.3" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#calculating-a-ci"><i class="fa fa-check"></i><b>B.3.3</b> Calculating a CI</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#a-problem-arises"><i class="fa fa-check"></i><b>B.4</b> A problem arises!</a></li>
<li class="chapter" data-level="B.5" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#confidence-intervals-under-sample-estimates-of-standard-errors"><i class="fa fa-check"></i><b>B.5</b> Confidence intervals under sample estimates of standard errors</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#the-spread-of-sample-estimates-of-the-mean-in-units-of-true-and-estimates-ses"><i class="fa fa-check"></i><b>B.5.1</b> The spread of sample estimates of the mean in units of true and estimates SEs</a></li>
<li class="chapter" data-level="B.5.2" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#quantifying-deviations-of-sample-estimates-of-the-mean"><i class="fa fa-check"></i><b>B.5.2</b> Quantifying deviations of sample estimates of the mean</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#t-distribution-for-confidence-intervals-of-the-mean"><i class="fa fa-check"></i><b>B.6</b> t-distribution for confidence intervals of the mean</a>
<ul>
<li class="chapter" data-level="B.6.1" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#t-distribution-vs-standard-normal-distribution"><i class="fa fa-check"></i><b>B.6.1</b> t-distribution vs standard normal distribution</a></li>
<li class="chapter" data-level="B.6.2" data-path="simulating-confidence-intervals.html"><a href="simulating-confidence-intervals.html#formula-for-confidence-intervals-of-the-mean-based-on-sample-estimates-of-the-se-and-the-t-distribution"><i class="fa fa-check"></i><b>B.6.2</b> Formula for confidence intervals of the mean based on sample estimates of the SE and the t-distribution</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biology 723: Statistical Computing for Biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="randomization-jackknife-and-bootstrap" class="section level1" number="17">
<h1><span class="header-section-number">Chapter 17</span> Randomization, Jackknife, and Bootstrap</h1>
<div id="libraries-6" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> Libraries</h2>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="randomization-jackknife-and-bootstrap.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb509-2"><a href="randomization-jackknife-and-bootstrap.html#cb509-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb509-3"><a href="randomization-jackknife-and-bootstrap.html#cb509-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20180404</span>)</span></code></pre></div>
</div>
<div id="randomization" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> Randomization</h2>
<p>There are a number of packages (e.g. <code>coin</code>) that include functions for carrying out randomization/permutation tests in R. However, it’s often just as easy to write a quick set of functions to carry out such tests yourself. We’ll illustrate a simple example of this using an example from Manly (2007).</p>
<p>Consider the following data set composed of measures of mandible lengths (in mm) for male and female golden jackals. This set of measurements was taken from a set of skeletons in the collections of the British Museum of Natural History.</p>
<ul>
<li><strong>Females</strong>: 110, 111, 107, 108, 110, 105, 107, 106, 111, 111</li>
<li><strong>Males</strong>: 120, 107, 110, 116, 114, 111, 113, 117, 114, 112</li>
</ul>
<p>Let’s first two vectors to represent this set of measurements, and then create a data frame to hold this information:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="randomization-jackknife-and-bootstrap.html#cb510-1" aria-hidden="true" tabindex="-1"></a>male.mandibles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">120</span>,<span class="dv">107</span>,<span class="dv">110</span>,<span class="dv">116</span>,<span class="dv">114</span>,<span class="dv">111</span>,<span class="dv">113</span>,<span class="dv">117</span>,<span class="dv">114</span>,<span class="dv">112</span>)</span>
<span id="cb510-2"><a href="randomization-jackknife-and-bootstrap.html#cb510-2" aria-hidden="true" tabindex="-1"></a>female.mandibles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">110</span>,<span class="dv">111</span>,<span class="dv">107</span>,<span class="dv">108</span>,<span class="dv">110</span>,<span class="dv">105</span>,<span class="dv">107</span>,<span class="dv">106</span>,<span class="dv">111</span>,<span class="dv">111</span>)</span>
<span id="cb510-3"><a href="randomization-jackknife-and-bootstrap.html#cb510-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-4"><a href="randomization-jackknife-and-bootstrap.html#cb510-4" aria-hidden="true" tabindex="-1"></a>jackals <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;m&quot;</span>,<span class="dv">10</span>),<span class="fu">rep</span>(<span class="st">&quot;f&quot;</span>,<span class="dv">10</span>)), </span>
<span id="cb510-5"><a href="randomization-jackknife-and-bootstrap.html#cb510-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mandible.length =</span> <span class="fu">c</span>(male.mandibles,female.mandibles))</span></code></pre></div>
<p>And we’ll create a simple strip chart to visualize the data</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="randomization-jackknife-and-bootstrap.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jackals, <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">y =</span> mandible.length, <span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb511-2"><a href="randomization-jackknife-and-bootstrap.html#cb511-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">height=</span><span class="dv">0</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span><span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-507-1.png" width="576" /></p>
<p>Having done so, let’s look at the male and female means and the difference between them:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="randomization-jackknife-and-bootstrap.html#cb512-1" aria-hidden="true" tabindex="-1"></a>jackals <span class="sc">%&gt;%</span></span>
<span id="cb512-2"><a href="randomization-jackknife-and-bootstrap.html#cb512-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb512-3"><a href="randomization-jackknife-and-bootstrap.html#cb512-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean.mandible.length =</span> <span class="fu">mean</span>(mandible.length))</span>
<span id="cb512-4"><a href="randomization-jackknife-and-bootstrap.html#cb512-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 2 x 2</span></span>
<span id="cb512-5"><a href="randomization-jackknife-and-bootstrap.html#cb512-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   sex   mean.mandible.length</span></span>
<span id="cb512-6"><a href="randomization-jackknife-and-bootstrap.html#cb512-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                &lt;dbl&gt;</span></span>
<span id="cb512-7"><a href="randomization-jackknife-and-bootstrap.html#cb512-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 f                     109.</span></span>
<span id="cb512-8"><a href="randomization-jackknife-and-bootstrap.html#cb512-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 m                     113.</span></span></code></pre></div>
<p>The difference in the mean mandible length is:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="randomization-jackknife-and-bootstrap.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(male.mandibles) <span class="sc">-</span> <span class="fu">mean</span>(female.mandibles) </span>
<span id="cb513-2"><a href="randomization-jackknife-and-bootstrap.html#cb513-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4.8</span></span></code></pre></div>
</div>
<div id="using-randomization-to-test-for-a-difference-in-means" class="section level2" number="17.3">
<h2><span class="header-section-number">17.3</span> Using randomization to test for a difference in means</h2>
<p>The hypothesis we want to test is that male jackals have, on average, larger mandibles than female jackals. The strip plot we constructed and difference in the means would seem to suggest so but let’s carry out some more formal tests. The obvious way to compare this set of measurements would be to carry out a t-test, which is approropriate if the samples are normally distributed with approximately equal variance. We have small samples here, so it’s hard to know if the normal distribution holds. Instead we’ll use a randomization test to compare the observed difference in the means to the distribution of differences we would expect to observe if the labels <code>male' and</code>female’ were randomly applied to samples of equal size from the data at hand.</p>
<p>Let’s create a function that takes a sample and randomly assigns the observations to two groups of a specified size. The function takes as input a vector of values (size <span class="math inline">\(N\)</span>) and two integers representing the sample sizes (<span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> where <span class="math inline">\(n_1 + n_2 = N\)</span>) of the two groups to be compared.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="randomization-jackknife-and-bootstrap.html#cb514-1" aria-hidden="true" tabindex="-1"></a>randomize.two.groups <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n1, n2){</span>
<span id="cb514-2"><a href="randomization-jackknife-and-bootstrap.html#cb514-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample w/out replacement</span></span>
<span id="cb514-3"><a href="randomization-jackknife-and-bootstrap.html#cb514-3" aria-hidden="true" tabindex="-1"></a>  reordered <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="fu">length</span>(x)) <span class="co"># see help(sample) for more info</span></span>
<span id="cb514-4"><a href="randomization-jackknife-and-bootstrap.html#cb514-4" aria-hidden="true" tabindex="-1"></a>  g1 <span class="ot">&lt;-</span> reordered[<span class="fu">seq</span>(<span class="dv">1</span>,n1)]  <span class="co"># take the first n1 items as group 1</span></span>
<span id="cb514-5"><a href="randomization-jackknife-and-bootstrap.html#cb514-5" aria-hidden="true" tabindex="-1"></a>  g2 <span class="ot">&lt;-</span> reordered[<span class="fu">seq</span>(n1<span class="sc">+</span><span class="dv">1</span>,n1<span class="sc">+</span>n2)] <span class="co"># take the the remaining items as group 2</span></span>
<span id="cb514-6"><a href="randomization-jackknife-and-bootstrap.html#cb514-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(g1,g2)</span>
<span id="cb514-7"><a href="randomization-jackknife-and-bootstrap.html#cb514-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Test out this function by calling it repeatedly as shown below. You’ll see that it returns a random reordering of the original data, split into two groups:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="randomization-jackknife-and-bootstrap.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">randomize.two.groups</span>(jackals<span class="sc">$</span>mandible.length, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb515-2"><a href="randomization-jackknife-and-bootstrap.html#cb515-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb515-3"><a href="randomization-jackknife-and-bootstrap.html#cb515-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 110 114 120 107 111 106 112 111 110 113</span></span>
<span id="cb515-4"><a href="randomization-jackknife-and-bootstrap.html#cb515-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb515-5"><a href="randomization-jackknife-and-bootstrap.html#cb515-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb515-6"><a href="randomization-jackknife-and-bootstrap.html#cb515-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 110 111 107 108 117 105 114 111 116 107</span></span></code></pre></div>
<p>Everytime you call this function you get a different random reordering:</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="randomization-jackknife-and-bootstrap.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="fu">randomize.two.groups</span>(jackals<span class="sc">$</span>mandible.length,<span class="dv">10</span>,<span class="dv">10</span>) <span class="co"># call it again to get a different sample</span></span>
<span id="cb516-2"><a href="randomization-jackknife-and-bootstrap.html#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb516-3"><a href="randomization-jackknife-and-bootstrap.html#cb516-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 114 117 111 110 120 107 110 107 110 108</span></span>
<span id="cb516-4"><a href="randomization-jackknife-and-bootstrap.html#cb516-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb516-5"><a href="randomization-jackknife-and-bootstrap.html#cb516-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb516-6"><a href="randomization-jackknife-and-bootstrap.html#cb516-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 111 111 116 111 112 106 107 105 114 113</span></span></code></pre></div>
<p>Now let’s write a simple function that returns the mean difference between two samples:</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="randomization-jackknife-and-bootstrap.html#cb517-1" aria-hidden="true" tabindex="-1"></a>mean.diff <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2) {</span>
<span id="cb517-2"><a href="randomization-jackknife-and-bootstrap.html#cb517-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x1) <span class="sc">-</span> <span class="fu">mean</span>(x2)</span>
<span id="cb517-3"><a href="randomization-jackknife-and-bootstrap.html#cb517-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let’s write a generic randomization function:</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="randomization-jackknife-and-bootstrap.html#cb518-1" aria-hidden="true" tabindex="-1"></a>randomization <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2, fxn,<span class="at">nsamples=</span><span class="dv">100</span>){</span>
<span id="cb518-2"><a href="randomization-jackknife-and-bootstrap.html#cb518-2" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">c</span>()  <span class="co"># will hold our randomized stats</span></span>
<span id="cb518-3"><a href="randomization-jackknife-and-bootstrap.html#cb518-3" aria-hidden="true" tabindex="-1"></a>  orig <span class="ot">&lt;-</span> <span class="fu">c</span>(x1,x2)</span>
<span id="cb518-4"><a href="randomization-jackknife-and-bootstrap.html#cb518-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsamples){</span>
<span id="cb518-5"><a href="randomization-jackknife-and-bootstrap.html#cb518-5" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> <span class="fu">randomize.two.groups</span>(orig, <span class="fu">length</span>(x1), <span class="fu">length</span>(x2))</span>
<span id="cb518-6"><a href="randomization-jackknife-and-bootstrap.html#cb518-6" aria-hidden="true" tabindex="-1"></a>    stats <span class="ot">&lt;-</span> <span class="fu">c</span>(stats, <span class="fu">fxn</span>(g[[<span class="dv">1</span>]],g[[<span class="dv">2</span>]]))</span>
<span id="cb518-7"><a href="randomization-jackknife-and-bootstrap.html#cb518-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb518-8"><a href="randomization-jackknife-and-bootstrap.html#cb518-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (stats)</span>
<span id="cb518-9"><a href="randomization-jackknife-and-bootstrap.html#cb518-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can then use the <code>randomization()</code> function we wrote as follows to evaluate the significance of the observed difference in means in the original sample. First we generate 1000 random samples, where the group membership has been randomized with respect to the measurements, and calculate the mean difference between the groups for each of those randomized samples:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="randomization-jackknife-and-bootstrap.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 1000  samples of the mean.diff for randomized data</span></span>
<span id="cb519-2"><a href="randomization-jackknife-and-bootstrap.html#cb519-2" aria-hidden="true" tabindex="-1"></a>rsample <span class="ot">&lt;-</span> <span class="fu">randomization</span>(male.mandibles, </span>
<span id="cb519-3"><a href="randomization-jackknife-and-bootstrap.html#cb519-3" aria-hidden="true" tabindex="-1"></a>                         female.mandibles, </span>
<span id="cb519-4"><a href="randomization-jackknife-and-bootstrap.html#cb519-4" aria-hidden="true" tabindex="-1"></a>                         mean.diff, <span class="dv">1000</span>)</span></code></pre></div>
<p>Now let’s examine the distribution, using a function called <code>quickplot()</code> which is a convenience function included with <code>ggplot2</code> that enables us to avoid creating data frames when we just want to create some quick visualizations:</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="randomization-jackknife-and-bootstrap.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># examine the distribution</span></span>
<span id="cb520-2"><a href="randomization-jackknife-and-bootstrap.html#cb520-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(rsample, <span class="at">geom=</span><span class="st">&#39;histogram&#39;</span>,</span>
<span id="cb520-3"><a href="randomization-jackknife-and-bootstrap.html#cb520-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">bins=</span><span class="dv">20</span>,</span>
<span id="cb520-4"><a href="randomization-jackknife-and-bootstrap.html#cb520-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">&quot;Histogram of randomized differences</span><span class="sc">\n</span><span class="st">in male and female means&quot;</span>,</span>
<span id="cb520-5"><a href="randomization-jackknife-and-bootstrap.html#cb520-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;mean(males) - mean(females)&quot;</span>)  <span class="sc">+</span> </span>
<span id="cb520-6"><a href="randomization-jackknife-and-bootstrap.html#cb520-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;curve&quot;</span>, <span class="at">x =</span> <span class="fl">4.8</span>, <span class="at">y =</span> <span class="dv">50</span>, <span class="at">xend =</span> <span class="fl">4.8</span>, <span class="at">yend =</span> <span class="dv">5</span>, <span class="at">curvature=</span><span class="dv">0</span>,</span>
<span id="cb520-7"><a href="randomization-jackknife-and-bootstrap.html#cb520-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span><span class="st">&#39;red&#39;</span>,<span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb520-8"><a href="randomization-jackknife-and-bootstrap.html#cb520-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">4.8</span>, <span class="at">y =</span> <span class="dv">60</span>,</span>
<span id="cb520-9"><a href="randomization-jackknife-and-bootstrap.html#cb520-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Observed</span><span class="sc">\n</span><span class="st">difference&quot;</span>, <span class="at">hjust =</span> <span class="st">&quot;center&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-516-1.png" width="576" /></p>
<p>We then pose the questions “In how many of the random samples is the mean difference between the two groups as great or larger than the observed difference in our original samples?”</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="randomization-jackknife-and-bootstrap.html#cb521-1" aria-hidden="true" tabindex="-1"></a>ngreater <span class="ot">&lt;-</span> <span class="fu">sum</span>(rsample <span class="sc">&gt;=</span> <span class="fl">4.8</span>)</span>
<span id="cb521-2"><a href="randomization-jackknife-and-bootstrap.html#cb521-2" aria-hidden="true" tabindex="-1"></a>ngreater</span>
<span id="cb521-3"><a href="randomization-jackknife-and-bootstrap.html#cb521-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span></code></pre></div>
<p>So our conclusion is that the probability of getting a mean difference between samples of this size is about 1/1000 = 0.001. Note that we can’t generalize this to golden jackals as a whole because we know nothing about whether these samples actually represent random samples of the golden jackal population or biases that might have been imposed on the collection (e.g. maybe the collectors liked to single out particularly large males). However, if we saw a similar trend (males larger than females) in multiple museum collections we might see this as supporting evidence that the trend holds true in general.</p>
</div>
<div id="using-randomization-to-test-for-equality-of-variances" class="section level2" number="17.4">
<h2><span class="header-section-number">17.4</span> Using randomization to test for equality of variances</h2>
<p>Note that we wrote our <code>randomization()</code> function to take an arbitrary function that takes as its input two vectors of data. That means we can use it to estimate the randomized distribution of arbitrary statistics of interest. Here we illustrate that with another function that calculates the ratio of variances. This for example could be used to assess the null hypothesis that male and female jackals have similar variation in mandible length. If the null hypothesis was true, we would expect that the ratio of variances should be approximately 1.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="randomization-jackknife-and-bootstrap.html#cb522-1" aria-hidden="true" tabindex="-1"></a>ratio.var <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2){</span>
<span id="cb522-2"><a href="randomization-jackknife-and-bootstrap.html#cb522-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">var</span>(x1)<span class="sc">/</span><span class="fu">var</span>(x2)</span>
<span id="cb522-3"><a href="randomization-jackknife-and-bootstrap.html#cb522-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb522-4"><a href="randomization-jackknife-and-bootstrap.html#cb522-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb522-5"><a href="randomization-jackknife-and-bootstrap.html#cb522-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ratio.var</span>(male.mandibles,</span>
<span id="cb522-6"><a href="randomization-jackknife-and-bootstrap.html#cb522-6" aria-hidden="true" tabindex="-1"></a>          female.mandibles)  <span class="co"># ratio of variances for the original samples</span></span>
<span id="cb522-7"><a href="randomization-jackknife-and-bootstrap.html#cb522-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.681034</span></span></code></pre></div>
<p>Here we see that the variance of the male sample is more than 2.5 times that of the female sample. But would this ratio of variances be unexpected under a null hypothesis of equal variances between the groups?</p>
<p>Again, our approach is to randomize the assignment of group labels associated with each measured value, and calculate the statistic of interest (ratio of variances in this case), for each randomized instance:</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="randomization-jackknife-and-bootstrap.html#cb523-1" aria-hidden="true" tabindex="-1"></a>vsample <span class="ot">&lt;-</span> <span class="fu">randomization</span>(male.mandibles, female.mandibles, ratio.var, <span class="dv">1000</span>)</span>
<span id="cb523-2"><a href="randomization-jackknife-and-bootstrap.html#cb523-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(vsample, <span class="at">bins=</span><span class="dv">20</span>,</span>
<span id="cb523-3"><a href="randomization-jackknife-and-bootstrap.html#cb523-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">&quot;Histogram of randomized ratios</span><span class="sc">\n</span><span class="st">of male and female variances&quot;</span>,</span>
<span id="cb523-4"><a href="randomization-jackknife-and-bootstrap.html#cb523-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;var(males)/var(females)&quot;</span>)  </span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-519-1.png" width="576" /></p>
<p>The mean ratio of variances in our randomized sample is:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="randomization-jackknife-and-bootstrap.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(vsample)</span>
<span id="cb524-2"><a href="randomization-jackknife-and-bootstrap.html#cb524-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.227834</span></span></code></pre></div>
<p>The number and fraction of times our randomized samples are greater than that observed for our actual samples is:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="randomization-jackknife-and-bootstrap.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(vsample <span class="sc">&gt;=</span> <span class="fl">2.68</span>)  <span class="co"># number of times </span></span>
<span id="cb525-2"><a href="randomization-jackknife-and-bootstrap.html#cb525-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 70</span></span>
<span id="cb525-3"><a href="randomization-jackknife-and-bootstrap.html#cb525-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(vsample <span class="sc">&gt;=</span> <span class="fl">2.68</span>)<span class="sc">/</span><span class="fl">1000.</span> <span class="co"># fraction of times </span></span>
<span id="cb525-4"><a href="randomization-jackknife-and-bootstrap.html#cb525-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.07</span></span></code></pre></div>
<p>In this case the observed ratio of variances is at roughly the 92.5% percentile of the distribution. This doesn’t quite meet the conventional 95% threshold for “significance” but it is suggests some support to doubt the null hypothesis of equal variances.</p>
<p>Let’s make one more comparison. From your intro biostats course you should be recall that ratios of variances have an <span class="math inline">\(F\)</span>-distribution so let’s compare the distribution of ratios of variances from our randomized sample to that of a sample of the same size drawn from the <span class="math inline">\(F\)</span>-distribution with the same degrees of freedom.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="randomization-jackknife-and-bootstrap.html#cb526-1" aria-hidden="true" tabindex="-1"></a>randomF <span class="ot">&lt;-</span> <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="dv">9</span>, <span class="dv">9</span>) <span class="co"># see help(rf)</span></span>
<span id="cb526-2"><a href="randomization-jackknife-and-bootstrap.html#cb526-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-3"><a href="randomization-jackknife-and-bootstrap.html#cb526-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb526-4"><a href="randomization-jackknife-and-bootstrap.html#cb526-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(vsample, <span class="at">color=</span><span class="st">&#39;randomization&#39;</span>)) <span class="sc">+</span></span>
<span id="cb526-5"><a href="randomization-jackknife-and-bootstrap.html#cb526-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(randomF, <span class="at">color=</span><span class="st">&#39;theoretical&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb526-6"><a href="randomization-jackknife-and-bootstrap.html#cb526-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Ratio of Variances&quot;</span>) <span class="sc">+</span> </span>
<span id="cb526-7"><a href="randomization-jackknife-and-bootstrap.html#cb526-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Type&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;firebrick&quot;</span>))</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-522-1.png" width="576" /></p>
</div>
<div id="jackknifing-in-r" class="section level2" number="17.5">
<h2><span class="header-section-number">17.5</span> Jackknifing in R</h2>
<p>Jackknife estimates of simple statistics are also relatively straightforward to calculate in R. Here we implement our own simple jackknife function:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="randomization-jackknife-and-bootstrap.html#cb527-1" aria-hidden="true" tabindex="-1"></a>jknife <span class="ot">&lt;-</span> <span class="cf">function</span>(x, fxn, <span class="at">ci=</span><span class="fl">0.95</span>) {</span>
<span id="cb527-2"><a href="randomization-jackknife-and-bootstrap.html#cb527-2" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> <span class="fu">fxn</span>(x)</span>
<span id="cb527-3"><a href="randomization-jackknife-and-bootstrap.html#cb527-3" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb527-4"><a href="randomization-jackknife-and-bootstrap.html#cb527-4" aria-hidden="true" tabindex="-1"></a>    partials <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)  </span>
<span id="cb527-5"><a href="randomization-jackknife-and-bootstrap.html#cb527-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb527-6"><a href="randomization-jackknife-and-bootstrap.html#cb527-6" aria-hidden="true" tabindex="-1"></a>       partials[i] <span class="ot">&lt;-</span> <span class="fu">fxn</span>(x[<span class="sc">-</span>i])</span>
<span id="cb527-7"><a href="randomization-jackknife-and-bootstrap.html#cb527-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb527-8"><a href="randomization-jackknife-and-bootstrap.html#cb527-8" aria-hidden="true" tabindex="-1"></a>    pseudos <span class="ot">&lt;-</span> (n<span class="sc">*</span>theta) <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>partials</span>
<span id="cb527-9"><a href="randomization-jackknife-and-bootstrap.html#cb527-9" aria-hidden="true" tabindex="-1"></a>    jack.est <span class="ot">&lt;-</span> <span class="fu">mean</span>(pseudos)</span>
<span id="cb527-10"><a href="randomization-jackknife-and-bootstrap.html#cb527-10" aria-hidden="true" tabindex="-1"></a>    jack.se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(pseudos)<span class="sc">/</span>n)</span>
<span id="cb527-11"><a href="randomization-jackknife-and-bootstrap.html#cb527-11" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>ci</span>
<span id="cb527-12"><a href="randomization-jackknife-and-bootstrap.html#cb527-12" aria-hidden="true" tabindex="-1"></a>    CI <span class="ot">&lt;-</span> <span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)<span class="sc">*</span>jack.se</span>
<span id="cb527-13"><a href="randomization-jackknife-and-bootstrap.html#cb527-13" aria-hidden="true" tabindex="-1"></a>    jack.ci <span class="ot">&lt;-</span> <span class="fu">c</span>(jack.est <span class="sc">-</span> CI, jack.est <span class="sc">+</span> CI)</span>
<span id="cb527-14"><a href="randomization-jackknife-and-bootstrap.html#cb527-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">est=</span>jack.est, <span class="at">se=</span>jack.se, <span class="at">ci=</span>jack.ci, <span class="at">pseudos =</span> pseudos, <span class="at">partials=</span>partials)</span>
<span id="cb527-15"><a href="randomization-jackknife-and-bootstrap.html#cb527-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>bootstrap</code> package contains a very similar implementation of a jackknife function (<code>jackknife()</code>).</p>
<p>Let’s illustrate our jackknife function using samples drawn from a Poisson distribution. The Poisson is a discrete probability distribution that is often used to describe the probability of a number of events occuring in a fixed period of time, where the events are independent and occur with an average rate <span class="math inline">\(\lambda\)</span>. The Poisson distribution is used to model processes like mutations in DNA sequences or atomic decay. Both the mean and variance of a Poisson distribution are equal to <span class="math inline">\(\lambda\)</span>. Let’s see how well the jackknife does at estimating confidence intervals for the mean and variance of a modest number of samples drawn from a Poisson.</p>
<p>First we draw a random sample from Poisson distribution with <span class="math inline">\(\lambda = 4\)</span>. Since we’re simulating a random sample we know what the “true” value is.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="randomization-jackknife-and-bootstrap.html#cb528-1" aria-hidden="true" tabindex="-1"></a>psample <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">25</span>,<span class="dv">4</span>) <span class="co"># 25 observations from poisson with lambda = 4</span></span>
<span id="cb528-2"><a href="randomization-jackknife-and-bootstrap.html#cb528-2" aria-hidden="true" tabindex="-1"></a>psample  <span class="co"># your sample will be different unless you used the same seed as I did</span></span>
<span id="cb528-3"><a href="randomization-jackknife-and-bootstrap.html#cb528-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1]  2  3  7  2  6  1  5  4  4 12  5  2  2  2  1  6  3  5  3  3  8  3  5  3  3</span></span></code></pre></div>
<p>Our sample estimates of the mean and variance are:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="randomization-jackknife-and-bootstrap.html#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(psample)</span>
<span id="cb529-2"><a href="randomization-jackknife-and-bootstrap.html#cb529-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4</span></span>
<span id="cb529-3"><a href="randomization-jackknife-and-bootstrap.html#cb529-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(psample)</span>
<span id="cb529-4"><a href="randomization-jackknife-and-bootstrap.html#cb529-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 6.083333</span></span></code></pre></div>
<p>We now jackknifing to estimate standard errors and confidence intervals for the mean and variance:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="randomization-jackknife-and-bootstrap.html#cb530-1" aria-hidden="true" tabindex="-1"></a>jack.means <span class="ot">&lt;-</span> <span class="fu">jknife</span>(psample, mean)</span>
<span id="cb530-2"><a href="randomization-jackknife-and-bootstrap.html#cb530-2" aria-hidden="true" tabindex="-1"></a>jack.vars <span class="ot">&lt;-</span> <span class="fu">jknife</span>(psample, var)</span></code></pre></div>
<p>Here is the 95% CI for the means and variances:</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="randomization-jackknife-and-bootstrap.html#cb531-1" aria-hidden="true" tabindex="-1"></a>jack.means<span class="sc">$</span>ci <span class="co"># 95% bootstreap CI for mean</span></span>
<span id="cb531-2"><a href="randomization-jackknife-and-bootstrap.html#cb531-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.981903 5.018097</span></span>
<span id="cb531-3"><a href="randomization-jackknife-and-bootstrap.html#cb531-3" aria-hidden="true" tabindex="-1"></a>jack.vars<span class="sc">$</span>ci <span class="co"># 95% boostrap CI for vars</span></span>
<span id="cb531-4"><a href="randomization-jackknife-and-bootstrap.html#cb531-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  0.3893018 11.7773649</span></span></code></pre></div>
<p>In both cases above, the true mean and variance were contained within the 95% confidence intervals estimated by the jackknife.</p>
<p>Let’s do a little experiment to see how often that’s true for samples of this size:</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="randomization-jackknife-and-bootstrap.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create 500 samples of size 25 drawn from Poisson w/lambda=4</span></span>
<span id="cb532-2"><a href="randomization-jackknife-and-bootstrap.html#cb532-2" aria-hidden="true" tabindex="-1"></a>psamples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rpois</span>(<span class="dv">25</span><span class="sc">*</span><span class="dv">500</span>,<span class="dv">4</span>),<span class="at">ncol=</span><span class="dv">25</span>,<span class="at">byrow=</span>T)</span>
<span id="cb532-3"><a href="randomization-jackknife-and-bootstrap.html#cb532-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(psamples)</span>
<span id="cb532-4"><a href="randomization-jackknife-and-bootstrap.html#cb532-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 500  25</span></span>
<span id="cb532-5"><a href="randomization-jackknife-and-bootstrap.html#cb532-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-6"><a href="randomization-jackknife-and-bootstrap.html#cb532-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a convenience function</span></span>
<span id="cb532-7"><a href="randomization-jackknife-and-bootstrap.html#cb532-7" aria-hidden="true" tabindex="-1"></a>get.ci <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { <span class="fu">return</span>(x<span class="sc">$</span>ci) }  <span class="co">#x$ci gives confidence interval</span></span>
<span id="cb532-8"><a href="randomization-jackknife-and-bootstrap.html#cb532-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-9"><a href="randomization-jackknife-and-bootstrap.html#cb532-9" aria-hidden="true" tabindex="-1"></a><span class="co"># generate jackknife estimates for mean</span></span>
<span id="cb532-10"><a href="randomization-jackknife-and-bootstrap.html#cb532-10" aria-hidden="true" tabindex="-1"></a>j.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(psamples, <span class="dv">1</span>, jknife, mean)</span>
<span id="cb532-11"><a href="randomization-jackknife-and-bootstrap.html#cb532-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-12"><a href="randomization-jackknife-and-bootstrap.html#cb532-12" aria-hidden="true" tabindex="-1"></a><span class="co"># make matrix that holds 95% confidence intervals of mean</span></span>
<span id="cb532-13"><a href="randomization-jackknife-and-bootstrap.html#cb532-13" aria-hidden="true" tabindex="-1"></a>mean.ci <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(j.mean, get.ci))</span>
<span id="cb532-14"><a href="randomization-jackknife-and-bootstrap.html#cb532-14" aria-hidden="true" tabindex="-1"></a>mean.ci[<span class="dv">1</span>,]</span>
<span id="cb532-15"><a href="randomization-jackknife-and-bootstrap.html#cb532-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.864371 4.255629</span></span>
<span id="cb532-16"><a href="randomization-jackknife-and-bootstrap.html#cb532-16" aria-hidden="true" tabindex="-1"></a>mean.ci[<span class="dv">2</span>,]</span>
<span id="cb532-17"><a href="randomization-jackknife-and-bootstrap.html#cb532-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3.046752 5.033248</span></span>
<span id="cb532-18"><a href="randomization-jackknife-and-bootstrap.html#cb532-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-19"><a href="randomization-jackknife-and-bootstrap.html#cb532-19" aria-hidden="true" tabindex="-1"></a><span class="co"># check how often true mean is w/in CI</span></span>
<span id="cb532-20"><a href="randomization-jackknife-and-bootstrap.html#cb532-20" aria-hidden="true" tabindex="-1"></a>includes.true.mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(mean.ci[,<span class="dv">1</span>] <span class="sc">&lt;=</span><span class="dv">4</span>, mean.ci[,<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="dv">4</span>)</span>
<span id="cb532-21"><a href="randomization-jackknife-and-bootstrap.html#cb532-21" aria-hidden="true" tabindex="-1"></a>includes.true.mean</span>
<span id="cb532-22"><a href="randomization-jackknife-and-bootstrap.html#cb532-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 969</span></span>
<span id="cb532-23"><a href="randomization-jackknife-and-bootstrap.html#cb532-23" aria-hidden="true" tabindex="-1"></a>includes.true.mean<span class="sc">/</span><span class="dv">500</span>  <span class="co"># true mean is w/in estimated 95% CI about 93% of the time.</span></span>
<span id="cb532-24"><a href="randomization-jackknife-and-bootstrap.html#cb532-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.938</span></span>
<span id="cb532-25"><a href="randomization-jackknife-and-bootstrap.html#cb532-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-26"><a href="randomization-jackknife-and-bootstrap.html#cb532-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-27"><a href="randomization-jackknife-and-bootstrap.html#cb532-27" aria-hidden="true" tabindex="-1"></a><span class="co"># now the same for variances</span></span>
<span id="cb532-28"><a href="randomization-jackknife-and-bootstrap.html#cb532-28" aria-hidden="true" tabindex="-1"></a>j.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(psamples, <span class="dv">1</span>, jknife, var)</span>
<span id="cb532-29"><a href="randomization-jackknife-and-bootstrap.html#cb532-29" aria-hidden="true" tabindex="-1"></a>var.ci <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(j.var, get.ci))</span>
<span id="cb532-30"><a href="randomization-jackknife-and-bootstrap.html#cb532-30" aria-hidden="true" tabindex="-1"></a>includes.true.var <span class="ot">&lt;-</span> <span class="fu">sum</span>(var.ci[,<span class="dv">1</span>] <span class="sc">&lt;=</span><span class="dv">4</span>, var.ci[,<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="dv">4</span>)</span>
<span id="cb532-31"><a href="randomization-jackknife-and-bootstrap.html#cb532-31" aria-hidden="true" tabindex="-1"></a>includes.true.var</span>
<span id="cb532-32"><a href="randomization-jackknife-and-bootstrap.html#cb532-32" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 939</span></span>
<span id="cb532-33"><a href="randomization-jackknife-and-bootstrap.html#cb532-33" aria-hidden="true" tabindex="-1"></a>includes.true.var<span class="sc">/</span><span class="dv">500</span>  <span class="co"># true variance is w/in 95% CI only 88% of time</span></span>
<span id="cb532-34"><a href="randomization-jackknife-and-bootstrap.html#cb532-34" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.878</span></span></code></pre></div>
<p>In the case of the confidence intervals for the mean, the jacknife estimator did a decent job – the true mean is with the 95% confidence interval about 93% of the time. In the case of the variance it did less well. The jackknife confidence intervals work well when the estimator is normally distributed. This suggests that one way we might improve the jackknife CIs is by using a normalizing transformation, like the logarithm function:</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="randomization-jackknife-and-bootstrap.html#cb533-1" aria-hidden="true" tabindex="-1"></a>log.var <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">log</span>(<span class="fu">var</span>(x))}</span>
<span id="cb533-2"><a href="randomization-jackknife-and-bootstrap.html#cb533-2" aria-hidden="true" tabindex="-1"></a>j.log.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(psamples, <span class="dv">1</span>, jknife, log.var)</span>
<span id="cb533-3"><a href="randomization-jackknife-and-bootstrap.html#cb533-3" aria-hidden="true" tabindex="-1"></a>log.var.ci <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(j.log.var, get.ci))</span>
<span id="cb533-4"><a href="randomization-jackknife-and-bootstrap.html#cb533-4" aria-hidden="true" tabindex="-1"></a>includes.true.var.transformed <span class="ot">&lt;-</span> <span class="fu">sum</span>(log.var.ci[,<span class="dv">1</span>] <span class="sc">&lt;=</span><span class="fu">log</span>(<span class="dv">4</span>), log.var.ci[,<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="fu">log</span>(<span class="dv">4</span>))</span>
<span id="cb533-5"><a href="randomization-jackknife-and-bootstrap.html#cb533-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-6"><a href="randomization-jackknife-and-bootstrap.html#cb533-6" aria-hidden="true" tabindex="-1"></a><span class="co"># an improvement in the performance of the 95% CIs</span></span>
<span id="cb533-7"><a href="randomization-jackknife-and-bootstrap.html#cb533-7" aria-hidden="true" tabindex="-1"></a>includes.true.var.transformed<span class="sc">/</span><span class="dv">500</span>  </span>
<span id="cb533-8"><a href="randomization-jackknife-and-bootstrap.html#cb533-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.932</span></span></code></pre></div>
<p>This illustrates the type of simulation study you might do to check the robustness of the jackknife for a statistic of interest for a given class of distributions.</p>
</div>
<div id="bootstrapping-in-r" class="section level2" number="17.6">
<h2><span class="header-section-number">17.6</span> Bootstrapping in R</h2>
<p>There are several packages that provide functions for doing bootstrapping in R. These include <code>bootstrap</code> and <code>boot</code>. We’ll take a quick look at the functions in <code>bootstrap</code>.</p>
<p>Install <code>bootstrap</code> using the standard package installation mechanism and then load it.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="randomization-jackknife-and-bootstrap.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb534-2"><a href="randomization-jackknife-and-bootstrap.html#cb534-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb534-3"><a href="randomization-jackknife-and-bootstrap.html#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;bootstrap&#39;</span></span>
<span id="cb534-4"><a href="randomization-jackknife-and-bootstrap.html#cb534-4" aria-hidden="true" tabindex="-1"></a><span class="do">## The following object is masked from &#39;package:broom&#39;:</span></span>
<span id="cb534-5"><a href="randomization-jackknife-and-bootstrap.html#cb534-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb534-6"><a href="randomization-jackknife-and-bootstrap.html#cb534-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     bootstrap</span></span></code></pre></div>
<p>We’ll start with the same set of samples from the Poisson that we used before to illustrate the jackknife.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="randomization-jackknife-and-bootstrap.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 1000 bootstrap sample estimate of var</span></span>
<span id="cb535-2"><a href="randomization-jackknife-and-bootstrap.html#cb535-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using full name here to avoid naming conflict with broom</span></span>
<span id="cb535-3"><a href="randomization-jackknife-and-bootstrap.html#cb535-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> bootstrap<span class="sc">::</span><span class="fu">bootstrap</span>(psample, <span class="dv">1000</span>, var)</span></code></pre></div>
<p>The <code>bootstrap::bootstrap()</code> function returns a list:</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="randomization-jackknife-and-bootstrap.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(b)</span>
<span id="cb536-2"><a href="randomization-jackknife-and-bootstrap.html#cb536-2" aria-hidden="true" tabindex="-1"></a><span class="do">## List of 5</span></span>
<span id="cb536-3"><a href="randomization-jackknife-and-bootstrap.html#cb536-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ thetastar     : num [1:1000] 1.79 9.31 2.71 10.97 5.74 ...</span></span>
<span id="cb536-4"><a href="randomization-jackknife-and-bootstrap.html#cb536-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ func.thetastar: NULL</span></span>
<span id="cb536-5"><a href="randomization-jackknife-and-bootstrap.html#cb536-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ jack.boot.val : NULL</span></span>
<span id="cb536-6"><a href="randomization-jackknife-and-bootstrap.html#cb536-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ jack.boot.se  : NULL</span></span>
<span id="cb536-7"><a href="randomization-jackknife-and-bootstrap.html#cb536-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ call          : language bootstrap::bootstrap(x = psample, nboot = 1000, theta = var)</span></span></code></pre></div>
<p>The list item <code>thetastar</code> (a vector) contains each of the bootrap estimates of the statistic of interest (variance in the present example). It’s always good to plot a histogram of the bootstrap distribution:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="randomization-jackknife-and-bootstrap.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(b<span class="sc">$</span>thetastar, <span class="at">geom=</span><span class="st">&quot;histogram&quot;</span>, <span class="at">bins=</span><span class="dv">25</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-533-1.png" width="576" /></p>
<p>We’ll examine two different bootstrap confidence interval. The standard boostrap CIs are based on the assumption of the approximate normality of the sampling distribution of interest:</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="randomization-jackknife-and-bootstrap.html#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard bootstrap confidence limits</span></span>
<span id="cb538-2"><a href="randomization-jackknife-and-bootstrap.html#cb538-2" aria-hidden="true" tabindex="-1"></a><span class="co"># based on assumption of approximate normality of the bootstrap distn</span></span>
<span id="cb538-3"><a href="randomization-jackknife-and-bootstrap.html#cb538-3" aria-hidden="true" tabindex="-1"></a>bstar <span class="ot">&lt;-</span> b<span class="sc">$</span>thetastar</span>
<span id="cb538-4"><a href="randomization-jackknife-and-bootstrap.html#cb538-4" aria-hidden="true" tabindex="-1"></a>ci.multiplier <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">qt</span>(<span class="fl">0.025</span>, <span class="at">df=</span><span class="dv">24</span>))  <span class="co"># cutoff of t-distn w/24 df</span></span>
<span id="cb538-5"><a href="randomization-jackknife-and-bootstrap.html#cb538-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(bstar)<span class="sc">-</span>ci.multiplier<span class="sc">*</span><span class="fu">sd</span>(bstar),</span>
<span id="cb538-6"><a href="randomization-jackknife-and-bootstrap.html#cb538-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(bstar)<span class="sc">+</span>ci.multiplier<span class="sc">*</span><span class="fu">sd</span>(bstar))</span>
<span id="cb538-7"><a href="randomization-jackknife-and-bootstrap.html#cb538-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  0.6422698 10.9844435</span></span></code></pre></div>
<p>Another approach is to use “percentile confidence limits” based on percentiles of the bootstrap distribution itself:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="randomization-jackknife-and-bootstrap.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the bootstrap percentile confidence limits</span></span>
<span id="cb539-2"><a href="randomization-jackknife-and-bootstrap.html#cb539-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(b<span class="sc">$</span>thetastar,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span>
<span id="cb539-3"><a href="randomization-jackknife-and-bootstrap.html#cb539-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      2.5%     97.5% </span></span>
<span id="cb539-4"><a href="randomization-jackknife-and-bootstrap.html#cb539-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  1.856667 11.008583</span></span></code></pre></div>
<div id="a-more-sophisticated-application-of-the-bootstrap" class="section level3" number="17.6.1">
<h3><span class="header-section-number">17.6.1</span> A more sophisticated application of the bootstrap</h3>
<p>Now let’s use the bootstrap to look at the distribution of a more complicated pair of statistics – the intercept and coefficients of a logistic regression. This time we’ll use the <code>boot</code> package to do the analysis, which is more flexible than the <code>bootstrap</code> package. <strong>Install the <code>boot</code> package as necessary.</strong></p>
</div>
<div id="about-logistic-regression" class="section level3" number="17.6.2">
<h3><span class="header-section-number">17.6.2</span> About logistic regression</h3>
<p>Logistic regression is used when the dependent variable is discrete (often binary). The explanatory variables may be either continuous or discrete.</p>
<p>Examples:</p>
<ul>
<li>Whether a gene is turned off (=0) or on (=1) as a function of levels of various proteins</li>
<li>Whether an individual is healthy (=0) or diseased (=1) as a function of various risk factors.</li>
<li>Whether an individual died (=0) or survived (=1) some selective event as a function of behavior, morphology, etc.</li>
</ul>
<p>We model the binary response variable, <span class="math inline">\(Y\)</span>, as a function of the predictor variables, <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, etc as :</p>
<p><span class="math display">\[
P(Y = 1|X_1,\ldots,X_p) = f(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_p X_p)
\]</span></p>
<p>So we’re modeling the <em>probability of the state of Y as a function of a linear combination of the predictor variables</em>.</p>
<p>For logistic regression, <span class="math inline">\(f\)</span> is the logistic function:
<span class="math display">\[
f(z) = \frac{e^z}{1+e^z} = \frac{1}{1 + e^{-z}}
\]</span></p>
<p>Therefore, the bivariate logistic regression is given by:
<span class="math display">\[
P(Y = 1|X) = \frac{1}{1 + e^{-(\beta_0 + \beta_1 X)}}
\]</span></p>
<p>Note that <span class="math inline">\(\beta_0\)</span> here is akin to the intercept in our standard linear regression.</p>
</div>
<div id="bumpus-house-sparrow-data-set" class="section level3" number="17.6.3">
<h3><span class="header-section-number">17.6.3</span> Bumpus house sparrow data set</h3>
<p>Bumpus (1898) described a sample of house sparrows which he collected
after a very severe storm. The sample included 136 birds, sixty four of
which perished during the storm. Also included in his description were a
variety of morphological measurements on the birds and information about
their sex and age (for male birds). This data set has become a benchmark
in the evolutionary biology literature for demonstrating methods for
analyzing natural selection.</p>
<ul>
<li>Bumpus, H. C. 1898. The elimination of the unfit as illustrated by the introduced sparrow, Passer domesticus. (A fourth contribution to the study of variation.) <em>Biol. Lectures: Woods Hole Marine Biological Laboratory</em>, 209–225.</li>
</ul>
<p>The bumpus data set is available from the class website as a tab-delimited file <a href="https://github.com/bio304-class/bio304-fall2017/raw/master/datasets/bumpus-data.txt">bumpus-data.txt</a>.</p>
</div>
<div id="predicting-survival-as-a-function-of-body-weight" class="section level3" number="17.6.4">
<h3><span class="header-section-number">17.6.4</span> Predicting survival as a function of body weight</h3>
<p>Let’s first carry out a logistic regression predicting survival as a function of body weight for the Bumpus bird data set we looked at previously.</p>
<p>First we’ll load the data:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="randomization-jackknife-and-bootstrap.html#cb540-1" aria-hidden="true" tabindex="-1"></a>bumpus <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;https://github.com/bio304-class/bio304-course-notes/raw/master/datasets/bumpus-data.txt&quot;</span>)</span>
<span id="cb540-2"><a href="randomization-jackknife-and-bootstrap.html#cb540-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb540-3"><a href="randomization-jackknife-and-bootstrap.html#cb540-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ── Column specification ────────────────────────────────────────────────────────</span></span>
<span id="cb540-4"><a href="randomization-jackknife-and-bootstrap.html#cb540-4" aria-hidden="true" tabindex="-1"></a><span class="do">## cols(</span></span>
<span id="cb540-5"><a href="randomization-jackknife-and-bootstrap.html#cb540-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   `line number` = col_double(),</span></span>
<span id="cb540-6"><a href="randomization-jackknife-and-bootstrap.html#cb540-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   sex = col_character(),</span></span>
<span id="cb540-7"><a href="randomization-jackknife-and-bootstrap.html#cb540-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   age.a_adult.y_young = col_character(),</span></span>
<span id="cb540-8"><a href="randomization-jackknife-and-bootstrap.html#cb540-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   survived = col_logical(),</span></span>
<span id="cb540-9"><a href="randomization-jackknife-and-bootstrap.html#cb540-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   total.length.mm = col_double(),</span></span>
<span id="cb540-10"><a href="randomization-jackknife-and-bootstrap.html#cb540-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   alar.extent.mm = col_double(),</span></span>
<span id="cb540-11"><a href="randomization-jackknife-and-bootstrap.html#cb540-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   weight.g = col_double(),</span></span>
<span id="cb540-12"><a href="randomization-jackknife-and-bootstrap.html#cb540-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   length.beak.and.head = col_double(),</span></span>
<span id="cb540-13"><a href="randomization-jackknife-and-bootstrap.html#cb540-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   length.humerus.in = col_double(),</span></span>
<span id="cb540-14"><a href="randomization-jackknife-and-bootstrap.html#cb540-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   length.femur.in = col_double(),</span></span>
<span id="cb540-15"><a href="randomization-jackknife-and-bootstrap.html#cb540-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   length.tibiotarsus.in = col_double(),</span></span>
<span id="cb540-16"><a href="randomization-jackknife-and-bootstrap.html#cb540-16" aria-hidden="true" tabindex="-1"></a><span class="do">##   width.skull.in = col_double(),</span></span>
<span id="cb540-17"><a href="randomization-jackknife-and-bootstrap.html#cb540-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   length.sternal.keel.in = col_double()</span></span>
<span id="cb540-18"><a href="randomization-jackknife-and-bootstrap.html#cb540-18" aria-hidden="true" tabindex="-1"></a><span class="do">## )</span></span></code></pre></div>
</div>
<div id="fitting-the-logistic-regression" class="section level3" number="17.6.5">
<h3><span class="header-section-number">17.6.5</span> Fitting the logistic regression</h3>
<p>Now let’s fit the logistic regression model and visualize the regression using ggplot.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="randomization-jackknife-and-bootstrap.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert TRUE/FALSE values to 1/0 values, to satisfy geom_smooth</span></span>
<span id="cb541-2"><a href="randomization-jackknife-and-bootstrap.html#cb541-2" aria-hidden="true" tabindex="-1"></a>bumpus<span class="sc">$</span>survived <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(bumpus<span class="sc">$</span>survived) </span>
<span id="cb541-3"><a href="randomization-jackknife-and-bootstrap.html#cb541-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-4"><a href="randomization-jackknife-and-bootstrap.html#cb541-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb541-5"><a href="randomization-jackknife-and-bootstrap.html#cb541-5" aria-hidden="true" tabindex="-1"></a>fit.survival <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived <span class="sc">~</span> weight.g, <span class="at">family =</span> binomial, </span>
<span id="cb541-6"><a href="randomization-jackknife-and-bootstrap.html#cb541-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> bumpus)</span>
<span id="cb541-7"><a href="randomization-jackknife-and-bootstrap.html#cb541-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-8"><a href="randomization-jackknife-and-bootstrap.html#cb541-8" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the regression plot</span></span>
<span id="cb541-9"><a href="randomization-jackknife-and-bootstrap.html#cb541-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bumpus, <span class="fu">aes</span>(<span class="at">x=</span>weight.g, <span class="at">y=</span>survived)) <span class="sc">+</span> </span>
<span id="cb541-10"><a href="randomization-jackknife-and-bootstrap.html#cb541-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb541-11"><a href="randomization-jackknife-and-bootstrap.html#cb541-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb541-12"><a href="randomization-jackknife-and-bootstrap.html#cb541-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Weight (g)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Prob. Survival&quot;</span>)</span>
<span id="cb541-13"><a href="randomization-jackknife-and-bootstrap.html#cb541-13" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-537-1.png" width="576" /></p>
<p>The logistic regression suggests that larger birds were <em>less likely</em> to survive the storm. Let’s look at a summary of the logistic regression model:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="randomization-jackknife-and-bootstrap.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.survival)</span>
<span id="cb542-2"><a href="randomization-jackknife-and-bootstrap.html#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb542-3"><a href="randomization-jackknife-and-bootstrap.html#cb542-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb542-4"><a href="randomization-jackknife-and-bootstrap.html#cb542-4" aria-hidden="true" tabindex="-1"></a><span class="do">## glm(formula = survived ~ weight.g, family = binomial, data = bumpus)</span></span>
<span id="cb542-5"><a href="randomization-jackknife-and-bootstrap.html#cb542-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb542-6"><a href="randomization-jackknife-and-bootstrap.html#cb542-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Deviance Residuals: </span></span>
<span id="cb542-7"><a href="randomization-jackknife-and-bootstrap.html#cb542-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb542-8"><a href="randomization-jackknife-and-bootstrap.html#cb542-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -1.6331  -1.1654   0.8579   1.0791   1.4626  </span></span>
<span id="cb542-9"><a href="randomization-jackknife-and-bootstrap.html#cb542-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb542-10"><a href="randomization-jackknife-and-bootstrap.html#cb542-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb542-11"><a href="randomization-jackknife-and-bootstrap.html#cb542-11" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span id="cb542-12"><a href="randomization-jackknife-and-bootstrap.html#cb542-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   8.0456     3.2516   2.474   0.0133 *</span></span>
<span id="cb542-13"><a href="randomization-jackknife-and-bootstrap.html#cb542-13" aria-hidden="true" tabindex="-1"></a><span class="do">## weight.g     -0.3105     0.1272  -2.441   0.0146 *</span></span>
<span id="cb542-14"><a href="randomization-jackknife-and-bootstrap.html#cb542-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb542-15"><a href="randomization-jackknife-and-bootstrap.html#cb542-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb542-16"><a href="randomization-jackknife-and-bootstrap.html#cb542-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb542-17"><a href="randomization-jackknife-and-bootstrap.html#cb542-17" aria-hidden="true" tabindex="-1"></a><span class="do">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb542-18"><a href="randomization-jackknife-and-bootstrap.html#cb542-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb542-19"><a href="randomization-jackknife-and-bootstrap.html#cb542-19" aria-hidden="true" tabindex="-1"></a><span class="do">##     Null deviance: 188.07  on 135  degrees of freedom</span></span>
<span id="cb542-20"><a href="randomization-jackknife-and-bootstrap.html#cb542-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual deviance: 181.58  on 134  degrees of freedom</span></span>
<span id="cb542-21"><a href="randomization-jackknife-and-bootstrap.html#cb542-21" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC: 185.58</span></span>
<span id="cb542-22"><a href="randomization-jackknife-and-bootstrap.html#cb542-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb542-23"><a href="randomization-jackknife-and-bootstrap.html#cb542-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>We’re most interested in the estimated intercept and regression coefficients.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="randomization-jackknife-and-bootstrap.html#cb543-1" aria-hidden="true" tabindex="-1"></a>fit.survival<span class="sc">$</span>coefficients</span>
<span id="cb543-2"><a href="randomization-jackknife-and-bootstrap.html#cb543-2" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)    weight.g </span></span>
<span id="cb543-3"><a href="randomization-jackknife-and-bootstrap.html#cb543-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   8.0455585  -0.3105315</span></span></code></pre></div>
</div>
<div id="defining-an-appropriate-function-for-boot" class="section level3" number="17.6.6">
<h3><span class="header-section-number">17.6.6</span> Defining an appropriate function for <code>boot</code></h3>
<p>The <code>boot()</code> function defined in the <code>boot</code> package requires at least three arguments: <code>boot(data, statistic, R,...)</code>.</p>
<ol style="list-style-type: decimal">
<li><code>data</code> is the data frame, matrix or vector you want to resample from</li>
<li><code>statistic</code> is a function which when applied to data returns a vector containing the statistic of interest;</li>
<li><code>R</code> is the number of bootstrap replicates to generate.</li>
</ol>
<p>The function passed as the <code>statistic</code> argument to <code>boot</code> must take at least two arguments – the first is the original data, and the second is a vector of indices defining the observations in the bootstrap sample.</p>
<p>So to do bootstrapping of the logistic regression model we have to define a suitable “wrapper function” that will carry out the logistic regression on each bootstrap sample and return the coefficients that we want. The code block that follow illustrates this:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="randomization-jackknife-and-bootstrap.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb544-2"><a href="randomization-jackknife-and-bootstrap.html#cb544-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb544-3"><a href="randomization-jackknife-and-bootstrap.html#cb544-3" aria-hidden="true" tabindex="-1"></a>logistic.reg.coeffs <span class="ot">&lt;-</span> <span class="cf">function</span>(x, indices) {</span>
<span id="cb544-4"><a href="randomization-jackknife-and-bootstrap.html#cb544-4" aria-hidden="true" tabindex="-1"></a>  fit.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived <span class="sc">~</span> weight.g, <span class="at">family =</span> binomial, x[indices,])</span>
<span id="cb544-5"><a href="randomization-jackknife-and-bootstrap.html#cb544-5" aria-hidden="true" tabindex="-1"></a>  reg.b0 <span class="ot">&lt;-</span> fit.model<span class="sc">$</span>coefficients[[<span class="dv">1</span>]]  <span class="co"># intercept</span></span>
<span id="cb544-6"><a href="randomization-jackknife-and-bootstrap.html#cb544-6" aria-hidden="true" tabindex="-1"></a>  reg.b1 <span class="ot">&lt;-</span> fit.model<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]  <span class="co"># regression coefficient</span></span>
<span id="cb544-7"><a href="randomization-jackknife-and-bootstrap.html#cb544-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(reg.b0, reg.b1))</span>
<span id="cb544-8"><a href="randomization-jackknife-and-bootstrap.html#cb544-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Having defined this function, we can carry out the bootstrap as follows:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="randomization-jackknife-and-bootstrap.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 500 bootstrap replicates</span></span>
<span id="cb545-2"><a href="randomization-jackknife-and-bootstrap.html#cb545-2" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb545-3"><a href="randomization-jackknife-and-bootstrap.html#cb545-3" aria-hidden="true" tabindex="-1"></a>reg.boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(bumpus, logistic.reg.coeffs, nreps)</span></code></pre></div>
<p>The object returned by the <code>boot</code> function has various components. First, let’s look at the bootstrap replicates of our statistic(s) of interest, which are stored in a matrix called <code>t</code>.</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="randomization-jackknife-and-bootstrap.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the first column of t corresponds to the intercept</span></span>
<span id="cb546-2"><a href="randomization-jackknife-and-bootstrap.html#cb546-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the second column to the coefficient w/respect to the explanatory</span></span>
<span id="cb546-3"><a href="randomization-jackknife-and-bootstrap.html#cb546-3" aria-hidden="true" tabindex="-1"></a><span class="co"># variable.</span></span>
<span id="cb546-4"><a href="randomization-jackknife-and-bootstrap.html#cb546-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(reg.boot<span class="sc">$</span>t)</span>
<span id="cb546-5"><a href="randomization-jackknife-and-bootstrap.html#cb546-5" aria-hidden="true" tabindex="-1"></a><span class="do">##            [,1]         [,2]</span></span>
<span id="cb546-6"><a href="randomization-jackknife-and-bootstrap.html#cb546-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]  0.1414971  0.007272036</span></span>
<span id="cb546-7"><a href="randomization-jackknife-and-bootstrap.html#cb546-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,] 13.6193653 -0.530262186</span></span>
<span id="cb546-8"><a href="randomization-jackknife-and-bootstrap.html#cb546-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]  5.9162810 -0.226258184</span></span>
<span id="cb546-9"><a href="randomization-jackknife-and-bootstrap.html#cb546-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]  8.7142191 -0.335820848</span></span>
<span id="cb546-10"><a href="randomization-jackknife-and-bootstrap.html#cb546-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [5,] 10.5894176 -0.401418204</span></span>
<span id="cb546-11"><a href="randomization-jackknife-and-bootstrap.html#cb546-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [6,] 11.5570456 -0.461870749</span></span></code></pre></div>
<p>We can look at histograms of the bootstrap estimates of the intercept and regression coefficient. First the intercept:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="randomization-jackknife-and-bootstrap.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(reg.boot<span class="sc">$</span>t[,<span class="dv">1</span>], <span class="at">bins =</span> <span class="dv">25</span>, <span class="at">xlab=</span><span class="st">&quot;Regression Intercept&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-543-1.png" width="576" /></p>
<p>And now the boostrap estimate of the regression coefficient:</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="randomization-jackknife-and-bootstrap.html#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(reg.boot<span class="sc">$</span>t[,<span class="dv">2</span>], <span class="at">bins =</span> <span class="dv">25</span>, <span class="at">xlab=</span><span class="st">&quot;Regression Coefficient&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-544-1.png" width="576" /></p>
</div>
<div id="calculating-bootstrap-confidence-intervals" class="section level3" number="17.6.7">
<h3><span class="header-section-number">17.6.7</span> Calculating bootstrap confidence intervals</h3>
<p>The <code>boot</code> package makes it easy to calculate confidence intervals, using the output of the <code>boot::boot()</code> function. The <code>boot::boot.ci()</code> handles the underlying calculations for us. To use <code>boot.ci()</code> we pass the <code>boot</code> object returned by the</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="randomization-jackknife-and-bootstrap.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(reg.boot, <span class="at">index =</span> <span class="dv">1</span>, <span class="at">conf =</span> <span class="fl">0.95</span>)</span>
<span id="cb549-2"><a href="randomization-jackknife-and-bootstrap.html#cb549-2" aria-hidden="true" tabindex="-1"></a><span class="do">## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span id="cb549-3"><a href="randomization-jackknife-and-bootstrap.html#cb549-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Based on 500 bootstrap replicates</span></span>
<span id="cb549-4"><a href="randomization-jackknife-and-bootstrap.html#cb549-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb549-5"><a href="randomization-jackknife-and-bootstrap.html#cb549-5" aria-hidden="true" tabindex="-1"></a><span class="do">## CALL : </span></span>
<span id="cb549-6"><a href="randomization-jackknife-and-bootstrap.html#cb549-6" aria-hidden="true" tabindex="-1"></a><span class="do">## boot.ci(boot.out = reg.boot, conf = 0.95, index = 1)</span></span>
<span id="cb549-7"><a href="randomization-jackknife-and-bootstrap.html#cb549-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb549-8"><a href="randomization-jackknife-and-bootstrap.html#cb549-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervals : </span></span>
<span id="cb549-9"><a href="randomization-jackknife-and-bootstrap.html#cb549-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Level      Normal              Basic         </span></span>
<span id="cb549-10"><a href="randomization-jackknife-and-bootstrap.html#cb549-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 95%   ( 1.038, 14.618 )   ( 0.499, 14.763 )  </span></span>
<span id="cb549-11"><a href="randomization-jackknife-and-bootstrap.html#cb549-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb549-12"><a href="randomization-jackknife-and-bootstrap.html#cb549-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Level     Percentile            BCa          </span></span>
<span id="cb549-13"><a href="randomization-jackknife-and-bootstrap.html#cb549-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 95%   ( 1.328, 15.592 )   ( 0.081, 14.272 )  </span></span>
<span id="cb549-14"><a href="randomization-jackknife-and-bootstrap.html#cb549-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculations and Intervals on Original Scale</span></span>
<span id="cb549-15"><a href="randomization-jackknife-and-bootstrap.html#cb549-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Some BCa intervals may be unstable</span></span></code></pre></div>
<p>The <code>boot.ci()</code> function returns information on Bootstrap CI’s calculated using four different approaches. The “Basic” CIs are based on using bootstrap standard errors and the t-distribution to estimate CIs. The “Normal” CIs are based on a normal approximation of the bootstrap distribution. The “Percentile” CIs are based on simple percentile intervals of the bootstrap distribution (as we did earlier), and the “BCa” CIs are based on an approach called “bias corrected and accelerated” (we won’t go into the details about this).</p>
<p>Which one of these CIs should you use? The answer unfortunately depends on the class of problem, sample sizes, and the form of the underlying distribution, etc. In general, my recommendation is to use bootstrap CIs (similarly Jackknife CIs) as “guides” about the nature of uncertainty in statistical estimates, not hard and fast rules. For example, when the original sample size is small, bootstrap CIs often tend to be too narrow for the desired level of confidence, and so it’s wise to consider that the CIs are “at least this wide,” and interpret your results accordingly.</p>
</div>
<div id="visualizing-bootstrap-confidence-intervals" class="section level3" number="17.6.8">
<h3><span class="header-section-number">17.6.8</span> Visualizing bootstrap confidence intervals</h3>
<p>One of the reasons for calculating confidence intervals is to provide insight into the range of plausible parameters associated with a statistical estimate or model. This suggests when we fit a model that we should really think of a cloud of other plausible models, representing the uncertainty associated with sampling. Let’s see how we can illustrate that uncertainty by visualizing 95% confidence intervals for our logistic regression.</p>
<p>First, we’ll write a helper function that given a range of set of points “x” (the predictor variable) and the coefficients of a logistic regression, yields the predicted values of “y” (the dependent variable):</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="randomization-jackknife-and-bootstrap.html#cb550-1" aria-hidden="true" tabindex="-1"></a>predicted.y <span class="ot">&lt;-</span> <span class="cf">function</span>(x, coeffs){</span>
<span id="cb550-2"><a href="randomization-jackknife-and-bootstrap.html#cb550-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.0</span><span class="sc">/</span>(<span class="fl">1.0</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>(coeffs[<span class="dv">1</span>] <span class="sc">+</span> coeffs[<span class="dv">2</span>]<span class="sc">*</span>x)))</span>
<span id="cb550-3"><a href="randomization-jackknife-and-bootstrap.html#cb550-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>For our particular example, the range of x-values we’ll make predictions over is the roughly the range of the observed values of the sparrow’s body mass:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="randomization-jackknife-and-bootstrap.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(bumpus<span class="sc">$</span>weight.g)</span>
<span id="cb551-2"><a href="randomization-jackknife-and-bootstrap.html#cb551-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 22.6 31.0</span></span>
<span id="cb551-3"><a href="randomization-jackknife-and-bootstrap.html#cb551-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-4"><a href="randomization-jackknife-and-bootstrap.html#cb551-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setup x-values over which to make predictions</span></span>
<span id="cb551-5"><a href="randomization-jackknife-and-bootstrap.html#cb551-5" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb551-6"><a href="randomization-jackknife-and-bootstrap.html#cb551-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">22</span>, <span class="dv">32</span>, <span class="at">length.out =</span> nx)</span></code></pre></div>
<p>We then create an empty matrix to hold the predicted values for each bootstrap sample, and then iterate over the bootstrap samples calculating the predictions for each:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="randomization-jackknife-and-bootstrap.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create empty matrix to hold model predictions for each bootstrap sample</span></span>
<span id="cb552-2"><a href="randomization-jackknife-and-bootstrap.html#cb552-2" aria-hidden="true" tabindex="-1"></a>predicted.mtx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>nreps, <span class="at">ncol =</span> nx)</span>
<span id="cb552-3"><a href="randomization-jackknife-and-bootstrap.html#cb552-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-4"><a href="randomization-jackknife-and-bootstrap.html#cb552-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps) {</span>
<span id="cb552-5"><a href="randomization-jackknife-and-bootstrap.html#cb552-5" aria-hidden="true" tabindex="-1"></a>  predicted.mtx[i,] <span class="ot">&lt;-</span> <span class="fu">predicted.y</span>(x, reg.boot<span class="sc">$</span>t[i,])</span>
<span id="cb552-6"><a href="randomization-jackknife-and-bootstrap.html#cb552-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb552-7"><a href="randomization-jackknife-and-bootstrap.html#cb552-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-8"><a href="randomization-jackknife-and-bootstrap.html#cb552-8" aria-hidden="true" tabindex="-1"></a><span class="co"># cast the matrix of predictions as a data frame</span></span>
<span id="cb552-9"><a href="randomization-jackknife-and-bootstrap.html#cb552-9" aria-hidden="true" tabindex="-1"></a>predicted.mtx.df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(predicted.mtx, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>)</span>
<span id="cb552-10"><a href="randomization-jackknife-and-bootstrap.html#cb552-10" aria-hidden="true" tabindex="-1"></a><span class="do">## New names:</span></span>
<span id="cb552-11"><a href="randomization-jackknife-and-bootstrap.html#cb552-11" aria-hidden="true" tabindex="-1"></a><span class="do">## * `` -&gt; ...1</span></span>
<span id="cb552-12"><a href="randomization-jackknife-and-bootstrap.html#cb552-12" aria-hidden="true" tabindex="-1"></a><span class="do">## * `` -&gt; ...2</span></span>
<span id="cb552-13"><a href="randomization-jackknife-and-bootstrap.html#cb552-13" aria-hidden="true" tabindex="-1"></a><span class="do">## * `` -&gt; ...3</span></span>
<span id="cb552-14"><a href="randomization-jackknife-and-bootstrap.html#cb552-14" aria-hidden="true" tabindex="-1"></a><span class="do">## * `` -&gt; ...4</span></span>
<span id="cb552-15"><a href="randomization-jackknife-and-bootstrap.html#cb552-15" aria-hidden="true" tabindex="-1"></a><span class="do">## * `` -&gt; ...5</span></span>
<span id="cb552-16"><a href="randomization-jackknife-and-bootstrap.html#cb552-16" aria-hidden="true" tabindex="-1"></a><span class="do">## * ...</span></span></code></pre></div>
<p>For reference, we also create the prediction for the original sample we have in had. Here we can use the built-in <code>predict()</code> function along with the original logistic regression fit object:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="randomization-jackknife-and-bootstrap.html#cb553-1" aria-hidden="true" tabindex="-1"></a>sample.prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.survival, </span>
<span id="cb553-2"><a href="randomization-jackknife-and-bootstrap.html#cb553-2" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">data.frame</span>(<span class="at">weight.g =</span> x), </span>
<span id="cb553-3"><a href="randomization-jackknife-and-bootstrap.html#cb553-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p>Finally we create a couple of convenience functions to calculate the 2.5% and 97.5% percentile points given a set of values:</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="randomization-jackknife-and-bootstrap.html#cb554-1" aria-hidden="true" tabindex="-1"></a>quantile<span class="fl">.975</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="fu">quantile</span>(x, <span class="fl">0.975</span>) }</span>
<span id="cb554-2"><a href="randomization-jackknife-and-bootstrap.html#cb554-2" aria-hidden="true" tabindex="-1"></a>quantile<span class="fl">.025</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="fu">quantile</span>(x, <span class="fl">0.025</span>) }</span></code></pre></div>
<p>With the various pieces in hand, we’re now ready to create a visual representation of the 95% bootstrap percentile CIs for the logistic regression:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="randomization-jackknife-and-bootstrap.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb555-2"><a href="randomization-jackknife-and-bootstrap.html#cb555-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">x=</span>bumpus<span class="sc">$</span>weight.g, <span class="at">y=</span>bumpus<span class="sc">$</span>survived), </span>
<span id="cb555-3"><a href="randomization-jackknife-and-bootstrap.html#cb555-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb555-4"><a href="randomization-jackknife-and-bootstrap.html#cb555-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> sample.prediction), <span class="at">color=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb555-5"><a href="randomization-jackknife-and-bootstrap.html#cb555-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">map_dbl</span>(predicted.mtx.df, quantile<span class="fl">.975</span>))) <span class="sc">+</span></span>
<span id="cb555-6"><a href="randomization-jackknife-and-bootstrap.html#cb555-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">map_dbl</span>(predicted.mtx.df, quantile<span class="fl">.025</span>))) <span class="sc">+</span></span>
<span id="cb555-7"><a href="randomization-jackknife-and-bootstrap.html#cb555-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Weight (g)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Prob. Survival&quot;</span>,</span>
<span id="cb555-8"><a href="randomization-jackknife-and-bootstrap.html#cb555-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Bumpus Survival Data</span><span class="sc">\n</span><span class="st">Logistic Regression and Bootstrap 95% CI&quot;</span>) <span class="sc">+</span></span>
<span id="cb555-9"><a href="randomization-jackknife-and-bootstrap.html#cb555-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">32</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-551-1.png" width="576" /></p>
<p>In the next plot we directly compare our bootstrap 95% CIs to the confidence intervals calculated by <code>geom_smooth</code>, which uses an asymptotic approximation to calculate confidence intervals for the logistic regression.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="randomization-jackknife-and-bootstrap.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the regression plot</span></span>
<span id="cb556-2"><a href="randomization-jackknife-and-bootstrap.html#cb556-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb556-3"><a href="randomization-jackknife-and-bootstrap.html#cb556-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>weight.g, <span class="at">y=</span>survived), <span class="at">data =</span> bumpus, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb556-4"><a href="randomization-jackknife-and-bootstrap.html#cb556-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>weight.g, <span class="at">y=</span>survived), <span class="at">data =</span> bumpus, <span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="at">se=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb556-5"><a href="randomization-jackknife-and-bootstrap.html#cb556-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">map_dbl</span>(predicted.mtx.df, quantile<span class="fl">.975</span>)), <span class="at">color=</span><span class="st">&#39;red&#39;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>, <span class="at">data =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb556-6"><a href="randomization-jackknife-and-bootstrap.html#cb556-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">map_dbl</span>(predicted.mtx.df, quantile<span class="fl">.025</span>)), <span class="at">color=</span><span class="st">&#39;red&#39;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>, <span class="at">data =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb556-7"><a href="randomization-jackknife-and-bootstrap.html#cb556-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Weight (g)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Prob. Survival&quot;</span>)</span>
<span id="cb556-8"><a href="randomization-jackknife-and-bootstrap.html#cb556-8" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-552-1.png" width="576" /></p>
<p>Our plot indicates that the asymptotic estimates of the logistic regression CIs and the bootstrap estimates of the CIs are very similar.</p>

</div>
</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="non-linear-regression-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulating-sampling-distributions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
